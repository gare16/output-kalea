import{$ as U,Y as Ie,a0 as L,Z as M,j as e,a1 as Y,r as q,a2 as pe,_ as xe,a3 as he,C as J,g as me,i as R,N as ue,O as _e,k as Q}from"./index-C8bs7RZm.js";import{l as Ee,u as Me}from"./useSpkList-Mmd1xVcq.js";import{T as Be}from"./TablesWidget13-CxemlcYz.js";import{D as Re,a as Ue}from"./DynamicDeleteModal-CQyqsHoG.js";import{u as $,a as O}from"./useMutation-DVRIQfZo.js";import{u as ye}from"./useVendors-9PVWaASE.js";import{S as G}from"./StatusBadge-DElhS85B.js";import{f as ze}from"./dateFormatter-BAS1RcD3.js";import"./ThemeProvider-BoXIQX2b.js";import"./Modal-BZ9Bjo3z.js";import"./hasClass-D44ucA8r.js";import"./warning-ClC9Fe-s.js";const De=async()=>(await U.get("/delivery-note/type")).data.data,Je=async n=>{const c=await U.get("/delivery-note",{params:n});return{data:c.data.data,meta:c.data.meta}},Te=async n=>(await U.get(`/delivery-note/${n}`)).data.data,Ge=async n=>{const p=n?`/delivery-note/generate-no/${encodeURIComponent((i=>i.replace(/^SURAT JALAN\s+/i,"").trim().replace(/\s+/g,"_").toUpperCase())(n))}`:"/delivery-note/generate-no";return(await U.get(p)).data.data.delivery_note_no},Le=async n=>(await U.post("/delivery-note",n)).data.data,Oe=async n=>(await U.put(`/delivery-note/${n.id}`,n)).data.data,Qe=async n=>{await U.post("/delivery-note/approval",n)},He=async n=>{await U.delete(`/delivery-note/${n}`)},Z=n=>{var t,v;const c=Ie(),p=$({queryKey:["delivery-notes",n],queryFn:()=>Je(n)}),u=O({mutationFn:m=>Le(m),onSuccess:m=>{console.log("Add delivery note success:",m),c.invalidateQueries({queryKey:["delivery-notes"]}),M.success("Delivery note added successfully")},onError:m=>{var l;const r=m instanceof L?(l=m.response)==null?void 0:l.data.message:`Gagal Menambah Surat Jalan: ${m.message}`;Array.isArray(r)?r.forEach(h=>M.error(h)):M.error(r)}}),i=O({mutationFn:m=>Oe(m),onSuccess:m=>{console.log("Update delivery note success:",m),c.invalidateQueries({queryKey:["delivery-notes"]}),M.success("Delivery note updated successfully")},onError:m=>{var l;const r=m instanceof L?(l=m.response)==null?void 0:l.data.message:`Gagal Mengubah Surat Jalan: ${m.message}`;Array.isArray(r)?r.forEach(h=>M.error(h)):M.error(r)}}),s=O({mutationFn:m=>Qe(m),onSuccess:()=>{console.log("Approve delivery note success"),c.invalidateQueries({queryKey:["delivery-notes"]}),M.success("Delivery note approved successfully")},onError:m=>{var l;const r=m instanceof L?(l=m.response)==null?void 0:l.data.message:`Gagal Approve: ${m.message}`;Array.isArray(r)?r.forEach(h=>M.error(h)):M.error(r)}}),x=O({mutationFn:m=>He(m),onSuccess:()=>{console.log("Delete delivery note success"),c.invalidateQueries({queryKey:["delivery-notes"]}),M.success("Delivery note deleted successfully")},onError:m=>{var l;const r=m instanceof L?(l=m.response)==null?void 0:l.data.message:`Gagal Menghapus Surat Jalan: ${m.message}`;Array.isArray(r)?r.forEach(h=>M.error(h)):M.error(r)}});return{deliveryNotes:((t=p.data)==null?void 0:t.data)||[],meta:(v=p.data)==null?void 0:v.meta,isLoading:p.isLoading,error:p.error,addDeliveryNote:u.mutate,updateDeliveryNote:i.mutate,approveDeliveryNote:s.mutate,isAdding:u.isPending,isUpdating:i.isPending,isApproving:s.isPending,isDeleting:x.isPending,deleteDeliveryNote:x.mutate}},X=n=>{const c=$({queryKey:["delivery-note",n],queryFn:()=>Te(n),enabled:!!n});return{deliveryNote:c.data,isLoading:c.isLoading,error:c.error}},je=()=>{const n=$({queryKey:["delivery-note-types"],queryFn:De});return{types:n.data||[],isLoading:n.isLoading,error:n.error}},ge=n=>{const c=$({queryKey:["generate-delivery-note-no",n],queryFn:()=>Ge(n),enabled:!!n});return{deliveryNoteNo:c.data,isLoading:c.isLoading,error:c.error,refetch:c.refetch}},$e=({deliveryNote:n,spk:c,spkDetails:p})=>{const u=(s,x)=>{switch(x){case"PERMINTAAN_KAIN":if("qty_spk"in s&&"nama_material"in s&&"jumlah_material"in s&&"kurang_material"in s){const t=s;return{product:t.product_name,variant:`${t.color} - ${t.size}`,qtySpk:t.qty_spk,namaMaterial:t.nama_material,jumlahMaterial:t.jumlah_material,kurangMaterial:t.kurang_material}}break;case"PENGIRIMAN_BARANG":if("qty_spk"in s&&"qty_done"in s&&"qty_out"in s&&"hpp"in s){const t=s;return{product:t.product_name,variant:`${t.color} - ${t.size}`,qtySpk:t.qty_spk,qtyDone:t.qty_done,qtyOut:t.qty_out,hpp:t.hpp}}break;case"BUANG_BENANG_KELUAR":if("qty_order"in s&&"qty_out"in s){const t=s;return{product:t.product_name,variant:`${t.color} - ${t.size}`,qtyOrder:t.qty_order,qtyOut:t.qty_out}}break;case"BUANG_BENANG_MASUK":if("qty_spk"in s&&"qty_out"in s&&"qty_in"in s&&"selisih"in s){const t=s;return{product:t.product_name,variant:`${t.color} - ${t.size}`,qtySpk:t.qty_spk,qtyOut:t.qty_out,qtyIn:t.qty_in,selisih:t.selisih}}break;case"JAHIT_KELUAR":if("qty_order"in s&&"qty_out"in s){const t=s;return{product:t.product_name,variant:`${t.color} - ${t.size}`,qtyOrder:t.qty_order,qtyOut:t.qty_out}}break;case"JAHIT_MASUK":if("qty_spk"in s&&"qty_out"in s&&"qty_in"in s&&"selisih"in s){const t=s;return{product:t.product_name,variant:`${t.color} - ${t.size}`,qtySpk:t.qty_spk,qtyOut:t.qty_out,qtyIn:t.qty_in,selisih:t.selisih}}break}return{product:s.product_name,variant:`${s.color} - ${s.size}`}},i=()=>{if(!p||p.length===0)return null;switch(n.delivery_note_type){case"PERMINTAAN_KAIN":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty SPK"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Nama Material"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Jumlah Material"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Kurang Material"})]})}),e.jsx("tbody",{children:p.map((s,x)=>{const t=u(s.product_variants,"PERMINTAAN_KAIN");return e.jsxs("tr",{style:{backgroundColor:x%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:t.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtySpk}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:t.namaMaterial}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.jumlahMaterial}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.kurangMaterial})]},s.id??x)})})]});case"PENGIRIMAN_BARANG":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty SPK"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Done"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Out"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"HPP"})]})}),e.jsx("tbody",{children:p.map((s,x)=>{const t=u(s.product_variants,"PENGIRIMAN_BARANG");return e.jsxs("tr",{style:{backgroundColor:x%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:t.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtySpk}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtyDone}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtyOut}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.hpp})]},s.id??x)})})]});case"BUANG_BENANG_KELUAR":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Order"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Out"})]})}),e.jsx("tbody",{children:p.map((s,x)=>{const t=u(s.product_variants,"BUANG_BENANG_KELUAR");return e.jsxs("tr",{style:{backgroundColor:x%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:t.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtyOrder}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtyOut})]},s.id??x)})})]});case"BUANG_BENANG_MASUK":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty SPK"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Out"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty In"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Selisih"})]})}),e.jsx("tbody",{children:p.map((s,x)=>{const t=u(s.product_variants,"BUANG_BENANG_MASUK");return e.jsxs("tr",{style:{backgroundColor:x%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:t.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtySpk}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtyOut}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtyIn}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.selisih})]},s.id??x)})})]});case"JAHIT_KELUAR":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Order"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Out"})]})}),e.jsx("tbody",{children:p.map((s,x)=>{const t=u(s.product_variants,"JAHIT_KELUAR");return e.jsxs("tr",{style:{backgroundColor:x%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:t.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtyOrder}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtyOut})]},s.id??x)})})]});case"JAHIT_MASUK":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty SPK"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Out"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty In"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Selisih"})]})}),e.jsx("tbody",{children:p.map((s,x)=>{const t=u(s.product_variants,"JAHIT_MASUK");return e.jsxs("tr",{style:{backgroundColor:x%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:t.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtySpk}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtyOut}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.qtyIn}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:t.selisih})]},s.id??x)})})]});default:return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Variant"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Order"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Done"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Reject"})]})}),e.jsx("tbody",{children:p.map((s,x)=>e.jsxs("tr",{style:{backgroundColor:x%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product_variants.product_name}),e.jsxs("td",{style:{border:"1px solid #ccc",padding:"8px"},children:[s.product_variants.color," - ",s.product_variants.size]}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qty_order}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qty_done}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qty_reject})]},s.id??x))})]})}};return e.jsxs("div",{style:{fontFamily:"Arial, sans-serif",maxWidth:"210mm",margin:"0 auto",padding:"16mm",backgroundColor:"#fff",color:"#000",lineHeight:"1.4",fontSize:"12px"},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:"20px"},children:"Surat Jalan"}),e.jsx("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"24px",fontSize:"12px"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold",width:"160px"},children:"Delivery Note No"}),e.jsx("td",{style:{padding:"6px 8px"},children:n.delivery_note_no})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"Delivery Date"}),e.jsx("td",{style:{padding:"6px 8px"},children:n.delivery_note_date?ze(n.delivery_note_date):"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"Type"}),e.jsx("td",{style:{padding:"6px 8px"},children:n.delivery_note_type||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"Vendor"}),e.jsx("td",{style:{padding:"6px 8px"},children:n.vendor.name})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"Destination"}),e.jsx("td",{style:{padding:"6px 8px"},children:n.destination})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"No SPK"}),e.jsx("td",{style:{padding:"6px 8px"},children:(c==null?void 0:c.map(s=>s.spk_no).join(", "))||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"Notes"}),e.jsx("td",{style:{padding:"6px 8px"},children:n.notes||"-"})]})]})}),p&&p.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{style:{marginBottom:"10px"},children:"Product Variants"}),i()]})]})},H={deliveryNote:{id:"1",delivery_note_no:"DN-KAIN-001",delivery_note_date:"2024-12-01",delivery_note_type:"PERMINTAAN_KAIN",vendor:{name:"Supplier Kain PT. ABC",contact_person:"John Doe",phone:"08123456789",email:"john@supplierkain.com",address:"Jl. Industri No. 123",city:"Jakarta",province:"DKI Jakarta",country:"Indonesia",zip_code:"12345",tax_number:"1234567890"},destination:"Workshop A",notes:"Permintaan kain untuk produksi bulan depan",status:"Diproses"},details:[],spk:[{id:"spk-1",spk_no:"SPK-001",buyer:"PT. XYZ",spk_date:"2024-11-15",deadline:"2024-12-15",status:"Diproses",notes:"Order musim dingin"}],spkDetails:[{id:"detail-1",product_variants:{id:"pv-1",product_name:"Kemeja Casual",size:"L",color:"Biru",barcode:"KEMEJA-001",sku:"KEM-L-BIRU",price:0,cost_price:0,nama_material:"Katun Premium",jumlah_material:5,kurang_material:2,qty_spk:100},qty_order:100},{id:"detail-2",product_variants:{id:"pv-2",product_name:"Celana Panjang",size:"M",color:"Hitam",barcode:"CELANA-002",sku:"CEL-M-HITAM",price:0,cost_price:0,nama_material:"Denim",jumlah_material:3,kurang_material:1,qty_spk:80},qty_order:80}]},Ne={deliveryNote:{id:"2",delivery_note_no:"DN-BARANG-001",delivery_note_date:"2024-12-01",delivery_note_type:"PENGIRIMAN_BARANG",vendor:{name:"Penerima PT. XYZ",contact_person:"Jane Smith",phone:"08198765432",email:"jane@penerima.com",address:"Jl. Gudang No. 456",city:"Jakarta",province:"DKI Jakarta",country:"Indonesia",zip_code:"54321",tax_number:"0987654321"},destination:"Gudang Jakarta",notes:"Pengiriman barang hasil produksi",status:"Selesai"},details:[],spk:[{id:"spk-2",spk_no:"SPK-002",buyer:"PT. XYZ",spk_date:"2024-11-01",deadline:"2024-12-01",status:"Selesai",notes:"Order reguler"}],spkDetails:[{id:"detail-3",product_variants:{id:"pv-3",product_name:"Kemeja Formal",size:"L",color:"Putih",barcode:"KEMFORM-001",sku:"KFOR-L-PUTIH",price:15e4,cost_price:1e5,qty_spk:200,qty_done:200,qty_out:180,hpp:1e5},qty_done:200},{id:"detail-4",product_variants:{id:"pv-4",product_name:"Jaket Hoodie",size:"XL",color:"Abu",barcode:"JAKHOOD-001",sku:"JAK-XL-ABU",price:2e5,cost_price:14e4,qty_spk:150,qty_done:150,qty_out:140,hpp:14e4},qty_done:150}]},ve={deliveryNote:{id:"3",delivery_note_no:"DN-BENANG-KELUAR-001",delivery_note_date:"2024-12-01",delivery_note_type:"BUANG_BENANG_KELUAR",vendor:{name:"Workshop A",contact_person:"Bob Wilson",phone:"08111222333",email:"bob@workshop.com",address:"Jl. Produksi No. 789",city:"Bandung",province:"Jawa Barat",country:"Indonesia",zip_code:"67890",tax_number:"1122334455"},destination:"Departemen Jahit",notes:"Pengiriman benang sisa produksi",status:"Diproses"},details:[],spk:[{id:"spk-3",spk_no:"SPK-003",buyer:"PT. ABC",spk_date:"2024-11-20",deadline:"2024-12-20",status:"Diproses",notes:"Order potongan"}],spkDetails:[{id:"detail-5",product_variants:{id:"pv-5",product_name:"Kemeja Casual",size:"M",color:"Merah",barcode:"KEMEJA-003",sku:"KEM-M-MERAH",price:0,cost_price:0,qty_order:50,qty_out:5},qty_order:50},{id:"detail-6",product_variants:{id:"pv-6",product_name:"T-Shirt",size:"S",color:"Hijau",barcode:"TSHIRT-001",sku:"TSH-S-HIJAU",price:0,cost_price:0,qty_order:40,qty_out:3},qty_order:40}]},be={deliveryNote:{id:"4",delivery_note_no:"DN-BENANG-MASUK-001",delivery_note_date:"2024-12-01",delivery_note_type:"BUANG_BENANG_MASUK",vendor:{name:"Departemen Jahit",contact_person:"Alice Brown",phone:"08144555666",email:"alice@jahit.com",address:"Jl. Jahit No. 101",city:"Surabaya",province:"Jawa Timur",country:"Indonesia",zip_code:"11223",tax_number:"3344556677"},destination:"Workshop A",notes:"Pengembalian benang sisa dari departemen jahit",status:"Diproses"},details:[],spk:[{id:"spk-4",spk_no:"SPK-004",buyer:"PT. ABC",spk_date:"2024-11-20",deadline:"2024-12-20",status:"Diproses",notes:"Order potongan"}],spkDetails:[{id:"detail-7",product_variants:{id:"pv-7",product_name:"Kemeja Casual",size:"M",color:"Merah",barcode:"KEMEJA-003",sku:"KEM-M-MERAH",price:0,cost_price:0,qty_spk:10,qty_out:7,qty_in:3,selisih:4}},{id:"detail-8",product_variants:{id:"pv-8",product_name:"T-Shirt",size:"S",color:"Hijau",barcode:"TSHIRT-001",sku:"TSH-S-HIJAU",price:0,cost_price:0,qty_spk:8,qty_out:5,qty_in:2,selisih:3}}]},fe={deliveryNote:{id:"5",delivery_note_no:"DN-JAHIT-KELUAR-001",delivery_note_date:"2024-12-01",delivery_note_type:"JAHIT_KELUAR",vendor:{name:"Workshop A",contact_person:"Charlie Davis",phone:"08177888999",email:"charlie@workshop.com",address:"Jl. Produksi No. 202",city:"Yogyakarta",province:"DI Yogyakarta",country:"Indonesia",zip_code:"33445",tax_number:"5566778899"},destination:"Departemen Jahit",notes:"Pengiriman bahan ke departemen jahit",status:"Diproses"},details:[],spk:[{id:"spk-5",spk_no:"SPK-005",buyer:"PT. ABC",spk_date:"2024-11-25",deadline:"2024-12-25",status:"Diproses",notes:"Produksi musim panas"}],spkDetails:[{id:"detail-9",product_variants:{id:"pv-9",product_name:"Blazer",size:"L",color:"Coklat",barcode:"BLAZER-001",sku:"BLZ-L-COKLAT",price:0,cost_price:0,qty_order:25,qty_out:20},qty_order:25},{id:"detail-10",product_variants:{id:"pv-10",product_name:"Rok Panjang",size:"S",color:"Navy",barcode:"ROK-001",sku:"ROK-S-NAVY",price:0,cost_price:0,qty_order:30,qty_out:28},qty_order:30}]},Ae={deliveryNote:{id:"6",delivery_note_no:"DN-JAHIT-MASUK-001",delivery_note_date:"2024-12-01",delivery_note_type:"JAHIT_MASUK",vendor:{name:"Departemen Jahit",contact_person:"Diana Evans",phone:"08100011122",email:"diana@jahit.com",address:"Jl. Jahit No. 303",city:"Semarang",province:"Jawa Tengah",country:"Indonesia",zip_code:"55667",tax_number:"7788990011"},destination:"Workshop A",notes:"Pengembalian bahan dari departemen jahit",status:"Diproses"},details:[],spk:[{id:"spk-6",spk_no:"SPK-006",buyer:"PT. ABC",spk_date:"2024-11-25",deadline:"2024-12-25",status:"Diproses",notes:"Produksi musim panas"}],spkDetails:[{id:"detail-11",product_variants:{id:"pv-11",product_name:"Blazer",size:"L",color:"Coklat",barcode:"BLAZER-001",sku:"BLZ-L-COKLAT",price:0,cost_price:0,qty_spk:20,qty_out:18,qty_in:15,selisih:3}},{id:"detail-12",product_variants:{id:"pv-12",product_name:"Rok Panjang",size:"S",color:"Navy",barcode:"ROK-001",sku:"ROK-S-NAVY",price:0,cost_price:0,qty_spk:28,qty_out:25,qty_in:22,selisih:3}}]},Fe=()=>{const n=Y(),[c,p]=q.useState(!1),[u,i]=q.useState(!1),[s,x]=q.useState(null),[t,v]=q.useState(null),m=q.useRef(null),[r,l]=q.useState(""),h=g=>{switch((g==null?void 0:g.toUpperCase().trim())||""){case"PERMINTAAN_KAIN":return H;case"PENGIRIMAN_BARANG":return Ne;case"BUANG_BENANG_KELUAR":return ve;case"BUANG_BENANG_MASUK":return be;case"JAHIT_KELUAR":return fe;case"JAHIT_MASUK":return Ae;default:return H}},{deliveryNotes:o,addDeliveryNote:A,deleteDeliveryNote:N}=Z(),{deliveryNote:y,isLoading:K}=X(t||""),{types:a}=je(),{vendors:d}=ye(),{deliveryNoteNo:k,refetch:S}=ge(r),w=[{key:"noSJ",label:"No. SJ",className:"min-w-120px"},{key:"tanggal",label:"Tanggal",className:"min-w-100px"},{key:"jenis",label:"Jenis",className:"min-w-100px"},{key:"vendor",label:"Vendor",className:"min-w-125px"},{key:"tujuan",label:"Tujuan",className:"min-w-125px"},{key:"status",label:"Status",className:"min-w-100px"},{key:"createdBy",label:"Created By",className:"min-w-125px"}],f=o.map(g=>({id:g.id,noSJ:g.delivery_note_no,tanggal:g.delivery_note_date,jenis:g.delivery_note_type,vendor:g.vendor.name,tujuan:g.destination,status:e.jsx(G,{status:g.status.toLowerCase()}),createdBy:"System"})),b=g=>{x(g),p(!0)},P=()=>{N(s==null?void 0:s.id),p(!1)},I=g=>{n(`/production/edit-surat-jalan/${g.id}`)},C=g=>{const D=g.id;v(D)},j=Ee.useReactToPrint({contentRef:m,documentTitle:y?`SuratJalan-${y.delivery_note_no}`:"SuratJalan-Detail",pageStyle:`
      @page {
        size: A4;
        margin: 20mm;
      }
      body {
        -webkit-print-color-adjust: exact !important;
        color-adjust: exact !important;
      }
    `});q.useEffect(()=>{y&&!K&&t&&(j(),v(null))},[y,K,j,t]);const _=()=>{n("/production/add-surat-jalan")},B=g=>{l(g),S()},z=g=>{const D={delivery_note_no:k||g.noSJ,delivery_note_date:g.tanggal,delivery_note_type:g.jenis,vendor_id:g.vendor,destination:g.tujuan,status:g.status,notes:g.notes||"",user_id:"system",details:[]};A(D),i(!1),l("")};return e.jsxs("div",{children:[y&&e.jsx("div",{ref:m,className:"spk-print-content",style:{position:"absolute",left:"-9999px",top:"-9999px"},children:e.jsx($e,{deliveryNote:h(y.delivery_note_type).deliveryNote,spk:h(y.delivery_note_type).spk||[],spkDetails:h(y.delivery_note_type).spkDetails||[]})}),e.jsx(Be,{className:"card-xl-stretch",rows:f,columns:w,labelAdd:"Surat Jalan",filters:[{key:"jenis",label:"Filter by Jenis"},{key:"vendor",label:"Filter by Vendor"},{key:"status",label:"Filter by Status"}],onDelete:b,onEdit:I,onAddClick:_,onPrint:C,onRowClick:g=>n(`/production/delivery-note-detail/detail/${g.id}`),roleAccess:{add:["ADMIN","OWNER","ADMIN PRODUKSI"],edit:["ADMIN","OWNER","ADMIN PRODUKSI"],print:["ADMIN","OWNER","ADMIN PRODUKSI","WAREHOUSE"]}}),c&&s&&e.jsx(Re,{show:c,title:"Delete Surat Jalan",itemName:s.noSJ,onConfirm:P,onClose:()=>{p(!1),x(null)}}),u&&e.jsx(Ue,{show:u,title:"Add Surat Jalan",fields:[{name:"jenis",label:"Jenis",type:"select",required:!0,options:a.map(g=>({value:g.id,label:g.name})),icon:"cog",onChange:B},{name:"noSJ",label:"No. SJ",type:"text",required:!0,icon:"document"},{name:"tanggal",label:"Tanggal",type:"date",required:!0,icon:"calendar"},{name:"vendor",label:"Vendor",type:"select",required:!0,options:d.map(g=>({value:g.id,label:g.name})),icon:"user"},{name:"tujuan",label:"Tujuan",type:"text",required:!0,icon:"map"},{name:"status",label:"Status",type:"select",required:!0,options:[{value:"PENDING",label:"Pending"},{value:"DONE",label:"Done"}],icon:"check-circle"},{name:"notes",label:"Notes",type:"textarea",required:!1,icon:"comment"}],onSubmit:z,onClose:()=>i(!1)})]})},We={delivery_note_no:"",delivery_note_date:"",delivery_note_type:"PERMINTAAN_KAIN",vendor_id:"",destination:"",status:"PENDING",notes:"",user_id:"system"},qe=(n,c)=>{const p=(c==null?void 0:c.autoGenerateNo)??!0,u=(c==null?void 0:c.autoSetDate)??!0,i=q.useMemo(()=>({...We,...n}),[n]),[s,x]=q.useState(i);q.useEffect(()=>{x(r=>({...r,...i}))},[i]);const{deliveryNoteNo:t,refetch:v}=ge(p?s.delivery_note_type:void 0);return q.useEffect(()=>{p&&s.delivery_note_type&&v()},[p,s.delivery_note_type,v]),q.useEffect(()=>{p&&t&&x(r=>({...r,delivery_note_no:t}))},[p,t]),q.useEffect(()=>{if(!u||n!=null&&n.delivery_note_date)return;const r=new Date().toISOString().split("T")[0];x(l=>({...l,delivery_note_date:r}))},[u,n==null?void 0:n.delivery_note_date]),{formData:s,updateFormData:r=>{x(l=>({...l,...r}))}}},Se=()=>{const{data:n}=Me(),[c,p]=q.useState([]),[u,i]=q.useState({});q.useEffect(()=>{c.forEach(t=>{u[t]||(async()=>{try{const m=await U.get(`/spk/${t}`);m.data.success&&i(r=>({...r,[t]:m.data.data.details}))}catch(m){console.error("Error fetching SPK detail:",m)}})()})},[c,u]);const s=t=>{p(v=>v.includes(t)?v.filter(m=>m!==t):[...v,t])},x=q.useCallback(t=>{p(v=>v.length===t.length&&v.every(r=>t.includes(r))?v:t)},[]);return{spkList:n,selectedSpks:c,spkDetails:u,toggleSpkSelection:s,setSelectedSpks:x}},E={PERMINTAAN_KAIN:"PERMINTAAN_KAIN",BUANG_BENANG_KELUAR:"BUANG_BENANG_KELUAR",JAHIT_KELUAR:"JAHIT_KELUAR",BUANG_BENANG_MASUK:"BUANG_BENANG_MASUK",JAHIT_MASUK:"JAHIT_MASUK",PENGIRIMAN_BARANG:"PENGIRIMAN_BARANG"},oe=(n,c,p)=>{const u=Array.isArray(n)?n:[];if(p===E.PERMINTAAN_KAIN){const i=Array.isArray(c.req_material)?c.req_material:[],s=i.find(t=>/kain/i.test(t.material_name))||i[0];if(s)return{material_name:s.material_name,material_qty:s.qty_required};const x=u.find(t=>/kain/i.test(t.material_name));if(x)return{material_name:x.material_name,material_qty:x.qty_per_unit*c.qty_order}}return{material_name:"",material_qty:0}},ke=n=>{const[c,p]=q.useState([]),u=(t,v,m)=>{if(m){const{material_name:r,material_qty:l}=oe(t.bom,t,n),h={spk_detail_id:t.id,item_type:"PRODUCT",product_variant_id:(t==null?void 0:t.id)??"",material_id:null,qty_out:t.qty_order,qty_in:0,labor_cost:0,spk_no:v.noSpk,product_name:t.product_name,color:t.color,size:t.size,qty_order:t.qty_order,material_name:r,material_qty:l,short_material:0,qty_done:0,hpp:0,selisih:0,req_material:t.req_material};p(o=>[...o,h])}else p(r=>r.filter(l=>l.spk_detail_id!==t.id))},i=(t,v,m,r)=>{if(v){const l=r.map(h=>{const{material_name:o,material_qty:A}=oe(h.bom,h,n);return{spk_detail_id:h.id,item_type:"PRODUCT",product_variant_id:(h==null?void 0:h.id)??"",material_id:null,qty_out:h.qty_order,qty_in:0,labor_cost:0,spk_no:m.noSpk,product_name:h.product_name,color:h.color,size:h.size,qty_order:h.qty_order,material_name:o,material_qty:A,short_material:0,qty_done:0,hpp:0,selisih:0,req_material:h.req_material}});p(h=>[...h.filter(o=>!r.some(A=>A.id===o.spk_detail_id)),...l])}else p(l=>l.filter(h=>!r.some(o=>o.id===h.spk_detail_id)))},s=(t,v,m)=>{p(r=>r.map(l=>l.spk_detail_id===t?{...l,[v]:m}:l))},x=q.useCallback(t=>{p(t)},[]);return{selectedDetails:c,handleDetailSelect:u,handleSelectAllDetails:i,updateDetail:s,setSelectedDetails:x}},we=({formData:n,updateFormData:c})=>{const{types:p}=je(),{vendors:u}=ye();return e.jsxs("div",{children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Delivery Note No *"}),e.jsx("input",{type:"text",className:"form-control",value:n.delivery_note_no,onChange:i=>c({delivery_note_no:i.target.value}),disabled:!0})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Delivery Date *"}),e.jsx("input",{type:"date",className:"form-control",value:n.delivery_note_date,onChange:i=>c({delivery_note_date:i.target.value})})]})})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Type *"}),e.jsx("select",{className:"form-select",value:n.delivery_note_type,onChange:i=>c({delivery_note_type:i.target.value}),children:p.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Vendor *"}),e.jsxs("select",{className:"form-select",value:n.vendor_id,onChange:i=>c({vendor_id:i.target.value}),children:[e.jsx("option",{value:"",children:"Select Vendor"}),u.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})]})})]}),e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Destination *"}),e.jsx("input",{type:"text",className:"form-control",value:n.destination,onChange:i=>c({destination:i.target.value})})]})})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{className:"form-control",rows:3,value:n.notes,onChange:i=>c({notes:i.target.value})})]})]})},Pe=({spkList:n,selectedSpks:c,toggleSpkSelection:p})=>{const[u,i]=q.useState(""),[s,x]=q.useState(1),t=3,v=(n==null?void 0:n.filter(l=>l.status==="approved"&&(u===""||l.noSpk.toLowerCase().includes(u.toLowerCase())||l.buyer.toLowerCase().includes(u.toLowerCase()))))||[],m=v.slice((s-1)*t,s*t),r=Math.ceil(v.length/t);return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label",children:"Select SPKs *"}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-md-6",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search SPK by number or buyer...",value:u,onChange:l=>i(l.target.value),onKeyDown:l=>{l.key==="Enter"&&x(1)}})})}),e.jsx("div",{className:"row",children:m.map(l=>e.jsx("div",{className:"col-md-6 col-lg-4 mb-3",children:e.jsx("div",{className:`card h-100 ${c.includes(l.id)?"border-primary":"border-light"}`,children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:`spk-${l.id}`,checked:c.includes(l.id),disabled:l.status!=="approved",onChange:()=>p(l.id)}),e.jsx("label",{className:"form-check-label w-100",htmlFor:`spk-${l.id}`,children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("strong",{className:"text-primary",children:l.noSpk}),e.jsx("small",{className:"text-muted",children:l.buyer}),e.jsx("span",{className:`badge ${l.status==="approved"?"bg-success":l.status==="in_progress"?"bg-warning":"bg-secondary"} mt-1 align-self-start`,children:l.status.replace("_"," ").toUpperCase()})]})})]})})})},l.id))}),r>1&&e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("nav",{children:e.jsxs("ul",{className:"pagination",children:[e.jsx("li",{className:`page-item ${s===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>x(l=>Math.max(1,l-1)),disabled:s===1,children:"Previous"})}),Array.from({length:r},(l,h)=>h+1).map(l=>e.jsx("li",{className:`page-item ${s===l?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>x(l),children:l})},l)),e.jsx("li",{className:`page-item ${s===r?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>x(l=>Math.min(r,l+1)),disabled:s===r,children:"Next"})})]})})}),c.length>0&&e.jsx("div",{className:"mt-3",children:e.jsxs("small",{className:"text-muted",children:["Selected ",c.length," SPK",c.length>1?"s":""]})})]})},Ke=({selectedSpks:n,spkList:c,spkDetails:p,selectedDetails:u,deliveryNoteType:i,handleDetailSelect:s,handleSelectAllDetails:x,updateDetail:t})=>{if(n.length===0)return null;const v=()=>{const r=[e.jsx("th",{},"checkbox"),e.jsx("th",{children:"Product"},"product"),e.jsx("th",{children:"Color"},"color"),e.jsx("th",{children:"Size"},"size")];return i===E.PERMINTAAN_KAIN?r.push(e.jsx("th",{children:"Qty SPK"},"qty_spk"),e.jsx("th",{children:"Nama Material"},"material_name"),e.jsx("th",{children:"Jumlah Material"},"material_qty"),e.jsx("th",{children:"Kurang Material"},"short_material")):i===E.BUANG_BENANG_KELUAR||i===E.JAHIT_KELUAR?r.push(e.jsx("th",{children:"Qty Order"},"qty_order"),e.jsx("th",{children:"Qty Out"},"qty_out")):i===E.BUANG_BENANG_MASUK||i===E.JAHIT_MASUK?r.push(e.jsx("th",{children:"Qty SPK"},"qty_spk"),e.jsx("th",{children:"Qty Out"},"qty_out"),e.jsx("th",{children:"Qty In"},"qty_in"),e.jsx("th",{children:"Selisih"},"selisih")):i===E.PENGIRIMAN_BARANG?r.push(e.jsx("th",{children:"Qty SPK"},"qty_spk"),e.jsx("th",{children:"Qty Done"},"qty_done"),e.jsx("th",{children:"Qty Out"},"qty_out"),e.jsx("th",{children:"HPP"},"hpp")):r.push(e.jsx("th",{children:"Qty Order"},"qty_order"),e.jsx("th",{children:"Qty"},"qty_out")),r},m=(r,l)=>{var N,y,K,a;const h=u.some(d=>d.spk_detail_id===r.id),o=u.find(d=>d.spk_detail_id===r.id),A=[e.jsx("td",{onClick:d=>d.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:h,onClick:d=>d.stopPropagation(),onChange:d=>s(r,l,d.target.checked)})},"checkbox"),e.jsx("td",{children:r.product_name},"product"),e.jsx("td",{children:r.color},"color"),e.jsx("td",{children:r.size},"size")];return i===E.PERMINTAAN_KAIN?A.push(e.jsx("td",{children:r.qty_order},"qty_spk"),e.jsx("td",{onClick:d=>d.stopPropagation(),children:h&&e.jsx("input",{type:"text",className:"form-control",value:((y=(N=o==null?void 0:o.req_material)==null?void 0:N[0])==null?void 0:y.material_name)??(o==null?void 0:o.material_name)??"",readOnly:!0})},"material_name"),e.jsx("td",{onClick:d=>d.stopPropagation(),children:h&&e.jsx("input",{type:"number",className:"form-control",value:((a=(K=o==null?void 0:o.req_material)==null?void 0:K[0])==null?void 0:a.qty_required)??(o==null?void 0:o.material_qty)??"",readOnly:!0})},"material_qty"),e.jsx("td",{onClick:d=>d.stopPropagation(),children:h&&e.jsx("input",{type:"number",className:"form-control",value:(o==null?void 0:o.short_material)||"",onChange:d=>t(r.id,"short_material",d.target.value===""?0:parseInt(d.target.value)||0),min:0})},"short_material")):i===E.BUANG_BENANG_KELUAR||i===E.JAHIT_KELUAR?A.push(e.jsx("td",{children:r.qty_order},"qty_order"),e.jsx("td",{onClick:d=>d.stopPropagation(),children:h&&e.jsx("input",{type:"number",className:"form-control",value:(o==null?void 0:o.qty_out)||"",onChange:d=>t(r.id,"qty_out",d.target.value===""?0:parseInt(d.target.value)||0),max:r.qty_order,min:0})},"qty_out")):i===E.BUANG_BENANG_MASUK||i===E.JAHIT_MASUK?A.push(e.jsx("td",{children:r.qty_order},"qty_spk"),e.jsx("td",{onClick:d=>d.stopPropagation(),children:h&&e.jsx("input",{type:"number",className:"form-control",value:(o==null?void 0:o.qty_out)||"",onChange:d=>t(r.id,"qty_out",d.target.value===""?0:parseInt(d.target.value)||0),min:0})},"qty_out"),e.jsx("td",{onClick:d=>d.stopPropagation(),children:h&&e.jsx("input",{type:"number",className:"form-control",value:(o==null?void 0:o.qty_in)||"",onChange:d=>t(r.id,"qty_in",d.target.value===""?0:parseInt(d.target.value)||0),min:0})},"qty_in"),e.jsx("td",{onClick:d=>d.stopPropagation(),children:h&&e.jsx("input",{type:"number",className:"form-control",value:(o==null?void 0:o.selisih)||"",onChange:d=>t(r.id,"selisih",d.target.value===""?0:parseInt(d.target.value)||0),min:0})},"selisih")):i===E.PENGIRIMAN_BARANG?A.push(e.jsx("td",{children:r.qty_order},"qty_spk"),e.jsx("td",{onClick:d=>d.stopPropagation(),children:h&&e.jsx("input",{type:"number",className:"form-control",value:(o==null?void 0:o.qty_done)||"",onChange:d=>t(r.id,"qty_done",d.target.value===""?0:parseInt(d.target.value)||0),min:0})},"qty_done"),e.jsx("td",{onClick:d=>d.stopPropagation(),children:h&&e.jsx("input",{type:"number",className:"form-control",value:(o==null?void 0:o.qty_out)||"",onChange:d=>t(r.id,"qty_out",d.target.value===""?0:parseInt(d.target.value)||0),min:0})},"qty_out"),e.jsx("td",{onClick:d=>d.stopPropagation(),children:h&&e.jsx("input",{type:"number",className:"form-control",value:(o==null?void 0:o.hpp)||"",onChange:d=>t(r.id,"hpp",d.target.value===""?0:parseFloat(d.target.value)||0),min:0,step:"0.01"})},"hpp")):A.push(e.jsx("td",{children:r.qty_order},"qty_order"),e.jsx("td",{onClick:d=>d.stopPropagation(),children:h&&e.jsx("input",{type:"number",className:"form-control",value:(o==null?void 0:o.qty_out)||"",onChange:d=>t(r.id,"qty_out",d.target.value===""?0:parseInt(d.target.value)||0),max:r.qty_order,min:0})},"qty_out")),A};return e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{children:"Select SPK Details"}),n.map(r=>{const l=c==null?void 0:c.find(N=>N.id===r),h=p[r]||[],o=h.length>0&&h.every(N=>u.some(y=>y.spk_detail_id===N.id)),A=h.some(N=>u.some(y=>y.spk_detail_id===N.id));return e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{children:[l==null?void 0:l.noSpk," - ",l==null?void 0:l.buyer]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:o,ref:N=>{N&&(N.indeterminate=A&&!o)},onChange:N=>x(r,N.target.checked,l,h)})}),v().slice(1)]})}),e.jsx("tbody",{children:h.map(N=>{const y=u.some(K=>K.spk_detail_id===N.id);return e.jsx("tr",{className:`cursor-pointer ${y?"table-active":""}`,onClick:()=>s(N,l,!y),children:m(N,l)},N.id)})})]})})]},r)})]})},Ye=()=>{const n=Y(),{addDeliveryNote:c}=Z(),{currentUser:p}=pe(),{formData:u,updateFormData:i}=qe(),{spkList:s,selectedSpks:x,spkDetails:t,toggleSpkSelection:v}=Se(),{selectedDetails:m,handleDetailSelect:r,handleSelectAllDetails:l,updateDetail:h}=ke(u.delivery_note_type),o=()=>{if(!u.delivery_note_no||!u.delivery_note_date||!u.vendor_id||!u.destination){alert("Please fill all required fields");return}if(m.length===0){alert("Please select at least one SPK detail");return}if(p){const A={...u,user_id:p==null?void 0:p.full_name,details:m.map(N=>({spk_detail_id:N.spk_detail_id,item_type:N.item_type,product_variant_id:N.product_variant_id,material_id:N.material_id,qty_out:N.qty_out,qty_in:N.qty_in,labor_cost:N.labor_cost,material_name:N.material_name,material_qty:N.material_qty,short_material:N.short_material,qty_done:N.qty_done,hpp:N.hpp,selisih:N.selisih}))};console.log(A),c(A),n("/production/surat-jalan")}};return e.jsx("div",{className:"container-fluid",children:e.jsxs(xe,{children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Add Surat Jalan"})}),e.jsxs("div",{className:"card-body",children:[e.jsx(we,{formData:u,updateFormData:i}),e.jsx(Pe,{spkList:s,selectedSpks:x,toggleSpkSelection:v}),e.jsx(Ke,{selectedSpks:x,spkList:s,spkDetails:t,selectedDetails:m,deliveryNoteType:u.delivery_note_type,handleDetailSelect:r,handleSelectAllDetails:l,updateDetail:h}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-primary",onClick:o,children:"Save Surat Jalan"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>n("/production/surat-jalan"),children:"Cancel"})]})]})]})})},Ze=()=>{const n=Y(),{id:c}=he(),{currentUser:p}=pe(),{updateDeliveryNote:u}=Z(),{deliveryNote:i,isLoading:s,error:x}=X(c||""),t=q.useRef(!1),v=q.useRef(!1),m=q.useMemo(()=>{var f;if(i)return{delivery_note_no:i.delivery_note_no,delivery_note_date:i.delivery_note_date,delivery_note_type:i.delivery_note_type,vendor_id:i.vendor_id||((f=i.vendor)==null?void 0:f.id)||"",destination:i.destination,status:i.status,notes:i.notes||"",user_id:(p==null?void 0:p.full_name)||"system"}},[i,p==null?void 0:p.full_name]),{formData:r,updateFormData:l}=qe(m,{autoGenerateNo:!1,autoSetDate:!1}),{spkList:h,selectedSpks:o,spkDetails:A,toggleSpkSelection:N,setSelectedSpks:y}=Se(),{selectedDetails:K,handleDetailSelect:a,handleSelectAllDetails:d,updateDetail:k,setSelectedDetails:S}=ke(r.delivery_note_type);q.useEffect(()=>{if(!(i!=null&&i.spk)||i.spk.length===0||t.current)return;const f=i.spk.map(b=>b.id).filter(Boolean);f.length>0&&(t.current=!0,y(f))},[i,y]),q.useEffect(()=>{var C;if(!((C=i==null?void 0:i.details)!=null&&C.length)||!o.length)return;const f=o.every(j=>A[j]);if(v.current&&!f)return;const P=new Map;if(i.spk_details&&i.spk_details.forEach(j=>{var B,z,g;const _={id:j.id,product_variants:j.product_variants,product_name:((B=j.product_variants)==null?void 0:B.product_name)||"",size:((z=j.product_variants)==null?void 0:z.size)||"",color:((g=j.product_variants)==null?void 0:g.color)||"",qty_order:j.qty_order,qty_done:j.qty_done,qty_reject:j.qty_reject,qty_shipped:0,progress:j.progress||"",status:j.status||"",cost_price:j.cost_price,bom:[],stages:[],req_material:[]};P.set(j.id,_)}),o.forEach(j=>{A[j]&&A[j].forEach(_=>{P.set(_.id,_)})}),P.size===0)return;const I=i.details.map(j=>{var z,g,D,V,ee,te,se,re,ne,ae,ie;const _=P.get(j.spk_detail_id);let B=(z=i.spk)==null?void 0:z.find(de=>{var le;return A[de.id]&&A[de.id].map(Ce=>Ce.id).includes(j.spk_detail_id)?!0:((le=i.spk_details)==null?void 0:le.some(ce=>ce.id===j.spk_detail_id))||!1});return!B&&i.spk&&i.spk.length>0&&(B=i.spk[0]),{spk_detail_id:j.spk_detail_id,item_type:j.item_type,product_variant_id:j.product_variant_id||((g=_==null?void 0:_.product_variants)==null?void 0:g.id)||"",material_id:j.material_id,qty_out:j.qty_out,qty_in:j.qty_in,labor_cost:j.labor_cost,spk_no:(B==null?void 0:B.spk_no)||((V=(D=i.spk)==null?void 0:D[0])==null?void 0:V.spk_no)||"",product_name:(_==null?void 0:_.product_name)||((ee=_==null?void 0:_.product_variants)==null?void 0:ee.product_name)||"",color:(_==null?void 0:_.color)||((te=_==null?void 0:_.product_variants)==null?void 0:te.color)||"",size:(_==null?void 0:_.size)||((se=_==null?void 0:_.product_variants)==null?void 0:se.size)||"",qty_order:(_==null?void 0:_.qty_order)||0,material_name:j.material_name||((ne=(re=_==null?void 0:_.req_material)==null?void 0:re[0])==null?void 0:ne.material_name)||"",material_qty:j.material_qty||((ie=(ae=_==null?void 0:_.req_material)==null?void 0:ae[0])==null?void 0:ie.qty_required)||0,short_material:j.short_material||0,qty_done:j.qty_done||(_==null?void 0:_.qty_done)||0,hpp:j.hpp||0,selisih:j.selisih||0,req_material:(_==null?void 0:_.req_material)||[]}});S(I),Object.keys(A).length>0&&o.every(j=>A[j])&&(v.current=!0)},[i,o,A,S]);const w=()=>{if(!c){alert("Delivery note ID tidak ditemukan");return}if(!r.delivery_note_no||!r.delivery_note_date||!r.vendor_id||!r.destination){alert("Please fill all required fields");return}if(K.length===0){alert("Please select at least one SPK detail");return}const f={...r,id:c,user_id:(p==null?void 0:p.full_name)||r.user_id,details:K.map(b=>({spk_detail_id:b.spk_detail_id,item_type:b.item_type,product_variant_id:b.product_variant_id,material_id:b.material_id,qty_out:b.qty_out,qty_in:b.qty_in,labor_cost:b.labor_cost,material_name:b.material_name,material_qty:b.material_qty,short_material:b.short_material,qty_done:b.qty_done,hpp:b.hpp,selisih:b.selisih}))};u(f),n("/production/surat-jalan")};return s?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):x||!i?e.jsx("div",{className:"alert alert-danger",children:x?x.message:"Delivery note tidak ditemukan"}):e.jsx("div",{className:"container-fluid",children:e.jsx(xe,{children:e.jsxs("div",{className:"card-body",children:[e.jsx(we,{formData:r,updateFormData:l}),e.jsx(Pe,{spkList:h,selectedSpks:o,toggleSpkSelection:N}),e.jsx(Ke,{selectedSpks:o,spkList:h,spkDetails:A,selectedDetails:K,deliveryNoteType:r.delivery_note_type,handleDetailSelect:a,handleSelectAllDetails:d,updateDetail:k}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-primary",onClick:w,children:"Update Surat Jalan"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>n("/production/surat-jalan"),children:"Cancel"})]})]})})})},F=n=>{if(!n)return"-";const c=new Date(n);return Number.isNaN(c.getTime())?n:c.toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})},T=n=>n==null?"-":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),Xe=({deliveryNoteId:n})=>{var v,m,r,l,h,o,A,N;const{deliveryNote:c,isLoading:p,error:u}=X(n||""),i=y=>{switch(y){case"PERMINTAAN_KAIN":return H;case"PENGIRIMAN_BARANG":return Ne;case"BUANG_BENANG_KELUAR":return ve;case"BUANG_BENANG_MASUK":return be;case"JAHIT_KELUAR":return fe;case"JAHIT_MASUK":return Ae;default:return H}},s=(y,K)=>{switch(y){case"PERMINTAAN_KAIN":return e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-120px",children:"Barcode"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-100px",children:"Material Name"}),e.jsx("th",{className:"min-w-100px",children:"Material Qty"}),e.jsx("th",{className:"min-w-100px",children:"Shortage"}),e.jsx("th",{className:"min-w-80px",children:"SPK Qty"}),e.jsx("th",{className:"min-w-80px",children:"Qty Order"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:K.map(a=>{var d,k,S,w,f,b,P,I,C;return e.jsxs("tr",{children:[e.jsx("td",{children:((d=a.product_variants)==null?void 0:d.product_name)||"-"}),e.jsx("td",{children:((k=a.product_variants)==null?void 0:k.sku)||"-"}),e.jsx("td",{children:((S=a.product_variants)==null?void 0:S.barcode)||a.barcode||"-"}),e.jsx("td",{children:((w=a.product_variants)==null?void 0:w.size)||"-"}),e.jsx("td",{children:((f=a.product_variants)==null?void 0:f.color)||"-"}),e.jsx("td",{children:((b=a.product_variants)==null?void 0:b.nama_material)||"-"}),e.jsx("td",{children:((P=a.product_variants)==null?void 0:P.jumlah_material)||"-"}),e.jsx("td",{children:((I=a.product_variants)==null?void 0:I.kurang_material)||"-"}),e.jsx("td",{children:((C=a.product_variants)==null?void 0:C.qty_spk)||"-"}),e.jsx("td",{children:a.qty_order||"-"})]},a.id)})})]});case"PENGIRIMAN_BARANG":return e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-120px",children:"Barcode"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"SPK Qty"}),e.jsx("th",{className:"min-w-80px",children:"Qty Done"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"}),e.jsx("th",{className:"min-w-100px",children:"HPP"}),e.jsx("th",{className:"min-w-120px",children:"Price"}),e.jsx("th",{className:"min-w-120px",children:"Cost Price"}),e.jsx("th",{className:"min-w-80px",children:"Qty Done"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:K.map(a=>{var d,k,S,w,f,b,P,I,C,j,_;return e.jsxs("tr",{children:[e.jsx("td",{children:((d=a.product_variants)==null?void 0:d.product_name)||"-"}),e.jsx("td",{children:((k=a.product_variants)==null?void 0:k.sku)||"-"}),e.jsx("td",{children:((S=a.product_variants)==null?void 0:S.barcode)||a.barcode||"-"}),e.jsx("td",{children:((w=a.product_variants)==null?void 0:w.size)||"-"}),e.jsx("td",{children:((f=a.product_variants)==null?void 0:f.color)||"-"}),e.jsx("td",{children:((b=a.product_variants)==null?void 0:b.qty_spk)||"-"}),e.jsx("td",{children:((P=a.product_variants)==null?void 0:P.qty_done)||"-"}),e.jsx("td",{children:((I=a.product_variants)==null?void 0:I.qty_out)||"-"}),e.jsx("td",{children:T((C=a.product_variants)==null?void 0:C.hpp)}),e.jsx("td",{children:T((j=a.product_variants)==null?void 0:j.price)}),e.jsx("td",{children:T((_=a.product_variants)==null?void 0:_.cost_price)}),e.jsx("td",{children:a.qty_done||"-"})]},a.id)})})]});case"BUANG_BENANG_KELUAR":return e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-120px",children:"Barcode"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"Qty Order"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:K.map(a=>{var d,k,S,w,f,b,P;return e.jsxs("tr",{children:[e.jsx("td",{children:((d=a.product_variants)==null?void 0:d.product_name)||"-"}),e.jsx("td",{children:((k=a.product_variants)==null?void 0:k.sku)||"-"}),e.jsx("td",{children:((S=a.product_variants)==null?void 0:S.barcode)||a.barcode||"-"}),e.jsx("td",{children:((w=a.product_variants)==null?void 0:w.size)||"-"}),e.jsx("td",{children:((f=a.product_variants)==null?void 0:f.color)||"-"}),e.jsx("td",{children:((b=a.product_variants)==null?void 0:b.qty_order)||"-"}),e.jsx("td",{children:((P=a.product_variants)==null?void 0:P.qty_out)||"-"})]},a.id)})})]});case"BUANG_BENANG_MASUK":return e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-120px",children:"Barcode"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"SPK Qty"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"}),e.jsx("th",{className:"min-w-80px",children:"Qty In"}),e.jsx("th",{className:"min-w-80px",children:"Difference"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:K.map(a=>{var d,k,S,w,f,b,P,I,C;return e.jsxs("tr",{children:[e.jsx("td",{children:((d=a.product_variants)==null?void 0:d.product_name)||"-"}),e.jsx("td",{children:((k=a.product_variants)==null?void 0:k.sku)||"-"}),e.jsx("td",{children:((S=a.product_variants)==null?void 0:S.barcode)||a.barcode||"-"}),e.jsx("td",{children:((w=a.product_variants)==null?void 0:w.size)||"-"}),e.jsx("td",{children:((f=a.product_variants)==null?void 0:f.color)||"-"}),e.jsx("td",{children:((b=a.product_variants)==null?void 0:b.qty_spk)||"-"}),e.jsx("td",{children:((P=a.product_variants)==null?void 0:P.qty_out)||"-"}),e.jsx("td",{children:((I=a.product_variants)==null?void 0:I.qty_in)||"-"}),e.jsx("td",{children:((C=a.product_variants)==null?void 0:C.selisih)||"-"})]},a.id)})})]});case"JAHIT_KELUAR":return e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-120px",children:"Barcode"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"Qty Order"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:K.map(a=>{var d,k,S,w,f,b,P;return e.jsxs("tr",{children:[e.jsx("td",{children:((d=a.product_variants)==null?void 0:d.product_name)||"-"}),e.jsx("td",{children:((k=a.product_variants)==null?void 0:k.sku)||"-"}),e.jsx("td",{children:((S=a.product_variants)==null?void 0:S.barcode)||a.barcode||"-"}),e.jsx("td",{children:((w=a.product_variants)==null?void 0:w.size)||"-"}),e.jsx("td",{children:((f=a.product_variants)==null?void 0:f.color)||"-"}),e.jsx("td",{children:((b=a.product_variants)==null?void 0:b.qty_order)||"-"}),e.jsx("td",{children:((P=a.product_variants)==null?void 0:P.qty_out)||"-"})]},a.id)})})]});case"JAHIT_MASUK":return e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-120px",children:"Barcode"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"SPK Qty"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"}),e.jsx("th",{className:"min-w-80px",children:"Qty In"}),e.jsx("th",{className:"min-w-80px",children:"Difference"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:K.map(a=>{var d,k,S,w,f,b,P,I,C;return e.jsxs("tr",{children:[e.jsx("td",{children:((d=a.product_variants)==null?void 0:d.product_name)||"-"}),e.jsx("td",{children:((k=a.product_variants)==null?void 0:k.sku)||"-"}),e.jsx("td",{children:((S=a.product_variants)==null?void 0:S.barcode)||a.barcode||"-"}),e.jsx("td",{children:((w=a.product_variants)==null?void 0:w.size)||"-"}),e.jsx("td",{children:((f=a.product_variants)==null?void 0:f.color)||"-"}),e.jsx("td",{children:((b=a.product_variants)==null?void 0:b.qty_spk)||"-"}),e.jsx("td",{children:((P=a.product_variants)==null?void 0:P.qty_out)||"-"}),e.jsx("td",{children:((I=a.product_variants)==null?void 0:I.qty_in)||"-"}),e.jsx("td",{children:((C=a.product_variants)==null?void 0:C.selisih)||"-"})]},a.id)})})]});default:return e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-120px",children:"Barcode"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"Qty Order"}),e.jsx("th",{className:"min-w-80px",children:"Qty Done"}),e.jsx("th",{className:"min-w-80px",children:"Qty Reject"}),e.jsx("th",{className:"min-w-80px",children:"Progress"}),e.jsx("th",{className:"min-w-100px",children:"Status"}),e.jsx("th",{className:"min-w-120px",children:"Cost Price"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:K.map(a=>{var d,k,S,w,f;return e.jsxs("tr",{children:[e.jsx("td",{children:((d=a.product_variants)==null?void 0:d.product_name)||"-"}),e.jsx("td",{children:((k=a.product_variants)==null?void 0:k.sku)||"-"}),e.jsx("td",{children:((S=a.product_variants)==null?void 0:S.barcode)||a.barcode||"-"}),e.jsx("td",{children:((w=a.product_variants)==null?void 0:w.size)||"-"}),e.jsx("td",{children:((f=a.product_variants)==null?void 0:f.color)||"-"}),e.jsx("td",{children:a.qty_order}),e.jsx("td",{children:a.qty_done}),e.jsx("td",{children:a.qty_reject}),e.jsx("td",{children:a.progress}),e.jsx("td",{children:a.status?e.jsx(G,{status:a.status.toLowerCase()}):"-"}),e.jsx("td",{children:T(a.cost_price)})]},a.id)})})]})}},x=c?i(c.delivery_note_type):null,t=x?{...x.deliveryNote,details:x.details||[],spk:x.spk||[],spk_details:x.spkDetails||[]}:null;return n?p?e.jsx(J,{children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"200px"},children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):u?e.jsx(J,{children:e.jsxs("div",{className:"alert alert-danger",children:["Error loading delivery note: ",u.message]})}):t?e.jsxs(J,{children:[e.jsxs("div",{className:"card mb-5",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"card-title",children:e.jsxs("h3",{className:"card-label",children:["Delivery Note #",t.delivery_note_no]})})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-6 col-md-12 mb-4 mb-lg-0",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Delivery Note No:"})," ",t.delivery_note_no]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Delivery Date:"})," ",F(t.delivery_note_date)]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Type:"})," ",t.delivery_note_type]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Vendor:"})," ",((v=t.vendor)==null?void 0:v.name)||"-"]})]}),e.jsxs("div",{className:"col-lg-6 col-md-12",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Destination:"})," ",t.destination]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Status:"})," ",t.status?e.jsx(G,{status:t.status.toLowerCase()}):"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Notes:"})," ",t.notes||"-"]})]})]})})]}),e.jsxs("div",{className:"card mb-5",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Vendor Information"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-6 col-md-12 mb-4 mb-lg-0",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Name:"})," ",((m=t.vendor)==null?void 0:m.name)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Contact Person:"})," ",((r=t.vendor)==null?void 0:r.contact_person)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Phone:"})," ",((l=t.vendor)==null?void 0:l.phone)||"-"]})]}),e.jsxs("div",{className:"col-lg-6 col-md-12",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Email:"})," ",((h=t.vendor)==null?void 0:h.email)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Address:"})," ",((o=t.vendor)==null?void 0:o.address)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"City:"})," ",t.vendor?`${t.vendor.city}, ${t.vendor.province}, ${t.vendor.country}`:"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Zip Code:"})," ",((A=t.vendor)==null?void 0:A.zip_code)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Tax Number:"})," ",((N=t.vendor)==null?void 0:N.tax_number)||"-"]})]})]})})]}),t.details&&t.details.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Delivery Details"})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"d-block",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-125px",children:"SPK Detail ID"}),e.jsx("th",{className:"min-w-100px",children:"Item Type"}),e.jsx("th",{className:"min-w-100px",children:"Product Variant ID"}),e.jsx("th",{className:"min-w-100px",children:"Material ID"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"}),e.jsx("th",{className:"min-w-80px",children:"Qty In"}),e.jsx("th",{className:"min-w-100px",children:"Labor Cost"}),e.jsx("th",{className:"min-w-100px",children:"Status"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:t.details.map((y,K)=>e.jsxs("tr",{children:[e.jsx("td",{children:y.spk_detail_id}),e.jsx("td",{children:y.item_type}),e.jsx("td",{children:y.product_variant_id||"-"}),e.jsx("td",{children:y.material_id||"-"}),e.jsx("td",{children:y.qty_out}),e.jsx("td",{children:y.qty_in}),e.jsx("td",{children:T(y.labor_cost)}),e.jsx("td",{children:y.status?e.jsx(G,{status:y.status.toLowerCase()}):"-"})]},y.id||K))})]})})})})]}),t.spk&&t.spk.length>0&&e.jsxs("div",{className:"card mt-5",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Related SPK Information"})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"d-block",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-175px",children:"SPK No"}),e.jsx("th",{className:"min-w-150px",children:"Buyer"}),e.jsx("th",{className:"min-w-125px",children:"SPK Date"}),e.jsx("th",{className:"min-w-125px",children:"Deadline"}),e.jsx("th",{className:"min-w-125px",children:"Status"}),e.jsx("th",{className:"min-w-200px",children:"Notes"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:t.spk.map(y=>e.jsxs("tr",{children:[e.jsx("td",{children:y.spk_no}),e.jsx("td",{children:y.buyer}),e.jsx("td",{children:F(y.spk_date)}),e.jsx("td",{children:F(y.deadline)}),e.jsx("td",{children:y.status?e.jsx(G,{status:y.status.toLowerCase()}):"-"}),e.jsx("td",{children:y.notes||"-"})]},y.id))})]})})})})]}),t.spk_details&&t.spk_details.length>0&&e.jsxs("div",{className:"card mt-5",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"card-title",children:["SPK Details - ",t.delivery_note_type.replace(/_/g," ")]})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"d-block",children:e.jsx("div",{className:"table-responsive",children:s(t.delivery_note_type,t.spk_details)})})})]})]}):e.jsx(J,{children:e.jsx("div",{className:"alert alert-warning",children:"Delivery note not found."})}):e.jsx(J,{children:e.jsx("div",{className:"alert alert-warning",children:"Delivery note ID is required."})})},Ve=[{title:"Surat Jalan",path:"/production/surat-jalan",isSeparator:!1,isActive:!1}],et=()=>{const{id:n}=he();return e.jsxs(e.Fragment,{children:[e.jsx(Q,{breadcrumbs:Ve,children:"Delivery Note Detail"}),e.jsx(Xe,{deliveryNoteId:n})]})},tt=()=>e.jsx(me,{children:e.jsxs(R,{element:e.jsx(e.Fragment,{children:e.jsx(_e,{})}),children:[e.jsx(R,{path:"detail/:id",element:e.jsx(et,{})}),e.jsx(R,{index:!0,element:e.jsx(ue,{to:"/production/surat-jalan"})})]})}),W=[{title:"Produksi > ",path:"/production/",isSeparator:!1,isActive:!1}],mt=()=>e.jsx(me,{children:e.jsxs(R,{element:e.jsx(_e,{}),children:[e.jsx(R,{path:"surat-jalan",element:e.jsxs(e.Fragment,{children:[e.jsx(Q,{breadcrumbs:W,children:"Surat Jalan"}),e.jsx(Fe,{})]})}),e.jsx(R,{path:"add-surat-jalan",element:e.jsxs(e.Fragment,{children:[e.jsx(Q,{breadcrumbs:W,children:"Add Surat Jalan"}),e.jsx(Ye,{})]})}),e.jsx(R,{path:"edit-surat-jalan/:id",element:e.jsxs(e.Fragment,{children:[e.jsx(Q,{breadcrumbs:W,children:"Update Surat Jalan"}),e.jsx(Ze,{})]})}),e.jsx(R,{path:"delivery-note-detail/*",element:e.jsx(tt,{})}),e.jsx(R,{index:!0,element:e.jsx(ue,{to:"/production/dashboard"})})]})});export{mt as default};
