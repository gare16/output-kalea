import{U as T,Q as D,r as l,j as e,K as o,P as M,C as K}from"./index-ByLk8s-j.js";import{m as A}from"./mockData-BDmv_6uE.js";import{u as L,g as V}from"./index-Dy2nfz69.js";const P=[{title:"Inventory >",path:"/inventory",isSeparator:!1,isActive:!1},{title:"Stock >",path:"/inventory/stock-material",isSeparator:!1,isActive:!1}],I=()=>{const{id:g}=T(),m=D(),[t,y]=l.useState(null),[b,p]=l.useState(!0),[N,v]=l.useState([]),[x,k]=l.useState(""),[u,w]=l.useState(""),[d,S]=l.useState(""),[c,h]=l.useState("history"),j=l.useMemo(()=>[{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Tanggal"}),accessorKey:"date",cell:s=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:s.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Nama Produk"}),accessorKey:"productName",cell:s=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:s.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Deskripsi"}),accessorKey:"description",cell:s=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:s.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Sumber"}),accessorKey:"source",cell:s=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:s.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Stok Tersedia"}),accessorFn:s=>s.runningStock,id:"runningStock",cell:s=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:s.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Jumlah"}),accessorFn:s=>`${s.action==="Masuk"?"+":"-"}${s.quantity}`,id:"quantityChange",cell:s=>{const a=s.getValue(),r=a.startsWith("+");return e.jsx("span",{className:`fw-bold text-hover-primary d-block mb-1 fs-6 ${r?"text-success":"text-danger"}`,children:a})}},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Total Akhir"}),accessorFn:s=>s.stockAfter,id:"stockAfter",cell:s=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:s.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Aksi"}),accessorKey:"action",cell:s=>{const a=s.getValue(),r=a==="Masuk"?"badge-light-success":"badge-light-danger",i=a==="Masuk"?"Masuk":"Keluar";return e.jsx("span",{className:`badge ${r} fw-semibold fs-7`,children:i})}}],[]),f=L({data:N,columns:j,getCoreRowModel:V()});return l.useEffect(()=>{const s=Math.floor(Math.random()*7)+1,a=A.find(r=>r.id===s.toString());a?y(a):m("/inventory/stock-product"),p(!1)},[g,m]),l.useEffect(()=>{if(t){let s=0;const a=[...t.history].sort((r,i)=>new Date(r.date).getTime()-new Date(i.date).getTime()).map(r=>{const i=s;r.action==="Masuk"?s+=r.quantity:r.action==="Keluar"&&(s-=r.quantity);const n=s;return{...r,productName:t.nama_produk,runningStock:i,stockAfter:n}});v(a)}},[t]),l.useEffect(()=>{if(!t)return;let s=[...t.history].sort((a,r)=>new Date(a.date).getTime()-new Date(r.date).getTime()).map(a=>{const r=t.history.slice().sort((n,C)=>new Date(n.date).getTime()-new Date(C.date).getTime()).slice(0,t.history.findIndex(n=>n.id===a.id)+1);let i=0;for(const n of r)n.action==="Masuk"?i+=n.quantity:n.action==="Keluar"&&(i-=n.quantity);return{...a,productName:t.nama_produk,runningStock:i-(a.action==="Masuk"?a.quantity:a.action==="Keluar"?-a.quantity:0),stockAfter:i}});x&&(s=s.filter(a=>new Date(a.date)>=new Date(x))),u&&(s=s.filter(a=>new Date(a.date)<=new Date(u))),d&&(s=s.filter(a=>a.productName.toLowerCase().includes(d.toLowerCase())||a.description.toLowerCase().includes(d.toLowerCase())||a.source.toLowerCase().includes(d.toLowerCase()))),c==="stockIn"?s=s.filter(a=>a.action==="Masuk"):c==="stockOut"&&(s=s.filter(a=>a.action==="Keluar")),v(s)},[x,u,d,t,c]),b?e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("div",{className:"mt-3",children:"Memuat detail Stock Inventory..."})]})}):t?b?e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("div",{className:"mt-3",children:"Memuat detail Stock Inventory..."})]})}):t?e.jsxs(e.Fragment,{children:[e.jsx(M,{breadcrumbs:P,children:t.nama_produk}),e.jsxs(K,{children:[e.jsx("div",{className:"row g-5 g-xl-8",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body py-5",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Nama Produk"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.nama_produk})]})}),e.jsx("div",{className:"col-md-1",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"SKU"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.sku})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Artikel"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.artikel})]})}),e.jsx("div",{className:"col-md-1",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Satuan"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.satuan})]})}),e.jsx("div",{className:"col-md-1",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Total Stok"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.total_stok})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Lokasi"}),e.jsxs("div",{className:"fw-bold fs-3 text-gray-800",children:[t.gudang," - ",t.nomor_rak]})]})}),e.jsx("div",{className:"col-md-3",children:e.jsx("div",{className:"d-flex flex-row h-100 justify-content-end",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>m(-1),children:[e.jsx(o,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Articles"]})})})]})})})})}),e.jsx("div",{className:"row g-5 g-xl-8 mt-5",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header border-0 pt-6",children:[e.jsxs("div",{className:"d-flex flex-wrap gap-5",children:[e.jsxs("div",{className:"card-title",children:[e.jsx(o,{iconName:"history",className:"fs-2 text-primary me-2"}),e.jsx("h3",{className:"mb-0",children:c==="stockIn"?"Riwayat Stok Masuk":c==="stockOut"?"Riwayat Stok Keluar":"Riwayat Transaksi"})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[e.jsx("button",{className:`btn ${c==="history"?"btn-primary active":"btn-outline-primary"}`,onClick:()=>h("history"),children:"Semua"}),e.jsx("button",{className:`btn ${c==="stockIn"?"btn-success active":"btn-outline-success"}`,onClick:()=>h("stockIn"),children:"Stok Masuk"}),e.jsx("button",{className:`btn ${c==="stockOut"?"btn-danger active":"btn-outline-danger"}`,onClick:()=>h("stockOut"),children:"Stok Keluar"})]})]}),e.jsxs("div",{className:"card-toolbar",children:[e.jsxs("div",{className:"d-flex align-items-center position-relative me-4",children:[e.jsx("input",{type:"date",className:"form-control form-control-sm me-2",placeholder:"Start Date",value:x,onChange:s=>k(s.target.value)}),e.jsx("span",{className:"mx-1",children:"to"}),e.jsx("input",{type:"date",className:"form-control form-control-sm ms-2",placeholder:"End Date",value:u,onChange:s=>w(s.target.value)})]}),e.jsxs("div",{className:"d-flex align-items-center position-relative",children:[e.jsx(o,{iconName:"magnifier",className:"fs-3 position-absolute ms-3 text-gray-400"}),e.jsx("input",{type:"text",className:"form-control form-control-solid w-250px ps-10",placeholder:"Cari produk, deskripsi, atau sumber...",value:d,onChange:s=>S(s.target.value)})]})]})]}),e.jsx("div",{className:"card-body py-5",children:N.length===0?e.jsxs("div",{className:"text-center py-10",children:[e.jsx(o,{iconName:"information",className:"fs-1 text-muted mb-3"}),e.jsx("p",{className:"text-muted",children:c==="stockIn"?"Tidak ada riwayat stok masuk":c==="stockOut"?"Tidak ada riwayat stok keluar":"Tidak ada riwayat transaksi yang cocok"})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-7",children:[e.jsx("thead",{children:f.getHeaderGroups().map(s=>e.jsx("tr",{className:"fw-bold text-muted",children:s.headers.map(a=>e.jsx("th",{className:"min-w-150px",children:a.isPlaceholder?null:a.column.columnDef.header({})},a.id))},s.id))}),e.jsx("tbody",{className:"text-gray-600 fw-bold",children:f.getRowModel().rows.length>0?f.getRowModel().rows.map(s=>e.jsx("tr",{children:s.getVisibleCells().map(a=>e.jsx("td",{children:a.renderValue()},a.id))},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:j.length,children:e.jsx("div",{className:"d-flex text-center w-100 align-content-center justify-content-center",children:"No matching records found"})})})})]})})})]})})})]})]}):e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"alert alert-danger",role:"alert",children:"Item tidak ditemukan"}),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>m(-1),children:[e.jsx(o,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Articles"]})]})}):e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"alert alert-danger",role:"alert",children:"Item tidak ditemukan"}),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>m(-1),children:[e.jsx(o,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Articles"]})]})})};export{I as default};
