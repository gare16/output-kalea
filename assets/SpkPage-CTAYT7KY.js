import{r as f,j as e,$ as M,a1 as H,_ as E,a2 as ne,a4 as z,a3 as U,Y as X,a0 as Y,Z as K,k as J,g as he,i as G,O as te,N as me}from"./index-C8bs7RZm.js";import{a as ue,b as pe,c as je,u as ge,l as ye,d as be,m as Ne}from"./useSpkList-Mmd1xVcq.js";import{T as fe}from"./TablesWidget13-CxemlcYz.js";import{u as $,a as Z}from"./useMutation-DVRIQfZo.js";import{u as le}from"./useVendors-9PVWaASE.js";import{M as k}from"./Modal-BZ9Bjo3z.js";import{F as a,C as g,B as P,f as L}from"./dateFormatter-BAS1RcD3.js";import{u as re,b as ve,d as _e,c as de}from"./ThemeProvider-BoXIQX2b.js";import{B as Se}from"./react-barcode-DYSHMG7p.js";import{S as we}from"./StatusBadge-DElhS85B.js";import"./hasClass-D44ucA8r.js";import"./warning-ClC9Fe-s.js";const q=f.forwardRef(({bsPrefix:n,className:r,as:s="div",...t},l)=>{const d=re(n,"row"),j=ve(),b=_e(),m=`${d}-cols`,_=[];return j.forEach(S=>{const o=t[S];delete t[S];let h;o!=null&&typeof o=="object"?{cols:h}=o:h=o;const u=S!==b?`-${S}`:"";h!=null&&_.push(`${m}${u}-${h}`)}),e.jsx(s,{ref:l,...t,className:de(r,d,..._)})});q.displayName="Row";const ie=f.forwardRef(({bsPrefix:n,className:r,striped:s,bordered:t,borderless:l,hover:d,size:j,variant:b,responsive:m,..._},S)=>{const o=re(n,"table"),h=de(r,o,b&&`${o}-${b}`,j&&`${o}-${j}`,s&&`${o}-${typeof s=="string"?`striped-${s}`:"striped"}`,t&&`${o}-bordered`,l&&`${o}-borderless`,d&&`${o}-hover`),u=e.jsx("table",{..._,className:h,ref:S});if(m){let x=`${o}-responsive`;return typeof m=="string"&&(x=`${x}-${m}`),e.jsx("div",{className:x,children:u})}return u}),ke=({show:n,onHide:r})=>{const[s,t]=f.useState({no_spk:"",buyer:"",tanggal:new Date().toISOString().split("T")[0],deadline:"",status:"PENDING",notes:"",biayaJahit:"",user_id:"system"}),[l,d]=f.useState([{variantId:"",qty:""}]),{vendors:j}=le(),{data:b}=$({queryKey:["productVariants"],queryFn:async()=>(await M.get("/product-variants")).data.data}),{data:m}=ue();f.useEffect(()=>{m&&!s.no_spk&&t(x=>({...x,no_spk:m}))},[m,s.no_spk]);const _=pe(),S=async()=>{if(!s.no_spk||!s.buyer||!s.tanggal||!s.deadline){alert("Please fill all required fields");return}if(l.some(x=>!x.variantId||!x.qty||parseInt(x.qty)<=0)){alert("Please select a product variant and enter a valid quantity for each article");return}await _.mutateAsync({no_spk:s.no_spk,buyer:s.buyer,spk_date:s.tanggal,deadline:s.deadline,status:s.status,notes:s.notes,sewing_cost:s.biayaJahit,user_id:s.user_id,details:l.map(x=>({product_variant_id:x.variantId,qty_order:x.qty}))}),r(),t({no_spk:"",buyer:"",tanggal:new Date().toISOString().split("T")[0],deadline:"",status:"PENDING",notes:"",biayaJahit:"",user_id:"system"}),d([{variantId:"",qty:""}])},o=()=>{d([...l,{variantId:"",qty:""}])},h=x=>{l.length>1&&d(l.filter((p,y)=>y!==x))},u=(x,p,y)=>{const i=[...l];i[x]={...i[x],[p]:y},d(i)};return e.jsxs(k,{show:n,onHide:r,size:"lg",children:[e.jsx(k.Header,{closeButton:!0,children:e.jsx(k.Title,{children:"Tambah SPK"})}),e.jsx(k.Body,{children:e.jsxs(a,{children:[e.jsxs(q,{children:[e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"No SPK *"}),e.jsx(a.Control,{type:"text",value:s.no_spk,onChange:x=>t({...s,no_spk:x.target.value}),placeholder:"Masukkan nomor SPK",disabled:!0})]})}),e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Vendor *"}),e.jsxs(a.Select,{value:s.buyer,onChange:x=>t({...s,buyer:x.target.value}),children:[e.jsx("option",{value:"",children:"Pilih Vendor"}),j==null?void 0:j.map(x=>e.jsx("option",{value:x.name,children:x.name},x.id))]})]})})]}),e.jsxs(q,{children:[e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Tanggal *"}),e.jsx(a.Control,{type:"date",value:s.tanggal,onChange:x=>t({...s,tanggal:x.target.value})})]})}),e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Deadline *"}),e.jsx(a.Control,{type:"date",value:s.deadline,onChange:x=>t({...s,deadline:x.target.value})})]})})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Notes"}),e.jsx(a.Control,{as:"textarea",rows:3,value:s.notes,onChange:x=>t({...s,notes:x.target.value}),placeholder:"Masukkan catatan"})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Biaya Jahit"}),e.jsx(a.Control,{type:"number",value:s.biayaJahit,onChange:x=>t({...s,biayaJahit:x.target.value}),placeholder:"Masukkan biaya jahit"})]}),e.jsx("hr",{}),l.map((x,p)=>e.jsxs(q,{className:"mb-3 align-items-end",children:[e.jsx(g,{md:5,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Product Variant *"}),e.jsxs(a.Select,{value:x.variantId,onChange:y=>u(p,"variantId",y.target.value),children:[e.jsx("option",{value:"",children:"Pilih Variant"}),b==null?void 0:b.map(y=>e.jsxs("option",{value:y.id,children:[y.product_name," - ",y.color," - ",y.size]},y.id))]})]})}),e.jsx(g,{md:5,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Qty Order *"}),e.jsx(a.Control,{type:"number",value:x.qty,onChange:y=>u(p,"qty",y.target.value)})]})}),e.jsx(g,{md:2,children:e.jsx(P,{variant:"danger",onClick:()=>h(p),disabled:l.length===1,children:"Hapus"})})]},p)),e.jsx(P,{variant:"secondary",onClick:o,children:"Tambah Artikel"})]})}),e.jsxs(k.Footer,{children:[e.jsx(P,{variant:"secondary",onClick:r,children:"Batal"}),e.jsx(P,{variant:"primary",onClick:S,disabled:_.isPending,children:_.isPending?"Menyimpan...":"Simpan"})]})]})},qe=({show:n,onHide:r,spkData:s})=>{const[t,l]=f.useState({no_spk:"",buyer:"",tanggal:"",deadline:"",notes:"",biayaJahit:""}),[d,j]=f.useState([]),{vendors:b}=le(),{data:m,isLoading:_}=$({queryKey:["productVariants"],queryFn:async()=>(await M.get("/product-variants")).data.data}),S=je(),{data:o,isLoading:h}=$({queryKey:["spkDetail",s==null?void 0:s.id],queryFn:async()=>{if(!(s!=null&&s.id))return null;const i=await M.get(`/spk/${s.id}`);return i.data.success?i.data.data:null},enabled:!!(s!=null&&s.id)&&n});f.useEffect(()=>{s&&n&&l({no_spk:s.noSpk,buyer:s.buyer,tanggal:s.spkDate,deadline:s.deadline,notes:"",biayaJahit:""})},[s,n]),f.useEffect(()=>{if(o!=null&&o.details&&m){const i=o.details.map(v=>{var w,A,I,C;return{variantId:((A=(w=v.product_variants)==null?void 0:w.id)==null?void 0:A.toString())||((I=v.product_variant_id)==null?void 0:I.toString())||"",qty:((C=v.qty_order)==null?void 0:C.toString())||""}});j(i.length>0?i:[{variantId:"",qty:""}]),l(v=>{var w;return{...v,notes:o.notes||"",biayaJahit:((w=o.sewing_cost)==null?void 0:w.toString())||""}})}},[o,m]);const u=async()=>{if(s){if(!t.no_spk||!t.buyer||!t.tanggal||!t.deadline){alert("Please fill all required fields");return}if(d.some(i=>!i.variantId||!i.qty||parseInt(i.qty)<=0)){alert("Please select a product variant and enter a valid quantity for each article");return}await S.mutateAsync({id:s.id,data:{no_spk:t.no_spk,buyer:t.buyer,spk_date:t.tanggal,deadline:t.deadline,notes:t.notes,sewing_cost:t.biayaJahit,details:d.map(i=>({product_variant_id:i.variantId,qty_order:i.qty}))}}),r()}},x=()=>{const i=m&&m.length>0?m[0].id.toString():"";j([...d,{variantId:i,qty:""}])},p=i=>{d.length>1&&j(d.filter((v,w)=>w!==i))},y=(i,v,w)=>{const A=[...d];A[i]={...A[i],[v]:w},j(A)};return n&&(_||h)&&s?e.jsxs(k,{show:n,onHide:r,size:"lg",children:[e.jsx(k.Header,{closeButton:!0,children:e.jsx(k.Title,{children:"Edit SPK"})}),e.jsx(k.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"200px"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2 mb-0",children:"Loading data..."})]})})]}):e.jsxs(k,{show:n,onHide:r,size:"lg",children:[e.jsx(k.Header,{closeButton:!0,children:e.jsx(k.Title,{children:"Edit SPK"})}),e.jsx(k.Body,{children:e.jsxs(a,{children:[e.jsxs(q,{children:[e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"No SPK *"}),e.jsx(a.Control,{type:"text",value:t.no_spk,onChange:i=>l({...t,no_spk:i.target.value}),placeholder:"Masukkan nomor SPK",disabled:!0})]})}),e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Vendor *"}),e.jsxs(a.Select,{value:t.buyer,onChange:i=>l({...t,buyer:i.target.value}),children:[e.jsx("option",{value:"",children:"Pilih Vendor"}),b==null?void 0:b.map(i=>e.jsx("option",{value:i.name,children:i.name},i.id))]})]})})]}),e.jsxs(q,{children:[e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Tanggal *"}),e.jsx(a.Control,{type:"date",value:t.tanggal,onChange:i=>l({...t,tanggal:i.target.value})})]})}),e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Deadline *"}),e.jsx(a.Control,{type:"date",value:t.deadline,onChange:i=>l({...t,deadline:i.target.value})})]})})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Notes"}),e.jsx(a.Control,{as:"textarea",rows:3,value:t.notes,onChange:i=>l({...t,notes:i.target.value}),placeholder:"Masukkan catatan"})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Biaya Jahit"}),e.jsx(a.Control,{type:"number",value:t.biayaJahit,onChange:i=>l({...t,biayaJahit:i.target.value}),placeholder:"Masukkan biaya jahit"})]}),e.jsx("hr",{}),d.map((i,v)=>e.jsxs(q,{className:"mb-3 align-items-end",children:[e.jsx(g,{md:5,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Product Variant *"}),e.jsxs(a.Select,{value:i.variantId,onChange:w=>y(v,"variantId",w.target.value),children:[e.jsx("option",{value:"",children:"Pilih Variant"}),m==null?void 0:m.map(w=>e.jsxs("option",{value:w.id.toString(),children:[w.product_name," - ",w.color," - ",w.size]},w.id))]})]})}),e.jsx(g,{md:5,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Qty Order *"}),e.jsx(a.Control,{type:"number",value:i.qty,onChange:w=>y(v,"qty",w.target.value)})]})}),e.jsx(g,{md:2,children:e.jsx(P,{variant:"danger",onClick:()=>p(v),disabled:d.length===1,children:"Hapus"})})]},v)),e.jsx(P,{variant:"secondary",onClick:x,children:"Tambah Artikel"})]})}),e.jsxs(k.Footer,{children:[e.jsx(P,{variant:"secondary",onClick:r,children:"Batal"}),e.jsx(P,{variant:"primary",onClick:u,disabled:S.isPending,children:S.isPending?"Menyimpan...":"Simpan"})]})]})},Pe=({spkDetail:n,artikel:r,bom:s})=>{const t=new Date().toLocaleDateString("id-ID");return e.jsxs("div",{style:{fontFamily:"Arial, sans-serif",maxWidth:"210mm",margin:"0 auto",padding:"20mm",backgroundColor:"#fff",color:"#000",lineHeight:"1.4",fontSize:"12px"},children:[e.jsxs("div",{style:{textAlign:"center",borderBottom:"2px solid #333",paddingBottom:"10px",marginBottom:"20px"},children:[e.jsx("h1",{style:{margin:"0",fontSize:"24px",fontWeight:"bold",color:"#333"},children:"SPK Detail"}),e.jsx("div",{style:{margin:"10px 0"},children:e.jsx(Se,{value:n.spk_no,width:1.5,height:40,fontSize:12})}),e.jsxs("p",{style:{margin:"5px 0 0 0",fontSize:"10px",color:"#666"},children:["Printed on: ",t]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"30px",padding:"15px",backgroundColor:"#f9f9f9",borderRadius:"5px"},children:[e.jsxs("div",{children:[e.jsxs("p",{style:{margin:"5px 0",fontWeight:"bold"},children:[e.jsx("span",{style:{color:"#555"},children:"No SPK:"})," ",n.spk_no]}),e.jsxs("p",{style:{margin:"5px 0",fontWeight:"bold"},children:[e.jsx("span",{style:{color:"#555"},children:"Tanggal Pembuatan SPK:"})," ",n.created_dt?L(n.created_dt):""]})]}),e.jsxs("div",{children:[e.jsxs("p",{style:{margin:"5px 0",fontWeight:"bold"},children:[e.jsx("span",{style:{color:"#555"},children:"Nama Vendor:"})," ",n.buyer]}),e.jsxs("p",{style:{margin:"5px 0",fontWeight:"bold"},children:[e.jsx("span",{style:{color:"#555"},children:"Deadline:"})," ",n.deadline?L(n.deadline):""]})]}),e.jsx("div",{style:{gridColumn:"span 2"},children:e.jsxs("p",{style:{margin:"5px 0",fontWeight:"bold"},children:[e.jsx("span",{style:{color:"#555"},children:"Notes:"})," ",n.notes]})})]}),e.jsx("h2",{style:{fontSize:"18px",marginBottom:"10px",color:"#333",borderBottom:"1px solid #ddd",paddingBottom:"5px"},children:"Artikel / Varian"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"30px",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"left",fontWeight:"bold"},children:"Produk"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"left",fontWeight:"bold"},children:"Varian"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center",fontWeight:"bold"},children:"Qty Order"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center",fontWeight:"bold"},children:"Qty Done"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center",fontWeight:"bold"},children:"Qty Shipped"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center",fontWeight:"bold"},children:"Reject"})]})}),e.jsx("tbody",{children:r.map((l,d)=>e.jsxs("tr",{style:{backgroundColor:d%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"10px"},children:l.produk}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"10px"},children:l.varian}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center"},children:l.qtyOrder}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center"},children:l.qtyDone}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center"},children:l.qtyShipped}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center"},children:l.reject})]},d))})]}),e.jsx("h2",{style:{fontSize:"18px",marginBottom:"10px",color:"#333",borderBottom:"1px solid #ddd",paddingBottom:"5px"},children:"BOM"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"left",fontWeight:"bold"},children:"Material Name"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center",fontWeight:"bold"},children:"Qty Required"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center",fontWeight:"bold"},children:"Stock Qty"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center",fontWeight:"bold"},children:"UOM"})]})}),e.jsx("tbody",{children:s.map((l,d)=>e.jsxs("tr",{style:{backgroundColor:d%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"10px"},children:l.materialName}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center"},children:l.qty_required}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center"},children:l.stock_qty}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"10px",textAlign:"center"},children:l.uom})]},d))})]}),e.jsx("div",{style:{marginTop:"40px",textAlign:"center",fontSize:"10px",color:"#666",borderTop:"1px solid #ddd",paddingTop:"10px"},children:e.jsxs("p",{children:["Kalea Attire Â© ",t.split("/")[2]]})})]})},ee=n=>$({queryKey:["spkDetail",n],queryFn:async()=>{const r=await M.get(`/spk/${n}`);if(r.data.success)return r.data.data;throw new Error("Failed to fetch SPK detail")}}),Ce=()=>{var D,Q;const n=H(),{data:r,isLoading:s,error:t}=ge(),[l,d]=f.useState(!1),[j,b]=f.useState(!1),[m,_]=f.useState(null),[S,o]=f.useState(null),h=f.useRef(null),{data:u,isLoading:x}=ee(S||""),p=[{key:"noSpk",label:"No SPK",className:"min-w-150px"},{key:"buyer",label:"Vendor",className:"min-w-150px"},{key:"tanggal",label:"Tanggal",className:"min-w-100px"},{key:"deadline",label:"Deadline",className:"min-w-100px"},{key:"status",label:"Status",className:"min-w-100px"}],y=(r||[]).map(N=>({id:N.id,noSpk:N.noSpk,buyer:N.buyer,tanggal:L(N.spkDate),deadline:L(N.deadline),status:e.jsx("span",{className:`badge badge-light-${N.status_badge}`,children:N.status_label})})),i=()=>{d(!0)},v=N=>{const B=N.id;n(`/spk/detail/${B}`)},w=f.useCallback(N=>{const B=(r||[]).find(c=>c.id===N.id);B&&(_(B),b(!0))},[r]),A=f.useCallback(N=>{const B=N.id;o(B)},[]),I=ye.useReactToPrint({contentRef:h,documentTitle:u?`SPK-${u.spk_no}`:"SPK-Detail",pageStyle:`
      @page {
        size: A4;
        margin: 20mm;
      }
      body {
        -webkit-print-color-adjust: exact !important;
        color-adjust: exact !important;
      }
    `});if(f.useEffect(()=>{u&&!x&&S&&(I(),o(null))},[u,x,I,S]),s)return e.jsx("div",{className:"container-fluid",children:e.jsx(E,{children:e.jsx("div",{className:"text-center p-5",children:"Loading SPK data..."})})});if(t)return e.jsx("div",{className:"container-fluid",children:e.jsx(E,{children:e.jsx("div",{className:"text-center p-5 text-danger",children:t.message})})});const C=((D=u==null?void 0:u.details)==null?void 0:D.map(N=>({id:N.id,produk:N.product_name,varian:`${N.color} - ${N.size}`,qtyOrder:N.qty_order,qtyDone:N.qty_done,qtyShipped:N.qty_shipped,reject:N.qty_reject,status_badge:N.status_badge,status:N.status,progress:N.progress,costPrice:N.cost_price})))||[],O=((Q=u==null?void 0:u.boms)==null?void 0:Q.map(N=>({materialName:N.material_name,qty_required:N.qty_required,stock_qty:N.stock_qty,status_badge:N.status_badge,status:N.status,uom:N.unit_of_measure})))||[];return e.jsxs("div",{className:"container-fluid",children:[u&&e.jsx("div",{ref:h,className:"spk-print-content",style:{visibility:"hidden",position:"absolute",left:"-9999px"},children:e.jsx(Pe,{spkDetail:u,artikel:C,bom:O})}),e.jsx(E,{children:e.jsx(fe,{className:"card-xl-stretch",rows:y,columns:p,labelAdd:"SPK",filters:[],onEdit:w,onPrint:A,onAddClick:i,onRowClick:v})}),e.jsx(ke,{show:l,onHide:()=>d(!1)}),j&&m&&e.jsx(qe,{show:j,onHide:()=>{b(!1),_(null)},spkData:m})]})},Ae=({spkDetail:n})=>{var t;const r=be(),{currentUser:s}=ne();return e.jsxs(E,{className:"mb-5 shadow-sm border-0",children:[e.jsx("div",{className:"card-header border-0 py-4",children:e.jsxs("div",{className:"w-100 d-flex align-items-center justify-content-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"card-title mb-2 d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-file-earmark-text-fill text-primary me-3 fs-1"}),n.spk_no]}),e.jsxs("p",{className:"text-muted mb-1 fs-5",children:[e.jsx("i",{className:"bi bi-building me-2"}),n.buyer]})]}),e.jsxs("div",{className:"text-end",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("span",{className:"badge badge-light-primary fs-6 px-3 py-2",children:[e.jsx("i",{className:"bi bi-calendar-event me-1"}),"Deadline: ",L(n.deadline)]})}),e.jsx("span",{className:`badge badge-light-${n.status_badge||"primary"} fs-7 fw-bold`,children:n.status})]})]})}),e.jsx("div",{className:"card-body pt-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-person-circle text-info me-3 fs-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"fs-7 fw-bold text-gray-700 d-block",children:"Created By"}),e.jsx("p",{className:"text-gray-900 mb-0 fw-semibold",children:n.created_by}),e.jsx("small",{className:"text-muted",children:L(n.created_dt)})]})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-check-circle text-success me-3 fs-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"fs-7 fw-bold text-gray-700 d-block",children:"Approved By"}),e.jsx("p",{className:"text-gray-900 mb-0 fw-semibold",children:n.approved_by||"-"})]})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-clock text-warning me-3 fs-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"fs-7 fw-bold text-gray-700 d-block",children:"Approved At"}),e.jsx("p",{className:"text-gray-900 mb-0 fw-semibold",children:n.approved_dt?L(n.approved_dt):"-"})]})]})}),e.jsx(z,{allowedRoles:["ADMIN","OWNER","WAREHOUSE"],children:e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-cash text-primary me-3 fs-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"fs-7 fw-bold text-gray-700 d-block",children:"Sewing Cost"}),e.jsxs("p",{className:"text-gray-900 mb-0 fw-semibold",children:["Rp. ",((t=n.sewing_cost)==null?void 0:t.toLocaleString("id-ID"))||"-"]})]})]})})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("span",{className:"fs-7 fw-bold text-gray-700 d-block",children:"Notes"}),e.jsx("p",{className:"text-gray-900 mb-0 fw-semibold",children:n.notes})]}),e.jsx(z,{allowedRoles:["ADMIN","OWNER","PRODUKSI"],children:Ne(n.status)==="draft"&&e.jsx("button",{className:"btn btn-primary btn-sm ms-3",onClick:()=>{s&&r.mutate({id:n.id,status:"APPROVE",user_id:s.full_name})},disabled:r.isPending,children:r.isPending?"Approving...":"Approve"})})]})})]})})]})},Ie=({value:n})=>e.jsxs("div",{className:"d-flex flex-column w-100 me-2",children:[e.jsx("div",{className:"d-flex flex-stack mb-2",children:e.jsx("span",{className:"text-muted me-2 fs-7 fw-semibold",children:n})}),e.jsx("div",{className:"progress h-6px w-100",children:e.jsx("div",{className:"progress-bar bg-primary",role:"progressbar",style:{width:`${n}`}})})]}),Ee=({artikel:n,selectedArtikelId:r,onSelectArtikel:s})=>{const t=H(),{id:l}=U();return e.jsx("div",{className:"tab-pane fade show active",id:"tab1",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-striped align-middle gs-0 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-0 min-w-150px",children:"Produk"}),e.jsx("th",{className:"p-0 min-w-150px",children:"Varian"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Qty Order"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Qty Done"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Qty Shipped"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Reject"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Status"}),e.jsx("th",{className:"p-0 min-w-120px",children:"Progress"})]})}),e.jsx("tbody",{children:n.map((d,j)=>e.jsxs("tr",{onClick:()=>{s(d.id),t(`/spk/detail/${l}/stage/${d.id}`)},style:{cursor:"pointer"},className:r===d.id?"table-active":"",children:[e.jsx("td",{children:e.jsx("span",{className:"text-gray-900 fw-bold",children:d.produk})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:d.varian})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:d.qtyOrder})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:d.qtyDone})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:d.qtyShipped})}),e.jsx("td",{children:e.jsx("span",{className:"text-danger",children:d.reject})}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-light-${d.status_badge==="WAITING_APPROVAL"?"warning":d.status_badge} fs-7 fw-bold`,children:d.status==="PROCESSING"?"Proses":d.status==="DONE"?"Selesai":d.status==="PENDING"?"Tertunda":d.status==="DONE_PARTIAL"?"Selesai (Partial)":d.status==="WAITING_APPROVAL"?"Menunggu Persetujuan":d.status})}),e.jsx("td",{children:e.jsx(Ie,{value:d.progress})})]},j))})]})})})},Le=({bom:n})=>e.jsx("div",{className:"tab-pane fade",id:"tab2",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table align-middle gs-0 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-0 min-w-200px",children:"Nama Material"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Qty"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Stock"}),e.jsx("th",{className:"p-0 min-w-80px",children:"Satuan Ukuran"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Status"})]})}),e.jsx("tbody",{children:n.map((r,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:r.materialName})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:r.qty_required})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:r.stock_qty})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:r.uom})}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-light-${r.status_badge} fs-7 fw-bold`,children:r.status})})]},s))})]})})}),Re=({suratJalanHistory:n})=>e.jsx("div",{className:"tab-pane fade",id:"tab4",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table align-middle gs-0 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-0 min-w-150px",children:"No Surat Jalan"}),e.jsx("th",{className:"p-0 min-w-150px",children:"Tanggal"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Status"}),e.jsx("th",{className:"p-0 min-w-200px",children:"Catatan"})]})}),e.jsx("tbody",{children:n&&n.length>0?n.map((r,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:r.no||"-"})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:r.date?L(r.date):"-"})}),e.jsx("td",{children:e.jsx(we,{status:r.status||"UNKNOWN"})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:r.notes||"-"})})]},s)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center text-muted",children:"Tidak ada history surat jalan"})})})]})})}),Te=()=>{const{id:n}=U(),[r,s]=f.useState(null),{data:t,isLoading:l,error:d}=ee(n);if(l)return e.jsx("div",{children:"Loading..."});if(d)return e.jsx("div",{children:"Error loading data"});if(!t)return e.jsx("div",{children:"No data found"});const j=t.details.map(m=>({id:m.id,produk:m.product_name,varian:`${m.color} - ${m.size}`,qtyOrder:m.qty_order,qtyDone:m.qty_done,qtyShipped:m.qty_shipped,reject:m.qty_reject,status_badge:m.status_badge,status:m.status,progress:m.progress,costPrice:m.cost_price})),b=t.boms.map(m=>({materialName:m.material_name,qty_required:m.qty_required,stock_qty:m.stock_qty,status_badge:m.status_badge,status:m.status,uom:m.unit_of_measure}));return e.jsxs("div",{className:"container-fluid",children:[e.jsx(Ae,{spkDetail:t}),e.jsxs(E,{children:[e.jsx("div",{className:"p-5",children:e.jsxs("ul",{className:"nav nav-tabs nav-line-tabs",children:[e.jsx("li",{className:"nav-item",children:e.jsx("a",{className:"nav-link active","data-bs-toggle":"tab",href:"#tab1",children:"Artikel / Varian"})}),e.jsx("li",{className:"nav-item",children:e.jsx("a",{className:"nav-link","data-bs-toggle":"tab",href:"#tab2",children:"Bahan (BOM)"})}),e.jsx("li",{className:"nav-item",children:e.jsx("a",{className:"nav-link","data-bs-toggle":"tab",href:"#tab4",children:"History Surat Jalan"})})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"tab-content",children:[e.jsx(Ee,{artikel:j,selectedArtikelId:r,onSelectArtikel:s}),e.jsx(Le,{bom:b}),e.jsx(Re,{suratJalanHistory:t.surat_jalan_history||[]})]})})]})]})},Ke=n=>$({queryKey:["spkStages",n],queryFn:async()=>{const r=await M.get(`/spk-stage/spk-detail/${n}?start=0&length=100`);if(r.data.success)return r.data.data;throw new Error("Failed to fetch SPK stages")}}),Me=()=>{const n=X();return Z({mutationFn:async r=>{const s=await M.post("/spk-stage",r);if(s.data.success)return s.data.data;throw new Error("Failed to add SPK stage")},onSuccess:()=>{n.invalidateQueries({queryKey:["spkStages"]}),K.success("SPK stage added successfully")},onError:r=>{var t;const s=r instanceof Y?(t=r.response)==null?void 0:t.data.message:r instanceof Error?r.message:"Failed to add SPK stage";Array.isArray(s)?s.forEach(l=>K.error(l)):K.error(s)}})},Be=()=>{const n=X();return Z({mutationFn:async({id:r,payload:s})=>{const t=await M.put(`/spk-stage/${r}`,s);if(t.data.success)return t.data.data;throw new Error("Failed to update SPK stage")},onSuccess:()=>{n.invalidateQueries({queryKey:["spkStages"]}),K.success("SPK stage updated successfully")},onError:r=>{var t;const s=r instanceof Y?(t=r.response)==null?void 0:t.data.message:r instanceof Error?r.message:"Failed to update SPK stage";Array.isArray(s)?s.forEach(l=>K.error(l)):K.error(s)}})},ce=n=>{const[r,s]=f.useState({stageName:"",seq:1,qtyIn:0,qtyMax:0,qtyReject:[{stageName:"Cutting",qty:""},{stageName:"Jahit",qty:""}],status:"PENDING",startAt:"",endAt:"",pic:[],...n}),t=f.useRef(void 0);return f.useEffect(()=>{const o=JSON.stringify(n);t.current!==o&&(s({stageName:"",seq:1,qtyIn:0,qtyMax:0,qtyReject:[],status:"PENDING",startAt:"",endAt:"",pic:[],...n}),t.current=o)},[n]),f.useEffect(()=>{const o=r.pic.reduce((h,u)=>h+(parseInt(u.qty||"0",10)||0),0);s(h=>({...h,qtyIn:o}))},[r.pic]),{formData:r,setFormData:s,handleFormChange:(o,h)=>{s(u=>({...u,[o]:h}))},handleNumericChange:(o,h)=>{if(h===""){s(x=>({...x,[o]:0}));return}const u=parseInt(h);!isNaN(u)&&u>=0&&s(x=>({...x,[o]:u}))},updateRejectEntry:(o,h,u)=>{s(x=>({...x,qtyReject:x.qtyReject.map((p,y)=>y===o?{...p,[h]:u}:p)}))},addPicEntry:()=>{s(o=>({...o,pic:[...o.pic,{name:"",qty:""}]}))},updatePicEntry:(o,h,u)=>{s(x=>({...x,pic:x.pic.map((p,y)=>y===o?{...p,[h]:u}:p)}))},removePicEntry:o=>{s(h=>({...h,pic:h.pic.filter((u,x)=>x!==o)}))},resetForm:o=>{s({stageName:"",seq:1,qtyIn:0,qtyMax:0,qtyReject:[{stageName:"Cutting",qty:""},{stageName:"Jahit",qty:""}],status:"PENDING",startAt:"",endAt:"",pic:[],...o})}}},Ge=({show:n,onHide:r,onSubmit:s,nextSeq:t})=>{const{formData:l,handleFormChange:d,handleNumericChange:j,addPicEntry:b,updatePicEntry:m,removePicEntry:_,resetForm:S}=ce({seq:t}),o=()=>{s(l),S({seq:t}),r()};return e.jsxs(k,{show:n,onHide:r,size:"lg",children:[e.jsx(k.Header,{closeButton:!0,children:e.jsx(k.Title,{children:"Tambah Tahapan Produksi"})}),e.jsx(k.Body,{children:e.jsxs(a,{children:[e.jsxs(q,{className:"mb-3",children:[e.jsx(g,{md:8,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Nama Tahapan"}),e.jsx(a.Control,{type:"text",value:l.stageName,onChange:h=>d("stageName",h.target.value),placeholder:"Masukkan nama tahapan"})]})}),e.jsx(g,{md:4,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Tahap"}),e.jsx(a.Control,{type:"text",value:l.seq,onChange:h=>j("seq",h.target.value),min:"1",placeholder:"1"})]})})]}),e.jsx(q,{className:"mb-3",children:e.jsx(g,{md:12,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Qty In"}),e.jsx(a.Control,{type:"text",value:l.qtyIn,onChange:h=>j("qtyIn",h.target.value),min:"0"})]})})}),e.jsx(q,{className:"mb-3",children:e.jsx(g,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Status"}),e.jsxs(a.Select,{value:l.status,onChange:h=>d("status",h.target.value),children:[e.jsx("option",{value:"PENDING",children:"Tertunda"}),e.jsx("option",{value:"PROCESSING",children:"Proses"}),e.jsx("option",{value:"DONE",children:"Selesai"})]})]})})}),e.jsxs(q,{className:"mb-3",children:[e.jsx(g,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Start At"}),e.jsx(a.Control,{type:"datetime-local",value:l.startAt,onChange:h=>d("startAt",h.target.value)})]})}),e.jsx(g,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"End At"}),e.jsx(a.Control,{type:"datetime-local",value:l.endAt,onChange:h=>d("endAt",h.target.value)})]})})]}),l.pic.map((h,u)=>e.jsxs(q,{className:"mb-3 align-items-end",children:[e.jsx(g,{md:5,children:e.jsxs(a.Group,{children:[e.jsxs(a.Label,{className:"fw-semibold text-gray-700",children:["Nama PIC ",u+1]}),e.jsx(a.Control,{type:"text",value:h.name,onChange:x=>m(u,"name",x.target.value),placeholder:"Masukkan nama PIC",className:"form-control-solid"})]})}),e.jsx(g,{md:5,children:e.jsxs(a.Group,{children:[e.jsxs(a.Label,{className:"fw-semibold text-gray-700",children:["Qty PIC ",u+1]}),e.jsx(a.Control,{type:"number",value:h.qty,onChange:x=>{const p=x.target.value,y=parseInt(String(l.qtyIn||0),10),i=parseInt(p||"0",10),v=Math.min(Math.max(isNaN(i)?0:i,0),isNaN(y)?0:y);m(u,"qty",v.toString())},min:"0",max:l.qtyIn,placeholder:"0",className:"form-control-solid"})]})}),e.jsx(g,{md:2,className:"text-end",children:e.jsx(P,{variant:"light-danger",size:"sm",className:"btn-icon",onClick:()=>_(u),disabled:l.pic.length===1,children:e.jsx("i",{className:"bi bi-trash3 fs-5"})})})]},u)),e.jsx(q,{className:"mb-3",children:e.jsx(g,{md:6,children:e.jsxs(P,{variant:"outline-primary",onClick:b,children:[e.jsx("i",{className:"bi bi-plus-circle me-2"}),"Tambah PIC"]})})})]})}),e.jsxs(k.Footer,{children:[e.jsx(P,{variant:"secondary",onClick:r,children:"Batal"}),e.jsx(P,{variant:"primary",onClick:o,children:"Simpan"})]})]})},Oe=({show:n,onHide:r,onSubmit:s,initialData:t,history:l})=>{var x,p,y;const{formData:d,handleFormChange:j,handleNumericChange:b,updateRejectEntry:m,addPicEntry:_,updatePicEntry:S,removePicEntry:o}=ce(t),h=()=>{s(d),r()},u=l||[];return e.jsxs(k,{show:n,onHide:r,size:"lg",children:[e.jsx(k.Header,{closeButton:!0,children:e.jsx(k.Title,{children:"Edit Tahapan Produksi"})}),e.jsxs(k.Body,{children:[e.jsxs(a,{children:[e.jsxs(q,{className:"mb-3",children:[e.jsx(g,{md:8,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Nama Tahapan"}),e.jsx(a.Control,{type:"text",value:d.stageName,onChange:i=>j("stageName",i.target.value),placeholder:"Masukkan nama tahapan"})]})}),e.jsx(g,{md:4,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Tahap"}),e.jsx(a.Control,{type:"text",value:d.seq,onChange:i=>b("seq",i.target.value),min:"1",placeholder:"1"})]})})]}),e.jsxs(q,{className:"mb-3",children:[e.jsx(g,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Qty In"}),e.jsx(a.Control,{type:"text",value:d.qtyIn,disabled:!0,min:"0"})]})}),e.jsx(g,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Status"}),e.jsxs(a.Select,{value:d.status,onChange:i=>j("status",i.target.value),children:[e.jsx("option",{value:"PENDING",children:"Tertunda"}),e.jsx("option",{value:"PROCESSING",children:"Proses"}),e.jsx("option",{value:"DONE",children:"Selesai"})]})]})})]}),e.jsxs(q,{className:"mb-3",children:[e.jsx(g,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Start At"}),e.jsx(a.Control,{type:"datetime-local",value:d.startAt,onChange:i=>j("startAt",i.target.value)})]})}),e.jsx(g,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"End At"}),e.jsx(a.Control,{type:"datetime-local",value:d.endAt,onChange:i=>j("endAt",i.target.value)})]})})]}),d.pic.map((i,v)=>{const A=d.pic.reduce((C,O)=>C+(parseInt(O.qty||"0",10)||0),0)-(parseInt(i.qty||"0",10)||0),I=(d.qtyMax||0)-A;return e.jsxs(q,{className:"mb-3 align-items-end",children:[e.jsx(g,{md:5,children:e.jsxs(a.Group,{children:[e.jsxs(a.Label,{className:"fw-semibold text-gray-700",children:["Nama PIC ",v+1]}),e.jsx(a.Control,{type:"text",value:i.name,onChange:C=>S(v,"name",C.target.value),placeholder:"Masukkan nama PIC",className:"form-control-solid"})]})}),e.jsx(g,{md:5,children:e.jsxs(a.Group,{children:[e.jsxs(a.Label,{className:"fw-semibold text-gray-700",children:["Qty PIC ",v+1]}),e.jsx(a.Control,{type:"number",value:i.qty,onChange:C=>{const O=C.target.value,D=parseInt(O||"0",10),Q=Math.min(Math.max(isNaN(D)?0:D,0),I);S(v,"qty",Q.toString())},min:"0",max:I||void 0,placeholder:"0",className:"form-control-solid"})]})}),e.jsx(g,{md:2,className:"text-end",children:e.jsx(P,{variant:"light-danger",size:"sm",className:"btn-icon btn-active-light-danger",onClick:()=>o(v),disabled:d.pic.length===1,children:e.jsx("i",{className:"bi bi-trash3 fs-5"})})})]},v)}),e.jsx(q,{className:"mb-3",children:e.jsx(g,{md:6,children:e.jsxs(P,{variant:"outline-primary",onClick:_,children:[e.jsx("i",{className:"bi bi-plus-circle me-2"}),"Tambah PIC"]})})}),d.stageName==="QC 1"&&e.jsx(e.Fragment,{children:e.jsxs(q,{className:"mb-3 align-items-end",children:[e.jsx(g,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{className:"fw-semibold text-gray-700",children:"Cutting Reject Qty"}),e.jsx(a.Control,{type:"number",value:((x=d.qtyReject[0])==null?void 0:x.qty)||"",onChange:i=>m(0,"qty",i.target.value),min:"0",placeholder:"0",className:"form-control-solid"})]})}),e.jsx(g,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{className:"fw-semibold text-gray-700",children:"Jahit Reject Qty"}),e.jsx(a.Control,{type:"number",value:((p=d.qtyReject[1])==null?void 0:p.qty)||"",onChange:i=>m(1,"qty",i.target.value),min:"0",placeholder:"0",className:"form-control-solid"})]})})]})}),d.stageName==="QC 2"&&e.jsx(e.Fragment,{children:e.jsx(q,{className:"mb-3 align-items-end",children:e.jsx(g,{md:12,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{className:"fw-semibold text-gray-700",children:"Qty Reject"}),e.jsx(a.Control,{type:"number",value:((y=d.qtyReject[2])==null?void 0:y.qty)||"",onChange:i=>m(2,"qty",i.target.value),min:"0",placeholder:"0",className:"form-control-solid"})]})})})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{children:"Historical Data"}),e.jsxs(ie,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Perubahan Data"}),e.jsx("th",{children:"Data Lama"}),e.jsx("th",{children:"Data Baru"}),e.jsx("th",{children:"Created By"}),e.jsx("th",{children:"Created Date"})]})}),e.jsx("tbody",{children:u.map((i,v)=>e.jsxs("tr",{children:[e.jsx("td",{children:i.field_changed}),e.jsx("td",{children:i.old_value??""}),e.jsx("td",{children:i.new_value??""}),e.jsx("td",{children:i.created_by}),e.jsx("td",{children:i.created_dt?new Date(i.created_dt).toLocaleString("id-ID"):""})]},v))})]})]})]}),e.jsxs(k.Footer,{children:[e.jsx(P,{variant:"secondary",onClick:r,children:"Batal"}),e.jsx(P,{variant:"primary",onClick:h,children:"Update"})]})]})},De=({show:n,onHide:r,history:s})=>e.jsxs(k,{show:n,onHide:r,size:"lg",children:[e.jsx(k.Header,{closeButton:!0,children:e.jsx(k.Title,{children:"Riwayat Perubahan"})}),e.jsx(k.Body,{children:e.jsxs(ie,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Perubahan Data"}),e.jsx("th",{children:"Data Lama"}),e.jsx("th",{children:"Data Baru"}),e.jsx("th",{children:"Dibuat Oleh"}),e.jsx("th",{children:"Tanggal Dibuat"})]})}),e.jsx("tbody",{children:s.map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:t.field_changed}),e.jsx("td",{children:t.old_value??"-"}),e.jsx("td",{children:t.new_value??"-"}),e.jsx("td",{children:t.created_by}),e.jsx("td",{children:t.created_dt?new Date(t.created_dt).toLocaleString("id-ID"):"-"})]},l))})]})})]}),Fe=()=>{const n=H(),{id:r,spkDetailId:s}=U(),[t,l]=f.useState(!1),[d,j]=f.useState(!1),[b,m]=f.useState(!1),[_,S]=f.useState({}),[o,h]=f.useState([]),[u,x]=f.useState([]),{data:p}=ee(r||""),{data:y}=Ke(s||""),i=Me(),v=Be(),{currentUser:w}=ne(),A=p==null?void 0:p.details.find(c=>c.id===s),I=p,C=y||[],O=()=>{l(!0)},D=c=>{S({stageName:c.stage_name,seq:c.seq,qtyIn:c.qty_in,qtyMax:c.qty_max??c.qty_in,qtyReject:c.stage_name==="QC 1"?[{stageName:"Cutting",qty:c.qty_reject.toString()},{stageName:"Jahit",qty:"0"}]:[],status:c.status,startAt:c.start_at?new Date(c.start_at).toISOString().slice(0,16):"",endAt:c.end_at?new Date(c.end_at).toISOString().slice(0,16):"",pic:c.pics&&c.pics.length>0?c.pics.map(R=>({name:R.pic,qty:R.qty.toString()})):c.pic_id?[{name:c.pic_id,qty:"0"}]:[]}),h(c.history||[]),j(!0)},Q=c=>{x(c.history||[]),m(!0)},N=c=>{const R=C.length>0?Math.max(...C.map(T=>T.seq))+1:1,W={spk_detail_id:s||"",stage_name:c.stageName,seq:R,qty_in:c.qtyIn,qty_reject:0,pic:c.pic.map(T=>({pic_id:T.name,qty:parseInt(T.qty||"0",10)})),start_at:c.startAt?new Date(c.startAt).toISOString():"",end_at:c.endAt?new Date(c.endAt).toISOString():"",status:c.status==="PROCESSING"?"PROCESSING":c.status.toUpperCase(),user_id:w==null?void 0:w.full_name};i.mutate(W,{onSuccess:()=>{l(!1)},onError:T=>{console.error("Failed to add stage:",T)}})},B=c=>{var se,ae;const R=C.find(F=>F.stage_name===c.stageName||F.seq===c.seq);if(console.log(c),!R){console.error("Stage not found for editing");return}const W=c.stageName==="QC 1"?parseInt(((se=c.qtyReject[0])==null?void 0:se.qty)||"0",10):0,T=c.stageName==="QC 1"?parseInt(((ae=c.qtyReject[1])==null?void 0:ae.qty)||"0",10):0,oe=c.stageName==="QC 1"?W+T:0,xe={stage_name:c.stageName,seq:c.seq,qty_in:c.qtyIn,qty_reject:oe,qty_reject_cutting:W,qty_reject_sewing:T,pic:c.pic.map(F=>({pic_id:F.name,qty:parseInt(F.qty||"0",10)})),start_at:c.startAt?new Date(c.startAt).toISOString():"",end_at:c.endAt?new Date(c.endAt).toISOString():"",status:c.status,user_id:""};v.mutate({id:R.id,payload:xe},{onSuccess:()=>{j(!1)},onError:F=>{console.error("Failed to update stage:",F)}})};return e.jsxs("div",{className:"container-fluid",children:[e.jsx(E,{className:"mb-5",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"card-title",children:"Detail Tahapan Produksi"}),e.jsx("p",{className:"text-muted",children:A?`${A.product_name} - ${A.color} ${A.size}`:"Produk tidak ditemukan"}),I&&e.jsxs("small",{className:"text-gray-600",children:["SPK: ",I.spk_no," | Buyer: ",I.buyer]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(z,{allowedRoles:["ADMIN","OWNER","ADMIN PRODUKSI"],children:e.jsxs(P,{variant:"dark",className:"btn btn-sm",onClick:O,disabled:!(I!=null&&I.can_add_stage),children:[e.jsx("i",{className:"bi bi-plus-circle me-2"}),"Tambah Tahapan"]})}),e.jsxs("button",{className:"btn btn-sm btn-outline-dark",onClick:()=>n(-1),children:[e.jsx("i",{className:"bi bi-arrow-left me-2"}),"Back to SPK Detail"]})]})]})})}),C.length>0?e.jsx("div",{className:"row",children:C.map((c,R)=>e.jsx("div",{className:"col-lg-4 col-md-6 mb-5",children:e.jsxs(E,{className:"h-100",children:[e.jsx("div",{className:"card-header border-0 pb-0",children:e.jsxs("div",{className:"w-100 d-flex justify-content-between align-items-center pt-4",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"card-title mb-1",children:[e.jsx("span",{className:"badge badge-circle badge-primary me-2",children:c.seq}),c.stage_name]}),e.jsx("small",{className:"text-muted",children:"Tahapan Produksi"})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(z,{allowedRoles:["ADMIN","OWNER","ADMIN PRODUKSI"],children:e.jsx(P,{variant:"outline-dark",className:"btn btn-sm",onClick:()=>D(c),disabled:!c.can_edit,title:"Edit Tahapan",children:e.jsx("i",{className:"bi bi-pencil"})})}),e.jsx(z,{allowedRoles:["ADMIN","OWNER","WAREHOUSE"],children:e.jsx(P,{variant:"outline-dark",className:"btn btn-sm",onClick:()=>Q(c),title:"Lihat Riwayat",children:e.jsx("i",{className:"bi bi-eye"})})}),e.jsx("span",{className:`badge badge-light-${c.status_badge==="WAITING_APPROVAL"?"warning":c.status_badge} fs-7 fw-bold`,children:c.status==="PROCESSING"?"Proses":c.status==="DONE"?"Selesai":c.status==="PENDING"?"Tertunda":c.status==="DONE_PARTIAL"?"Selesai (Partial)":c.status==="WAITING_APPROVAL"?"Menunggu Persetujuan":c.status})]})]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"Qty In"}),e.jsx("span",{className:"fw-bold text-gray-900",children:c.qty_in})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"Qty OK"}),e.jsx("span",{className:"fw-bold text-success",children:c.qty_in-c.qty_reject})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"Qty Reject"}),e.jsx("span",{className:"fw-bold text-danger",children:c.qty_reject})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"PIC"}),e.jsx("span",{className:"fw-bold text-gray-900",children:c.pics&&c.pics.length>0?c.pics.map(W=>W.pic).join(", "):c.pic_id||"-"})]})})]}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"Start At"}),e.jsx("span",{className:"fw-bold text-gray-900",children:c.start_at?L(c.start_at):"-"})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"End At"}),e.jsx("span",{className:"fw-bold text-gray-900",children:c.end_at?L(c.end_at):"-"})]})})]})]})]})},R))}):e.jsx(E,{children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"mb-4",children:e.jsx("i",{className:"bi bi-info-circle fs-3x text-muted"})}),e.jsx("h4",{className:"text-muted mb-2",children:"Tidak ada tahapan produksi"}),e.jsx("p",{className:"text-muted mb-0",children:"Belum ada data tahapan produksi untuk produk ini."})]})}),e.jsx(Ge,{show:t,onHide:()=>l(!1),onSubmit:N,nextSeq:C.length>0?Math.max(...C.map(c=>c.seq))+1:1}),e.jsx(Oe,{show:d,onHide:()=>j(!1),onSubmit:B,initialData:_,history:o}),e.jsx(De,{show:b,onHide:()=>m(!1),history:u})]})},$e=async n=>{if(!(await M.post("/spk-stage/approval",{id:n.id,status:n.status})).data.success)throw new Error("Failed to approve SPK stage")},Qe=async()=>{const n=await M.get("/spk-stage/waiting-approval?start=0&length=100");if(n.data.success)return n.data.data;throw new Error("Failed to fetch SPK stage waiting approval")},We=()=>$({queryKey:["spkStageWaitingApproval"],queryFn:async()=>await Qe()}),Je=()=>{const n=X();return Z({mutationFn:async r=>await $e(r),onSuccess:(r,{status:s})=>{n.invalidateQueries({queryKey:["spkStageWaitingApproval"]});const t=s==="APPROVED"?"approved":"rejected";K.success(`SPK stage ${t} successfully`)},onError:r=>{var t;const s=r instanceof Y?(t=r.response)==null?void 0:t.data.message:r instanceof Error?r.message:"Failed to process approval";Array.isArray(s)?s.forEach(l=>K.error(l)):K.error(s)}})},Ve=()=>{const{data:n,isLoading:r,error:s}=We(),t=Je();return r?e.jsx("div",{className:"container-fluid",children:e.jsx(E,{children:e.jsx("div",{className:"text-center p-5",children:"Loading approval data..."})})}):s?e.jsx("div",{className:"container-fluid",children:e.jsx(E,{children:e.jsx("div",{className:"text-center p-5 text-danger",children:s.message})})}):e.jsx("div",{className:"container-fluid",children:n&&n.length>0?e.jsx("div",{className:"row",children:n.map(l=>e.jsx("div",{className:"col-lg-6 col-xl-4",children:e.jsxs(E,{className:"h-100",children:[e.jsx("div",{className:"card-header border-0 pb-0",children:e.jsxs("div",{className:"w-100 d-flex justify-content-between align-items-center mt-6",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"card-title mb-1",children:[e.jsx("span",{className:"badge badge-circle badge-primary me-2",children:l.seq}),l.stage_name]}),e.jsx("small",{className:"text-muted",children:"Stage Production"})]}),e.jsx("span",{className:"badge badge-light-primary fs-7 fw-bold",children:"MENUNGGU PERSETUJUAN"})]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-gray-800 fw-bold mb-3",children:"SPK Information"}),e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"SPK No"}),e.jsx("span",{className:"fw-bold text-gray-900",children:l.spk.spk_no})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Buyer"}),e.jsx("span",{className:"fw-bold text-gray-900",children:l.spk.buyer})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Deadline"}),e.jsx("span",{className:"fw-bold text-gray-900",children:L(l.spk.deadline)})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Status"}),e.jsx("span",{className:"badge badge-light-success fs-7",children:l.spk.status})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-gray-800 fw-bold mb-3",children:"Product Information"}),e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-12",children:[e.jsx("small",{className:"text-muted d-block",children:"Product Name"}),e.jsx("span",{className:"fw-bold text-gray-900",children:l.product_variant.product_name})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Size"}),e.jsx("span",{className:"fw-bold text-gray-900",children:l.product_variant.size})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Color"}),e.jsx("span",{className:"fw-bold text-gray-900",children:l.product_variant.color})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"SKU"}),e.jsx("span",{className:"fw-bold text-gray-900",children:l.product_variant.sku})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-gray-800 fw-bold mb-3",children:"Production Details"}),e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-4",children:[e.jsx("small",{className:"text-muted d-block",children:"Qty In"}),e.jsx("span",{className:"fw-bold text-gray-900",children:l.qty_in})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("small",{className:"text-muted d-block",children:"Qty Reject"}),e.jsx("span",{className:"fw-bold text-danger",children:l.qty_reject})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("small",{className:"text-muted d-block",children:"Qty OK"}),e.jsx("span",{className:"fw-bold text-success",children:l.qty_in-l.qty_reject})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"PIC"}),e.jsx("span",{className:"fw-bold text-gray-900",children:l.pic_id})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Start At"}),e.jsx("span",{className:"fw-bold text-gray-900",children:l.start_at?new Date(l.start_at).toLocaleString("id-ID"):"-"})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("small",{className:"text-muted d-block",children:"End At"}),e.jsx("span",{className:"fw-bold text-gray-900",children:l.end_at?new Date(l.end_at).toLocaleString("id-ID"):"-"})]})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("button",{className:"btn btn-success btn-sm flex-fill",onClick:()=>t.mutate({id:l.id,status:"APPROVED"}),disabled:t.isPending,children:[e.jsx("i",{className:"bi bi-check-circle me-2"}),t.isPending?"Approving...":"Approve"]}),e.jsxs("button",{className:"btn btn-danger btn-sm flex-fill",onClick:()=>t.mutate({id:l.id,status:"REJECTED"}),disabled:t.isPending,children:[e.jsx("i",{className:"bi bi-x-circle me-2"}),t.isPending?"Rejecting...":"Reject"]})]})]})]})},l.id))}):e.jsx(E,{children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"mb-4",children:e.jsx("i",{className:"bi bi-info-circle fs-3x text-muted"})}),e.jsx("h4",{className:"text-muted mb-2",children:"No Approval Requests"}),e.jsx("p",{className:"text-muted mb-0",children:"There are no SPK stages waiting for approval at the moment."})]})})})},ze=({tailorData:n,isSelected:r,onSelect:s,startDate:t,endDate:l})=>{const[d,j]=f.useState(!1),b=n.work_items.filter(o=>{const h=new Date(o.work_date).getTime(),u=t?new Date(t).getTime():-1/0,x=l?new Date(l).getTime():1/0;return h>=u&&h<=x}),m=b.length,_=b.reduce((o,h)=>o+h.quantity,0),S=()=>{j(!d)};return e.jsxs(E,{className:`mb-5 ${r?"border-primary border-2":""}`,children:[e.jsx("div",{className:"card-header border-0 py-3 cursor-pointer",onClick:s,children:e.jsxs("div",{className:"w-100 d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-3",children:[e.jsxs("div",{className:"d-flex align-items-center mb-3 mb-md-0",children:[e.jsx("div",{className:"symbol symbol-40px symbol-circle me-3",children:e.jsx("span",{className:"symbol-label bg-primary text-white fw-bold fs-3",children:n.tailor_name.charAt(0)})}),e.jsx("div",{className:"flex-grow-1",children:e.jsx("h4",{className:"text-gray-900 fw-bold mb-0",children:n.tailor_name})})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-10 align-items-center w-100 w-md-auto",children:[e.jsxs("div",{className:"d-flex flex-column align-items-center align-items-md-start",children:[e.jsx("div",{className:"fs-6 text-gray-700 fw-bold",children:m}),e.jsx("div",{className:"text-gray-500 fs-7",children:"Produk"})]}),e.jsxs("div",{className:"d-flex flex-column align-items-center align-items-md-start",children:[e.jsx("div",{className:"fs-6 text-gray-700 fw-bold",children:_}),e.jsx("div",{className:"text-gray-500 fs-7",children:"Jumlah"})]}),e.jsx("button",{className:"btn btn-sm btn-light-primary ms-auto",onClick:o=>{o.stopPropagation(),S()},children:d?"Sembunyikan":"Detail"})]})]})}),d&&e.jsx("div",{className:"card-body pt-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-0 gy-3",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-gray-500 fw-bold text-uppercase fs-7",children:[e.jsx("th",{className:"min-w-150px",children:"No SPK"}),e.jsx("th",{className:"min-w-200px",children:"Nama Produk"}),e.jsx("th",{className:"min-w-150px",children:"Varian"}),e.jsx("th",{className:"min-w-150px",children:"Jumlah"}),e.jsx("th",{className:"min-w-150px",children:"Tanggal"})]})}),e.jsx("tbody",{children:b.length>0?b.map((o,h)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-gray-700",children:o.spk_no}),e.jsx("td",{className:"text-gray-800",children:o.product_name}),e.jsx("td",{className:"text-gray-600",children:o.variant_info}),e.jsx("td",{className:"text-gray-700 fw-bold",children:o.quantity}),e.jsx("td",{className:"text-gray-600",children:L(o.work_date)})]},h)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center text-gray-500 py-5",children:"Tidak ada data yang sesuai filter"})})})]})})})]})},He=()=>$({queryKey:["sewingReport"],queryFn:async()=>[{tailor_name:"Ahmad Santoso",total_products:3,total_quantity:150,work_date_range:{start_date:"2025-10-20",end_date:"2025-11-05"},work_items:[{product_name:"Kalea Oversized Hoodie",variant_info:"Hitam - L",quantity:50,work_date:"2025-10-20",spk_no:"001/SPK/X/2025"},{product_name:"Kalea Oversized Hoodie",variant_info:"Hitam - M",quantity:70,work_date:"2025-10-25",spk_no:"001/SPK/X/2025"},{product_name:"Kemeja Formal",variant_info:"Putih - L",quantity:30,work_date:"2025-11-05",spk_no:"002/SPK/XI/2025"}]},{tailor_name:"Budi Prasetyo",total_products:2,total_quantity:80,work_date_range:{start_date:"2025-10-22",end_date:"2025-11-03"},work_items:[{product_name:"Celana Chino",variant_info:"Coklat - M",quantity:30,work_date:"2025-10-22",spk_no:"003/SPK/IX/2025"},{product_name:"Celana Chino",variant_info:"Coklat - L",quantity:50,work_date:"2025-11-03",spk_no:"003/SPK/IX/2025"}]},{tailor_name:"Siti Aminah",total_products:4,total_quantity:200,work_date_range:{start_date:"2025-10-18",end_date:"2025-11-08"},work_items:[{product_name:"Dress Casual",variant_info:"Merah - S",quantity:40,work_date:"2025-10-18",spk_no:"004/SPK/X/2025"},{product_name:"Dress Casual",variant_info:"Merah - M",quantity:50,work_date:"2025-10-20",spk_no:"004/SPK/X/2025"},{product_name:"Dress Casual",variant_info:"Biru - M",quantity:60,work_date:"2025-10-25",spk_no:"005/SPK/X/2025"},{product_name:"Dress Casual",variant_info:"Biru - L",quantity:50,work_date:"2025-11-08",spk_no:"005/SPK/X/2025"}]},{tailor_name:"Rina Kusuma",total_products:2,total_quantity:90,work_date_range:{start_date:"2025-10-25",end_date:"2025-11-10"},work_items:[{product_name:"Jaket Denim",variant_info:"Biru - L",quantity:40,work_date:"2025-10-25",spk_no:"006/SPK/XI/2025"},{product_name:"Jaket Denim",variant_info:"Biru - XL",quantity:50,work_date:"2025-11-10",spk_no:"006/SPK/XI/2025"}]},{tailor_name:"Joko Susilo",total_products:3,total_quantity:120,work_date_range:{start_date:"2025-10-15",end_date:"2025-11-02"},work_items:[{product_name:"Celana Jeans",variant_info:"Biru - M",quantity:35,work_date:"2025-10-15",spk_no:"007/SPK/IX/2025"},{product_name:"Celana Jeans",variant_info:"Biru - L",quantity:45,work_date:"2025-10-20",spk_no:"007/SPK/IX/2025"},{product_name:"Celana Jeans",variant_info:"Biru - XL",quantity:40,work_date:"2025-11-02",spk_no:"008/SPK/X/2025"}]}],staleTime:300*1e3}),Ue=()=>{const{data:n,isLoading:r,error:s}=He(),[t,l]=f.useState(null),[d,j]=f.useState(""),[b,m]=f.useState(""),[_,S]=f.useState(""),o=(n==null?void 0:n.filter(p=>{const y=d?p.tailor_name.toLowerCase().includes(d.toLowerCase()):!0;let i=!0;if(b||_){const v=new Date(p.work_date_range.start_date).getTime(),w=new Date(p.work_date_range.end_date).getTime(),A=b?new Date(b).getTime():-1/0,I=_?new Date(_).getTime():1/0;i=v<=I&&w>=A}return y&&i}))||[];if(r)return e.jsx("div",{className:"container-fluid",children:e.jsx(E,{children:e.jsx("div",{className:"text-center p-5",children:"Loading report data..."})})});if(s)return e.jsx("div",{className:"container-fluid",children:e.jsx(E,{children:e.jsx("div",{className:"text-center p-5 text-danger",children:s.message})})});const h=o,u=h.reduce((p,y)=>p+y.total_products,0),x=h.reduce((p,y)=>p+y.total_quantity,0);return e.jsxs("div",{className:"container-fluid",children:[e.jsx(J,{breadcrumbs:[{title:"Laporan Jahit",path:"/spk/reports/sewing",isSeparator:!1,isActive:!1}],children:"Laporan Pengerjaan Jahit"}),e.jsxs(E,{children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsx("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center mb-5",children:e.jsxs("div",{className:"d-flex flex-wrap gap-3",children:[e.jsxs("div",{className:"position-relative",children:[e.jsxs("i",{className:"ki-duotone ki-magnifier fs-3 text-gray-500 position-absolute ms-3 mt-2",children:[e.jsx("span",{className:"path1"}),e.jsx("span",{className:"path2"})]}),e.jsx("input",{type:"text",className:"form-control form-control-sm w-200px ps-10",placeholder:"Cari penjahit...",value:d,onChange:p=>j(p.target.value)})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("input",{type:"date",className:"form-control form-control-sm",value:b,onChange:p=>m(p.target.value)}),e.jsx("span",{className:"text-gray-500",children:"-"}),e.jsx("input",{type:"date",className:"form-control form-control-sm",value:_,onChange:p=>S(p.target.value)})]})]})}),e.jsx("div",{className:"d-flex flex-wrap justify-content-between align-items-center mb-5",children:e.jsx("div",{className:"d-flex flex-column",children:e.jsxs("div",{className:"d-flex gap-5 mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"fs-2 text-gray-800 fw-bold",children:h.length}),e.jsx("div",{className:"text-gray-500 fs-7",children:"Total Penjahit"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"fs-2 text-gray-800 fw-bold",children:u}),e.jsx("div",{className:"text-gray-500 fs-7",children:"Total Produk"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"fs-2 text-gray-800 fw-bold",children:x}),e.jsx("div",{className:"text-gray-500 fs-7",children:"Total Jumlah"})]})]})})})]}),e.jsx("div",{className:"card-body py-3",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:h.map(p=>e.jsx(ze,{tailorData:p,isSelected:t===p.tailor_name,onSelect:()=>l(t===p.tailor_name?null:p.tailor_name),startDate:b,endDate:_},p.tailor_name))})})})]})]})},V=[{title:"SPK > ",path:"/spk/",isSeparator:!1,isActive:!1}],cs=()=>e.jsx(he,{children:e.jsxs(G,{element:e.jsx(te,{}),children:[e.jsx(G,{path:"list",element:e.jsxs(e.Fragment,{children:[e.jsx(J,{breadcrumbs:V,children:"SPK List"}),e.jsx(Ce,{})]})}),e.jsx(G,{path:"stage-approval",element:e.jsxs(e.Fragment,{children:[e.jsx(J,{breadcrumbs:V,children:"SPK Stage Approval"}),e.jsx(Ve,{})]})}),e.jsx(G,{path:"reports/sewing",element:e.jsxs(e.Fragment,{children:[e.jsx(J,{breadcrumbs:V,children:"Laporan Jahit"}),e.jsx(Ue,{})]})}),e.jsxs(G,{path:"detail/:id",element:e.jsx(te,{}),children:[e.jsx(G,{index:!0,element:e.jsxs(e.Fragment,{children:[e.jsx(J,{breadcrumbs:V,children:"SPK Detail"}),e.jsx(Te,{})]})}),e.jsx(G,{path:"stage/:spkDetailId",element:e.jsxs(e.Fragment,{children:[e.jsx(J,{breadcrumbs:V,children:"SPK Stage Detail"}),e.jsx(Fe,{})]})})]}),e.jsx(G,{index:!0,element:e.jsx(me,{to:"/spk/list"})})]})});export{cs as default};
