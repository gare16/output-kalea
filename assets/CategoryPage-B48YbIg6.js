import{$ as f,Y as q,a0 as x,Z as i,r as h,a2 as T,j as o,_ as w,k as F}from"./index-B54S5Xdh.js";import{T as Q}from"./TablesWidget13-BqStWbeS.js";import{D as $}from"./DynamicEditModal-XoXpGNxQ.js";import{D as P}from"./DynamicDeleteModal-BqK3Tive.js";import{D as L}from"./DynamicFormModal-DCFaYtBR.js";import{u as G,a as D}from"./useMutation-DiuxDSGp.js";import{f as A}from"./dateFormatter-D74KSFsW.js";import"./ThemeProvider-DVLJd33k.js";import"./Modal-iaWj1Lk0.js";import"./hasClass-CM2N8zXm.js";import"./warning-CKsm1nDU.js";const O=async()=>(await f.get("/material-category?start=0&length=100")).data.data||[],z=async s=>(console.log("=== category service ==="),(await f.post("/material-category",s)).data.data),B=async(s,d)=>(await f.put(`/material-category/${s}`,d)).data.data,H=async s=>{await f.delete(`/material-category/${s}`)},I=()=>{const s=q(),d=G({queryKey:["categories"],queryFn:O}),u=D({mutationFn:z,onSuccess:e=>{console.log("Add category success:",e),s.invalidateQueries({queryKey:["categories"]}),i.success("Category added successfully")},onError:e=>{var r;const a=e instanceof x?(r=e.response)==null?void 0:r.data.message:`Gagal menambahkan vendor: ${e.message}`;Array.isArray(a)?a.forEach(n=>i.error(n)):i.error(a)}}),y=D({mutationFn:({id:e,category:a})=>B(e,a),onSuccess:e=>{console.log("Update category success:",e),s.invalidateQueries({queryKey:["categories"]}),i.success("Category updated successfully")},onError:e=>{var r;const a=e instanceof x?(r=e.response)==null?void 0:r.data.message:`Gagal mengubah vendor: ${e.message}`;Array.isArray(a)?a.forEach(n=>i.error(n)):i.error(a)}}),p=D({mutationFn:H,onSuccess:()=>{console.log("Delete category success"),s.invalidateQueries({queryKey:["categories"]}),i.success("Category deleted successfully")},onError:e=>{var r;const a=e instanceof x?(r=e.response)==null?void 0:r.data.message:`Gagal menghapus vendor: ${e.message}`;Array.isArray(a)?a.forEach(n=>i.error(n)):i.error(a)}});return{categories:d.data||[],isLoading:d.isLoading,error:d.error,addCategory:u.mutate,updateCategory:y.mutate,deleteCategory:p.mutate,isAdding:u.isPending,isUpdating:y.isPending,isDeleting:p.isPending}},R=[{title:"Dashboard",path:"/dashboard",isSeparator:!1,isActive:!1},{title:"Master Category",path:"/master-category",isSeparator:!0,isActive:!0}],oe=()=>{const{categories:s,isLoading:d,addCategory:u,updateCategory:y,deleteCategory:p}=I(),[e,a]=h.useState(!1),[r,n]=h.useState(!1),[M,b]=h.useState(!1),[l,c]=h.useState(null),{currentUser:m}=T(),_=[{key:"name",label:"Nama",className:"min-w-150px"},{key:"created_by",label:"Dibuat Oleh",className:"min-w-120px"},{key:"created_dt",label:"Dibuat Tanggal",className:"min-w-140px"},{key:"changed_by",label:"Diubah Oleh",className:"min-w-120px"},{key:"changed_dt",label:"Diubah Tanggal",className:"min-w-140px"}],k=s.map(t=>({id:t.id,name:t.name,created_by:t.created_by,created_dt:A(t.created_dt),changed_by:t.changed_by||"-",changed_dt:t.changed_dt?A(t.changed_dt):"-"})),S=()=>{a(!0)},v=t=>{u({name:t.name,user_id:m==null?void 0:m.full_name}),a(!1)},E=t=>{const g=s.find(C=>C.id===t.id);g&&(c(g),n(!0))},N=t=>{l&&(y({id:l.id,category:{name:t.name,user_id:m==null?void 0:m.full_name}}),n(!1),c(null))},j=t=>{const g=s.find(C=>C.id===t.id);g&&(c(g),b(!0))},K=()=>{l&&(p(l.id),b(!1),c(null))};return d?o.jsx(w,{children:o.jsxs("div",{className:"card-body text-center py-10",children:[o.jsx("div",{className:"spinner-border text-primary",role:"status",children:o.jsx("span",{className:"visually-hidden",children:"Loading..."})}),o.jsx("div",{className:"mt-3",children:"Memuat data kategori..."})]})}):o.jsxs("div",{className:"container-fluid",children:[o.jsx(F,{breadcrumbs:R,children:"Master Category"}),o.jsx(w,{children:o.jsx(Q,{className:"card-xl-stretch",rows:k,columns:_,labelAdd:"Category",filters:[{key:"name",label:"Filter by Name"}],onDelete:j,onEdit:E,onAddClick:S})}),e&&o.jsx(L,{show:e,title:"Tambah Kategori",fields:[{name:"name",label:"Nama Kategori",type:"text",required:!0,icon:"tag",placeholder:"Masukkan nama kategori"}],onSubmit:v,onClose:()=>a(!1)}),l&&o.jsx($,{show:r,title:"Edit Kategori",fields:[{name:"name",label:"Nama Kategori",type:"text",required:!0,icon:"tag",placeholder:"Masukkan nama kategori"}],initialData:{name:l.name},onSave:N,onClose:()=>{n(!1),c(null)}}),l&&o.jsx(P,{show:M,title:"Hapus Kategori",itemName:l.name,onConfirm:K,onClose:()=>{b(!1),c(null)}})]})};export{oe as default};
