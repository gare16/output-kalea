import{$ as g,Y as B,Z as b,a1 as C,r as f,a2 as U,j as e,k as q,J as D,a3 as P,K as r,w as K,a8 as ce,a9 as re,x as ne,y as de,aa as oe,F as R,v as Q,g as me,i as S}from"./index-Bc4aE34f.js";import{T as V}from"./TablesWidget13-BmQEtgij.js";import{D as O}from"./DynamicDeleteModal-ZQRAEQsK.js";import{D as ue}from"./DynamicEditModal-DLTfpgs3.js";import{D as xe}from"./DynamicFormModal-DHYm1mvX.js";import{u as M,a as w}from"./useMutation-WqzmH2dF.js";import{u as E}from"./useProductVariants-C1APjSO5.js";import{f as I}from"./dateFormatter-Bb4_azhc.js";import{Q as he}from"./index-D1_HQaKQ.js";import{B as A}from"./Button-DjIda4wa.js";import{u as be}from"./useMaterials-DsoDmHNQ.js";import{F as _}from"./Form-DNwP7NbJ.js";import"./ThemeProvider-BagHPtdz.js";import"./Modal-DgcRH2D3.js";import"./hasClass-DumfsQqY.js";import"./warning-CDPwB9lB.js";const pe=async()=>(await g.get("/articles?start=0&length=100")).data.data||[],Ne=async l=>{const n=(await g.get(`/articles/${l}`)).data.data;if(console.log(n),!n||!n.product_variants)throw new Error("Article not found");return n},je=async l=>(console.log("=== article service ==="),(await g.post("/articles",l)).data.data),fe=async(l,t)=>(await g.put(`/articles/${l}`,t)).data.data,ge=async l=>{await g.delete(`/articles/${l}`)},G=()=>{const l=B(),t=M({queryKey:["articles"],queryFn:pe}),n=a=>M({queryKey:["articles",a],queryFn:()=>Ne(a),enabled:!!a}),i=w({mutationFn:je,onSuccess:a=>{console.log("Add article success:",a),l.invalidateQueries({queryKey:["articles"]}),b.success("Article added successfully")},onError:a=>{console.error("Add article error:",a),b.error(a instanceof Error?a.message:"Failed to add article")}}),d=w({mutationFn:({id:a,article:p})=>fe(a,p),onSuccess:a=>{console.log("Update article success:",a),l.invalidateQueries({queryKey:["articles"]}),b.success("Article updated successfully")},onError:a=>{console.error("Update article error:",a),b.error(a instanceof Error?a.message:"Failed to update article")}}),h=w({mutationFn:ge,onSuccess:()=>{console.log("Delete article success"),l.invalidateQueries({queryKey:["articles"]}),b.success("Article deleted successfully")},onError:a=>{console.error("Delete article error:",a),b.error(a instanceof Error?a.message:"Failed to delete article")}});return{articles:t.data||[],isLoading:t.isLoading,error:t.error,useArticleById:n,addArticle:i.mutate,updateArticle:d.mutate,deleteArticle:h.mutate,isAdding:i.isPending,isUpdating:d.isPending,isDeleting:h.isPending}},ye=[{key:"title",label:"Nama",className:"min-w-140px"},{key:"content",label:"Deskripsi",className:"min-w-200px"},{key:"status",label:"Status",className:"min-w-100px"},{key:"createdBy",label:"Dibuat Oleh",className:"min-w-120px"},{key:"createdDate",label:"Dibuat Tanggal",className:"min-w-120px"},{key:"updatedBy",label:"Diubah Oleh",className:"min-w-120px"},{key:"updatedDate",label:"Diubah Tanggal",className:"min-w-120px"}],ve=[{key:"sku",label:"SKU",className:"min-w-120px"},{key:"product_name",label:"Product Name",className:"min-w-140px"},{key:"size",label:"Size",className:"min-w-100px"},{key:"color",label:"Color",className:"min-w-100px"},{key:"cost_price",label:"Cost Price",className:"min-w-120px"},{key:"price",label:"Price",className:"min-w-120px"},{key:"status",label:"Status",className:"min-w-100px"},{key:"created_by",label:"Created By",className:"min-w-120px"},{key:"created_dt",label:"Created Date",className:"min-w-120px"}],_e=[{title:"Dashboard",path:"/dashboard",isSeparator:!1,isActive:!1},{title:"Master Role",path:"/master-role",isSeparator:!0,isActive:!0}],we=()=>{const l=C(),[t,n]=f.useState("artikel"),[i,d]=f.useState(!1),[h,a]=f.useState(!1),[p,y]=f.useState(!1),[m,c]=f.useState(null),{currentUser:u}=U(),{articles:N,addArticle:k,updateArticle:o,deleteArticle:x}=G(),{productVariants:j,addProductVariant:W,updateProductVariant:Y,deleteProductVariant:Z}=E(),H=N.map(s=>({id:s.id,title:s.article_name,content:s.description||"",status:e.jsx("span",{className:`badge ${s.is_active?"badge-light-success":"badge-light-danger"}`,children:s.is_active?"Active":"Inactive"}),createdBy:s.created_by,createdDate:I(s.created_dt),updatedBy:s.changed_by||"",updatedDate:I(s.changed_dt)})),X=j.map(s=>({id:s.id,sku:s.sku,product_name:s.product_name,size:s.size,color:s.color,price:`Rp ${Number(s.price).toLocaleString("id-ID")}`,cost_price:`Rp ${Number(s.cost_price).toLocaleString("id-ID")}`,barcode:s.barcode,status:e.jsx("span",{className:`badge ${s.is_active?"badge-light-success":"badge-light-danger"}`,children:s.is_active?"Active":"Inactive"}),created_by:s.created_by,created_dt:I(s.created_dt)})),F=s=>{c(s),d(!0)},ee=()=>{m&&(t==="artikel"?x(m.id):Z(m.id)),d(!1)},$=s=>{c(s),a(!0)},se=()=>{if(!m)return{};if(t==="artikel"){const s=N.find(v=>v.id===m.id);return{title:(s==null?void 0:s.article_name)||"",content:(s==null?void 0:s.description)||"",is_active:(s==null?void 0:s.is_active)||!1}}else{const s=j.find(v=>v.id===m.id);return{article:(s==null?void 0:s.article.id)||"",productName:(s==null?void 0:s.product_name)||"",size:(s==null?void 0:s.size)||"",color:(s==null?void 0:s.color)||"",price:(s==null?void 0:s.price)||"",cost_price:(s==null?void 0:s.cost_price)||"",sku:(s==null?void 0:s.sku)||"",is_active:(s==null?void 0:s.is_active)??!0}}},ae=()=>t==="artikel"?[{name:"title",label:"Title",type:"text",required:!0,icon:"document"},{name:"content",label:"Content",type:"textarea",required:!0,icon:"message-text"},{name:"is_active",label:"Status Aktif",type:"checkbox",required:!1,icon:"check-circle"}]:[{name:"article",label:"Article",type:"select",required:!1,icon:"document",options:N.map(s=>({value:s.id,label:s.article_name}))},{name:"productName",label:"Product Name",type:"text",required:!0,icon:"document"},{name:"size",label:"Size",type:"text",required:!0,icon:"resize"},{name:"color",label:"Color",type:"text",required:!0,icon:"palette"},{name:"sku",label:"SKU",type:"text",required:!0,icon:"code"},{name:"cost_price",label:"Cost Price",type:"number",required:!0,icon:"dollar"},{name:"price",label:"Price",type:"number",required:!0,icon:"dollar"},{name:"is_active",label:"Status Aktif",type:"checkbox",required:!1,icon:"check-circle"}],te=s=>{m&&(t==="artikel"?o({id:m.id,article:{article_name:s.title,description:s.content,is_active:s.is_active}}):Y({id:m.id,productVariant:{product_name:s.productName,size:s.size,color:s.color,sku:s.sku,cost_price:s.cost_price,price:s.price,is_active:s.is_active}})),a(!1),c(null)},z=()=>{y(!0)},le=s=>{if(t==="artikel")k({article_name:s.title,description:s.content,is_active:s.is_active});else{const v=N.find(ie=>ie.id===s.article);W({article_id:v==null?void 0:v.id,product_name:s.productName,size:s.size,color:s.color,sku:s.sku,cost_price:s.cost_price,price:s.price,is_active:s.is_active,user_id:u==null?void 0:u.id})}y(!1)},L=s=>{l(t==="artikel"?`/master-product/article/${s.id}`:`/master-product/product/${s.id}`)};return e.jsxs("div",{children:[e.jsx(q,{breadcrumbs:_e,children:"Master Article & Products"}),e.jsx("div",{className:"card card-xl-stretch mb-5 mb-xl-8",children:e.jsxs("div",{className:"card-body py-3",children:[e.jsxs("ul",{className:"nav nav-stretch nav-line-tabs nav-line-tabs-2x border-transparent fs-5 fw-bold",children:[e.jsx("li",{className:"nav-item mt-2",children:e.jsx("a",{className:D("nav-link cursor-pointer",{active:t==="artikel"}),onClick:()=>n("artikel"),children:"Articles"})}),e.jsx("li",{className:"nav-item mt-2",children:e.jsx("a",{className:D("nav-link cursor-pointer",{active:t==="product"}),onClick:()=>n("product"),children:"Products"})})]}),e.jsxs("div",{className:"tab-content mt-5",children:[e.jsx("div",{className:D("tab-pane",{active:t==="artikel"}),children:e.jsx(V,{className:"card-xl-stretch",rows:H,columns:ye,labelAdd:"Add Article",filters:[{key:"title",label:"Filter by Title"}],onDelete:F,onEdit:$,onAdd:z,onRowClick:s=>L(s)})}),e.jsx("div",{className:D("tab-pane",{active:t==="product"}),children:e.jsx(V,{className:"card-xl-stretch",rows:X,columns:ve,labelAdd:"Add Product",filters:[{key:"product_name",label:"Filter by Product Name"}],onDelete:F,onEdit:$,onAdd:z,onRowClick:L})})]})]})}),i&&m&&e.jsx(O,{show:i,title:`Delete ${t==="artikel"?"Article":"Product"}`,itemName:t==="artikel"?m.title:m.product_name,onConfirm:ee,onClose:()=>{d(!1),c(null)}}),h&&m&&e.jsx(ue,{show:h,title:`Edit ${t==="artikel"?"Article":"Product"}`,fields:ae(),initialData:se(),onSave:te,onClose:()=>{a(!1),c(null)}}),p&&e.jsx(xe,{show:p,title:`Add ${t==="artikel"?"Article":"Product"}`,fields:t==="artikel"?[{name:"title",label:"Article Name",type:"text",required:!0,icon:"document"},{name:"content",label:"Description",type:"textarea",required:!1,icon:"message-text"},{name:"is_active",label:"Status Aktif",type:"checkbox",required:!1,icon:"check-circle"}]:[{name:"article",label:"Article",type:"select",required:!0,icon:"document",options:N.map(s=>({value:s.id,label:s.article_name}))},{name:"sku",label:"SKU",type:"text",required:!0,icon:"code"},{name:"productName",label:"Product Name",type:"text",required:!0,icon:"document"},{name:"size",label:"Size",type:"text",required:!0,icon:"resize"},{name:"color",label:"Color",type:"text",required:!0,icon:"palette"},{name:"cost_price",label:"Cost Price",type:"number",required:!1,icon:"dollar"},{name:"price",label:"Price",type:"number",required:!1,icon:"dollar"},{name:"is_active",label:"Status Aktif",type:"checkbox",required:!1,icon:"check-circle"}],onSubmit:le,onClose:()=>y(!1)})]})},Ae=()=>{const{id:l}=P(),t=C(),{useArticleById:n}=G(),{data:i,isLoading:d,error:h}=n(l);return f.useEffect(()=>{!d&&!i&&t("/error/404")},[i,d,t]),d?e.jsx("div",{children:"Loading..."}):h||!i?e.jsx("div",{children:"Error loading article"}):e.jsxs("div",{className:"card shadow-sm",children:[e.jsx("div",{className:"card-header border-0 bg-light",children:e.jsxs("div",{className:"w-100 d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center",children:[e.jsxs("div",{className:"mb-3 mb-md-0",children:[e.jsx("h3",{className:"card-title mb-1",children:i.article_name}),e.jsxs("span",{className:"text-muted fs-7",children:["ID: ",i.id]})]}),e.jsx("div",{className:"d-flex gap-2",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>t(-1),children:[e.jsx(r,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Articles"]})})]})}),e.jsx("div",{className:"card-body p-3 p-lg-5",children:e.jsxs("div",{className:"row g-3 g-lg-5",children:[e.jsx("div",{className:"col-lg-8",children:e.jsxs("div",{className:"row g-3 g-md-4",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"tag",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Article Name"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:i.article_name})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"check-circle",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Status"})]}),e.jsx("span",{className:`badge ${i.is_active?"badge-light-success":"badge-light-danger"} fs-6`,children:i.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"user",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Created By"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:i.created_by})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"calendar",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Created Date"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:new Date(i.created_dt).toLocaleString()})]}),i.changed_by&&e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"user-edit",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Changed By"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:i.changed_by})]}),i.changed_dt&&e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"calendar-edit",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Changed Date"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:new Date(i.changed_dt).toLocaleString()})]}),e.jsxs("div",{className:"col-12",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"information",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Description"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:i.description||"No description"})]})]})}),e.jsx("div",{className:"col-lg-4",children:e.jsxs("div",{className:"card border",children:[e.jsx("div",{className:"card-header bg-light",children:e.jsx("h6",{className:"card-title mb-0",children:"Product Variants"})}),e.jsx("div",{className:"card-body",children:i.product_variants&&i.product_variants.length>0?e.jsx("div",{className:"list-group gap-2",children:i.product_variants.map(a=>e.jsx("button",{className:"list-group-item p-3",onClick:()=>t(`/master-product/product/${a.id}`),children:e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsxs("div",{children:[e.jsx("strong",{children:a.product_name}),e.jsx("br",{}),e.jsxs("small",{className:"text-muted",children:["Size: ",a.size,", Color: ",a.color]})]})})},a.id))}):e.jsx("p",{className:"text-muted",children:"No product variants"})})]})})]})})]})},ke=async()=>(await g.get("/bom-items?start=0&length=100")).data.data||[],De=async l=>(await g.post("/bom-items/bulk",l)).data.data,Se=async(l,t)=>{const n=t.material?{...t,materials:[{material_id:t.material.id,qty_per_unit:t.qty_per_unit}]}:t;return(await g.put(`/bom-items/bulk/${l}`,n)).data.data},qe=async l=>{await g.delete(`/bom-items/${l}`)},Ce=async l=>(await g.get(`/bom-items/${l}`)).data.data,J=()=>{const l=B(),t=M({queryKey:["bomItems"],queryFn:ke}),n=w({mutationFn:a=>De(a),onSuccess:a=>{console.log("Add bom item success:",a),l.invalidateQueries({queryKey:["bomItems"]}),b.success("BOM Item added successfully")},onError:a=>{console.error("Add bom item error:",a),b.error(a instanceof Error?a.message:"Failed to add BOM Item")}}),i=w({mutationFn:({id:a,bomItem:p})=>Se(a,p),onSuccess:a=>{console.log("Update bom item success:",a),l.invalidateQueries({queryKey:["bomItems"]}),b.success("BOM Item updated successfully")},onError:a=>{console.error("Update bom item error:",a),b.error(a instanceof Error?a.message:"Failed to update BOM Item")}}),d=w({mutationFn:qe,onSuccess:()=>{console.log("Delete bom item success"),l.invalidateQueries({queryKey:["bomItems"]}),b.success("BOM Item deleted successfully")},onError:a=>{console.error("Delete bom item error:",a),b.error(a instanceof Error?a.message:"Failed to delete BOM Item")}}),h=w({mutationFn:Ce,onSuccess:a=>{console.log("Fetch bom item by id success:",a)},onError:a=>{console.error("Fetch bom item by id error:",a),b.error(a instanceof Error?a.message:"Failed to fetch BOM Item")}});return{bomItems:t.data||[],isLoading:t.isLoading,error:t.error,addBomItem:n.mutate,updateBomItem:i.mutate,deleteBomItem:d.mutate,fetchBomItemById:h.mutate,isAdding:n.isPending,isUpdating:i.isPending,isDeleting:d.isPending}},Ie=()=>{const{id:l}=P(),t=C(),{useProductVariantById:n}=E(),{deleteBomItem:i,isDeleting:d}=J(),h=B(),{data:a,isLoading:p,error:y}=n(l),[m,c]=f.useState(!1),[u,N]=f.useState(null),k=(x,j)=>{N({bom_id:x,material_name:j}),c(!0)},o=()=>{u&&i(u.bom_id,{onSuccess:()=>{h.invalidateQueries({queryKey:["product-variants",l]}),c(!1),N(null)}})};return f.useEffect(()=>{!p&&!a&&t("/error/404")},[a,p,t]),p?e.jsx("div",{className:"d-flex justify-content-center align-items-center h-lg-400px",children:"Loading..."}):y||!a?e.jsx("div",{children:"Error loading product variant"}):e.jsxs("div",{className:"card shadow-sm",children:[e.jsx("div",{className:"card-header border-0 bg-light",children:e.jsxs("div",{className:"w-100 d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center",children:[e.jsxs("div",{className:"mb-3 mb-md-0",children:[e.jsx("h3",{className:"card-title mb-1",children:a.product_name}),e.jsxs("span",{className:"text-muted fs-7",children:["SKU: ",a.sku]})]}),e.jsx("div",{className:"d-flex gap-2",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>t(-1),children:[e.jsx(r,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Products"]})})]})}),e.jsxs("div",{className:"card-body p-3 p-lg-5",children:[e.jsxs("div",{className:"card border mb-5",children:[e.jsxs("div",{className:"card-header bg-light",children:[e.jsx("h6",{className:"card-title mb-0",children:"Barcode"}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsx("span",{className:`badge fs-7 ${a.is_active?"badge-light-success":"badge-light-warning"}`,children:a.is_active?"Active":"Inactive"})})]}),e.jsxs("div",{className:"card-body text-center",children:[e.jsx(he,{value:a.sku,size:165}),e.jsx("p",{className:"text-muted fs-7 mt-2",children:a.sku})]}),e.jsx("div",{className:"col-lg-4 p-4",children:a.article&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h6",{className:"fw-bold mb-3",children:"Article Information"}),e.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Article Name:"}),e.jsx("span",{className:"fw-semibold",children:a.article.article_name})]}),e.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Description:"}),e.jsx("span",{className:"fw-semibold",children:a.article.description||"N/A"})]})]})})]}),e.jsx("div",{className:"row g-3 g-lg-5",children:e.jsx("div",{className:"col-lg-8",children:e.jsxs("div",{className:"row g-3 g-md-4",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"tag",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Article Name"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:a.article.article_name})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"size",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Size"})]}),e.jsx("span",{className:"badge badge-light-primary fs-6",children:a.size})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"color-swatch",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Color"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:a.color})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"dollar",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Price"})]}),e.jsxs("p",{className:"text-gray-800 fs-6",children:["Rp ",Number(a.price).toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"dollar",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Cost Price"})]}),e.jsxs("p",{className:"text-gray-800 fs-6",children:["Rp ",Number(a.cost_price).toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"check-circle",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Status"})]}),e.jsx("span",{className:`badge ${a.is_active?"badge-light-success":"badge-light-danger"} fs-6`,children:a.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"user",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Created By"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:a.created_by})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"calendar",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Created Date"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:new Date(a.created_dt).toLocaleString()})]}),a.changed_by&&e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"user-edit",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Changed By"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:a.changed_by})]}),a.changed_dt&&e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(r,{iconName:"calendar-edit",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Changed Date"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:new Date(a.changed_dt).toLocaleString()})]})]})})}),a.materials&&e.jsxs("div",{className:"card border mt-5",children:[e.jsxs("div",{className:"card-header bg-light",children:[e.jsx("h6",{className:"card-title mb-0",children:"Materials"}),e.jsx("div",{className:"align-content-center",children:e.jsxs(A,{variant:"dark",className:"btn btn-sm",onClick:()=>t(`/master-product/product/${l}/add-materials`),children:[e.jsx(r,{iconName:"plus",className:"fs-3 me-1"}),"Tambah Material"]})})]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"row g-3",children:a.materials.map((x,j)=>e.jsx("div",{className:"col-12 col-md-6 col-lg-4",children:e.jsxs("div",{className:"border rounded p-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[e.jsx("h6",{className:"fw-bold mb-0",children:x.material_name}),e.jsx("button",{type:"button",className:"btn btn-sm btn-icon btn-text-secondary rounded-pill",onClick:()=>k(x.bom_id,x.material_name),disabled:d,children:e.jsx(r,{iconName:"trash",className:"fs-4 text-danger"})})]}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Category:"}),e.jsx("span",{className:"fw-semibold",children:x.material_category})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Qty per Unit:"}),e.jsxs("span",{className:"fw-semibold",children:[x.qty_per_unit," ",x.unit_of_measure]})]})]})]})},x.bom_id||j))})})]})]}),e.jsx(O,{show:m,title:"Delete Material",itemName:(u==null?void 0:u.material_name)||"",onConfirm:o,onClose:()=>c(!1)})]})},Me=[{title:"Master Data",path:"/master-product",isSeparator:!1,isActive:!1}],Be=()=>{const{id:l}=P(),t=C(),{useProductVariantById:n}=E(),{data:i,isLoading:d,error:h}=n(l),{addBomItem:a}=J(),{materials:p}=be(),{currentUser:y}=U();if(f.useEffect(()=>{!d&&!i&&t("/error/404")},[i,d,t]),d)return e.jsx("div",{className:"d-flex justify-content-center align-items-center h-lg-400px",children:"Loading..."});if(h||!i)return e.jsx("div",{children:"Error loading product variant"});const m=K().shape({materials:ce().of(K().shape({material_id:ne().required("Material is required"),qty_per_unit:re().required("Qty per unit is required").min(.01,"Must be greater than 0")})).min(1,"At least one material is required")});return e.jsxs("div",{className:"container-fluid",children:[e.jsx(q,{breadcrumbs:Me,children:"Add Materials"}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card shadow-sm",children:[e.jsx("div",{className:"card-header border-0 bg-light",children:e.jsx("div",{className:"w-100 d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center",children:e.jsxs("div",{className:"mb-3 mb-md-0",children:[e.jsx("h3",{className:"card-title mb-1",children:i.product_name}),e.jsxs("span",{className:"text-muted fs-7",children:["SKU: ",i.sku]})]})})}),e.jsx("div",{className:"card-body p-5",children:e.jsx(de,{initialValues:{materials:[{material_id:"",qty_per_unit:0}]},validationSchema:m,onSubmit:c=>{a({product_variant_id:l,materials:c.materials,user_id:y==null?void 0:y.full_name}),t(`/master-product/product/${l}`)},enableReinitialize:!0,children:c=>e.jsxs(_,{onSubmit:c.handleSubmit,id:"add-materials-form",onKeyDown:u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),c.handleSubmit())},children:[e.jsx(oe,{name:"materials",children:({push:u,remove:N})=>e.jsxs(e.Fragment,{children:[c.values.materials.map((k,o)=>e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"col-12 d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h6",{className:"mb-0"}),c.values.materials.length>1&&e.jsxs(A,{variant:"outline-danger",size:"sm",onClick:()=>N(o),children:[e.jsx(r,{iconName:"trash",className:"fs-4"}),"Remove"]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs(_.Group,{className:"mb-3",children:[e.jsxs(_.Label,{className:"fw-bold",children:["Material ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(R,{name:`materials.${o}.material_id`,children:({field:x})=>e.jsxs(_.Select,{...x,className:"form-control-solid",isInvalid:!!(c.errors.materials&&Array.isArray(c.errors.materials)&&c.errors.materials[o]&&c.errors.materials[o].material_id&&c.touched.materials&&Array.isArray(c.touched.materials)&&c.touched.materials[o]&&c.touched.materials[o].material_id),children:[e.jsx("option",{value:"",children:"Select Material"}),p.map(j=>e.jsx("option",{value:j.id,children:j.material_name},j.id))]})}),e.jsx(Q,{name:`materials.${o}.material_id`,component:"div",className:"invalid-feedback d-block"})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs(_.Group,{className:"mb-3",children:[e.jsxs(_.Label,{className:"fw-bold",children:["Qty per Unit ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(R,{name:`materials.${o}.qty_per_unit`,children:({field:x})=>e.jsx(_.Control,{...x,type:"number",step:"0.01",placeholder:"Enter quantity per unit",className:"form-control-solid",isInvalid:!!(c.errors.materials&&Array.isArray(c.errors.materials)&&c.errors.materials[o]&&c.errors.materials[o].qty_per_unit&&c.touched.materials&&Array.isArray(c.touched.materials)&&c.touched.materials[o]&&c.touched.materials[o].qty_per_unit)})}),e.jsx(Q,{name:`materials.${o}.qty_per_unit`,component:"div",className:"invalid-feedback d-block"})]})})]})]},o)),e.jsxs(A,{type:"button",variant:"outline-primary",onClick:()=>u({material_id:"",qty_per_unit:0}),className:"w-100 mb-4",children:[e.jsx(r,{iconName:"plus",className:"fs-3 me-2"}),"Add Another Material"]})]})}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsxs(A,{variant:"light",className:"btn-active-light-danger",onClick:()=>t(-1),children:[e.jsx(r,{iconName:"cross",className:"fs-2 me-2"}),"Cancel"]}),e.jsxs(A,{variant:"primary",type:"submit",children:[e.jsx(r,{iconName:"check",className:"fs-2 me-2"}),"Save Materials"]})]})]})})})]})})})]})},T=[{title:"Master Data",path:"/master-product",isSeparator:!1,isActive:!1}],Ye=()=>e.jsxs(me,{children:[e.jsx(S,{path:"/",element:e.jsx(we,{})}),e.jsx(S,{path:"product/:id",element:e.jsxs(e.Fragment,{children:[e.jsx(q,{breadcrumbs:T,children:"Product Detail"}),e.jsx(Ie,{})]})}),e.jsx(S,{path:"product/:id/add-materials",element:e.jsx(e.Fragment,{children:e.jsx(Be,{})})}),e.jsx(S,{path:"article/:id",element:e.jsxs(e.Fragment,{children:[e.jsx(q,{breadcrumbs:T,children:"Article Detail"}),e.jsx(Ae,{})]})})]});export{Ye as default};
