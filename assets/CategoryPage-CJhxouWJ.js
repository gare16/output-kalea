import{I as f,B as q,J as x,G as i,r as h,S as T,j as o,H as w,P as F}from"./index-ByLk8s-j.js";import{T as P}from"./TablesWidget13-CYdTlftt.js";import{D as Q}from"./DynamicEditModal-Bhzcpj13.js";import{D as $}from"./DynamicDeleteModal-C1L8R17p.js";import{D as G}from"./DynamicFormModal-BoHJvk0i.js";import{u as L,a as D}from"./useMutation-D8PU-YPJ.js";import{f as A}from"./dateFormatter-Bb4_azhc.js";import"./ThemeProvider-DRjQDZAD.js";import"./FormCheckInput-DWF_ryow.js";import"./Modal-DB3yoVLU.js";import"./hasClass-BOwTM1yB.js";import"./DataKey-jIVlRIQi.js";import"./Button-BI5PMaMy.js";import"./Form-BFxoF8LL.js";import"./warning-C3dqfjue.js";const B=async()=>(await f.get("/material-category?start=0&length=100")).data.data||[],H=async s=>(console.log("=== category service ==="),(await f.post("/material-category",s)).data.data),I=async(s,d)=>(await f.put(`/material-category/${s}`,d)).data.data,O=async s=>{await f.delete(`/material-category/${s}`)},z=()=>{const s=q(),d=L({queryKey:["categories"],queryFn:B}),u=D({mutationFn:H,onSuccess:e=>{console.log("Add category success:",e),s.invalidateQueries({queryKey:["categories"]}),i.success("Category added successfully")},onError:e=>{var r;const a=e instanceof x?(r=e.response)==null?void 0:r.data.message:`Gagal menambahkan vendor: ${e.message}`;Array.isArray(a)?a.forEach(n=>i.error(n)):i.error(a)}}),y=D({mutationFn:({id:e,category:a})=>I(e,a),onSuccess:e=>{console.log("Update category success:",e),s.invalidateQueries({queryKey:["categories"]}),i.success("Category updated successfully")},onError:e=>{var r;const a=e instanceof x?(r=e.response)==null?void 0:r.data.message:`Gagal mengubah vendor: ${e.message}`;Array.isArray(a)?a.forEach(n=>i.error(n)):i.error(a)}}),p=D({mutationFn:O,onSuccess:()=>{console.log("Delete category success"),s.invalidateQueries({queryKey:["categories"]}),i.success("Category deleted successfully")},onError:e=>{var r;const a=e instanceof x?(r=e.response)==null?void 0:r.data.message:`Gagal menghapus vendor: ${e.message}`;Array.isArray(a)?a.forEach(n=>i.error(n)):i.error(a)}});return{categories:d.data||[],isLoading:d.isLoading,error:d.error,addCategory:u.mutate,updateCategory:y.mutate,deleteCategory:p.mutate,isAdding:u.isPending,isUpdating:y.isPending,isDeleting:p.isPending}},J=[{title:"Dashboard",path:"/dashboard",isSeparator:!1,isActive:!1},{title:"Master Category",path:"/master-category",isSeparator:!0,isActive:!0}],de=()=>{const{categories:s,isLoading:d,addCategory:u,updateCategory:y,deleteCategory:p}=z(),[e,a]=h.useState(!1),[r,n]=h.useState(!1),[M,b]=h.useState(!1),[l,c]=h.useState(null),{currentUser:m}=T(),S=[{key:"name",label:"Nama",className:"min-w-150px"},{key:"created_by",label:"Dibuat Oleh",className:"min-w-120px"},{key:"created_dt",label:"Dibuat Tanggal",className:"min-w-140px"},{key:"changed_by",label:"Diubah Oleh",className:"min-w-120px"},{key:"changed_dt",label:"Diubah Tanggal",className:"min-w-140px"}],_=s.map(t=>({id:t.id,name:t.name,created_by:t.created_by,created_dt:A(t.created_dt),changed_by:t.changed_by||"-",changed_dt:t.changed_dt?A(t.changed_dt):"-"})),v=()=>{a(!0)},E=t=>{u({name:t.name,user_id:m==null?void 0:m.full_name}),a(!1)},N=t=>{const g=s.find(C=>C.id===t.id);g&&(c(g),n(!0))},k=t=>{l&&(y({id:l.id,category:{name:t.name,user_id:m==null?void 0:m.full_name}}),n(!1),c(null))},j=t=>{const g=s.find(C=>C.id===t.id);g&&(c(g),b(!0))},K=()=>{l&&(p(l.id),b(!1),c(null))};return d?o.jsx(w,{children:o.jsxs("div",{className:"card-body text-center py-10",children:[o.jsx("div",{className:"spinner-border text-primary",role:"status",children:o.jsx("span",{className:"visually-hidden",children:"Loading..."})}),o.jsx("div",{className:"mt-3",children:"Memuat data kategori..."})]})}):o.jsxs("div",{className:"container-fluid",children:[o.jsx(F,{breadcrumbs:J,children:"Master Category"}),o.jsx(w,{children:o.jsx(P,{className:"card-xl-stretch",rows:_,columns:S,labelAdd:"Add Category",filters:[{key:"name",label:"Filter by Name"}],onDelete:j,onEdit:N,onAdd:v})}),e&&o.jsx(G,{show:e,title:"Tambah Kategori",fields:[{name:"name",label:"Nama Kategori",type:"text",required:!0,icon:"tag",placeholder:"Masukkan nama kategori"}],onSubmit:E,onClose:()=>a(!1)}),l&&o.jsx(Q,{show:r,title:"Edit Kategori",fields:[{name:"name",label:"Nama Kategori",type:"text",required:!0,icon:"tag",placeholder:"Masukkan nama kategori"}],initialData:{name:l.name},onSave:k,onClose:()=>{n(!1),c(null)}}),l&&o.jsx($,{show:M,title:"Hapus Kategori",itemName:l.name,onConfirm:K,onClose:()=>{b(!1),c(null)}})]})};export{de as default};
