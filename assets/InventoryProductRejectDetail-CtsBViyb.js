import{U as S,Q as D,r as c,j as e,K as d,P as C,C as T}from"./index-ByLk8s-j.js";import{m as R}from"./mockData-BDmv_6uE.js";import{u as M,g as P}from"./index-Dy2nfz69.js";const A=[{title:"Inventory >",path:"/inventory",isSeparator:!1,isActive:!1},{title:"Reject Products >",path:"/inventory/reject-product",isSeparator:!1,isActive:!1}],L=()=>{const{id:p}=S(),o=D(),[t,N]=c.useState(null),[g,v]=c.useState(!0),[h,f]=c.useState([]),[m,b]=c.useState(""),[x,y]=c.useState(""),[n,w]=c.useState(""),j=c.useMemo(()=>[{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Tanggal"}),accessorKey:"date",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Nama Produk"}),accessorKey:"productName",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Deskripsi"}),accessorKey:"description",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Sumber"}),accessorKey:"source",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Stok Reject"}),accessorFn:a=>a.runningStock,id:"runningStock",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Jumlah Reject"}),accessorFn:a=>`${a.action==="Masuk"?"+":"-"}${a.quantity}`,id:"quantityChange",cell:a=>{const s=a.getValue(),r=s.startsWith("+");return e.jsx("span",{className:`fw-bold text-hover-primary d-block mb-1 fs-6 ${r?"text-success":"text-danger"}`,children:s})}},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Total Akhir Reject"}),accessorFn:a=>a.stockAfter,id:"stockAfter",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})}],[]),u=M({data:h,columns:j,getCoreRowModel:P()});return c.useEffect(()=>{const a=Math.floor(Math.random()*7)+1,s=R.find(r=>r.id===a.toString());s?N(s):o("/inventory/reject-product"),v(!1)},[p,o]),c.useEffect(()=>{if(t){let a=0;const s=[...t.history].sort((r,i)=>new Date(r.date).getTime()-new Date(i.date).getTime()).map(r=>{const i=a;r.action==="Masuk"?a+=r.quantity:r.action==="Keluar"&&(a-=r.quantity);const l=a;return{...r,productName:t.nama_produk,runningStock:i,stockAfter:l}});f(s)}},[t]),c.useEffect(()=>{if(!t)return;let a=[...t.history].sort((s,r)=>new Date(s.date).getTime()-new Date(r.date).getTime()).map(s=>{const r=t.history.slice().sort((l,k)=>new Date(l.date).getTime()-new Date(k.date).getTime()).slice(0,t.history.findIndex(l=>l.id===s.id)+1);let i=0;for(const l of r)l.action==="Masuk"?i+=l.quantity:l.action==="Keluar"&&(i-=l.quantity);return{...s,productName:t.nama_produk,runningStock:i-(s.action==="Masuk"?s.quantity:s.action==="Keluar"?-s.quantity:0),stockAfter:i}});m&&(a=a.filter(s=>new Date(s.date)>=new Date(m))),x&&(a=a.filter(s=>new Date(s.date)<=new Date(x))),n&&(a=a.filter(s=>s.productName.toLowerCase().includes(n.toLowerCase())||s.description.toLowerCase().includes(n.toLowerCase())||s.source.toLowerCase().includes(n.toLowerCase()))),f(a)},[m,x,n,t]),g?e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("div",{className:"mt-3",children:"Memuat detail Reject Product..."})]})}):t?e.jsxs(e.Fragment,{children:[e.jsx(C,{breadcrumbs:A,children:t.nama_produk}),e.jsxs(T,{children:[e.jsx("div",{className:"row g-5 g-xl-8",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body py-5",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Nama Produk"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.nama_produk})]})}),e.jsx("div",{className:"col-md-1",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"SKU"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.sku})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Artikel"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.artikel})]})}),e.jsx("div",{className:"col-md-3",children:e.jsx("div",{className:"d-flex flex-row h-100 justify-content-end",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>o(-1),children:[e.jsx(d,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Articles"]})})})]})})})})}),e.jsx("div",{className:"row g-5 g-xl-8 mt-5",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header border-0 pt-6",children:[e.jsx("div",{className:"d-flex flex-wrap gap-5",children:e.jsxs("div",{className:"card-title",children:[e.jsx(d,{iconName:"history",className:"fs-2 text-primary me-2"}),e.jsx("h3",{className:"mb-0",children:"Riwayat Transaksi Reject"})]})}),e.jsxs("div",{className:"card-toolbar",children:[e.jsxs("div",{className:"d-flex align-items-center position-relative me-4",children:[e.jsx("input",{type:"date",className:"form-control form-control-sm me-2",placeholder:"Start Date",value:m,onChange:a=>b(a.target.value)}),e.jsx("span",{className:"mx-1",children:"to"}),e.jsx("input",{type:"date",className:"form-control form-control-sm ms-2",placeholder:"End Date",value:x,onChange:a=>y(a.target.value)})]}),e.jsxs("div",{className:"d-flex align-items-center position-relative",children:[e.jsx(d,{iconName:"magnifier",className:"fs-3 position-absolute ms-3 text-gray-400"}),e.jsx("input",{type:"text",className:"form-control form-control-solid w-250px ps-10",placeholder:"Cari produk, deskripsi, atau sumber...",value:n,onChange:a=>w(a.target.value)})]})]})]}),e.jsx("div",{className:"card-body py-5",children:h.length===0?e.jsxs("div",{className:"text-center py-10",children:[e.jsx(d,{iconName:"information",className:"fs-1 text-muted mb-3"}),e.jsx("p",{className:"text-muted",children:"Tidak ada riwayat transaksi yang cocok"})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-7",children:[e.jsx("thead",{children:u.getHeaderGroups().map(a=>e.jsx("tr",{className:"fw-bold text-muted",children:a.headers.map(s=>e.jsx("th",{className:"min-w-150px",children:s.isPlaceholder?null:s.column.columnDef.header({})},s.id))},a.id))}),e.jsx("tbody",{className:"text-gray-600 fw-bold",children:u.getRowModel().rows.length>0?u.getRowModel().rows.map(a=>e.jsx("tr",{children:a.getVisibleCells().map(s=>e.jsx("td",{children:s.renderValue()},s.id))},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:j.length,children:e.jsx("div",{className:"d-flex text-center w-100 align-content-center justify-content-center",children:"No matching records found"})})})})]})})})]})})})]})]}):e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"alert alert-danger",role:"alert",children:"Item tidak ditemukan"}),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>o(-1),children:[e.jsx(d,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Articles"]})]})})};export{L as default};
