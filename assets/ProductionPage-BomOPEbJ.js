import{$ as K,Y as Ee,a0 as T,Z as w,j as e,a1 as Y,r as b,a2 as Z,_ as me,a3 as ue,K as O,C as U,a4 as G,g as ye,i as R,N as je,O as _e,k as J}from"./index-DtLKkDp-.js";import{l as ge,u as Re}from"./useSpkList-6Hj4TYAd.js";import{T as Ke}from"./TablesWidget13-CnK7FQ9o.js";import{D as Ne}from"./DynamicFormModal-iRfucUSA.js";import{D as Me}from"./DynamicDeleteModal-Cl6SalVY.js";import{u as L,a as B}from"./useMutation-Bl9g9XCm.js";import{u as be}from"./useVendors-PdmVW5aG.js";import{S as Q}from"./StatusBadge-AQp6eRYO.js";import{f as ke}from"./dateFormatter-Bb4_azhc.js";import{Q as he}from"./index-D5KClj2O.js";import"./ThemeProvider-Buy5OdM_.js";import"./Modal-DRjAcmKK.js";import"./hasClass-GO2TYndl.js";import"./Button-DOX5HBoW.js";import"./Form-BDPISyEC.js";import"./warning-DmKywM4p.js";const ze=async()=>(await K.get("/delivery-note/type")).data.data,Ue=async a=>{const i=await K.get("/delivery-note",{params:a});return{data:i.data.data,meta:i.data.meta}},Ge=async a=>(await K.get(`/delivery-note/${a}`)).data.data,Oe=async a=>{const h=a?`/delivery-note/generate-no/${encodeURIComponent((l=>l.replace(/^SURAT JALAN\s+/i,"").trim().replace(/\s+/g,"_").toUpperCase())(a))}`:"/delivery-note/generate-no";return(await K.get(h)).data.data.delivery_note_no},Qe=async a=>(await K.post("/delivery-note",a)).data.data,Te=async a=>(await K.put(`/delivery-note/${a.id}`,a)).data.data,Be=async a=>{await K.post("/delivery-note/approval",a)},Je=async a=>{await K.delete(`/delivery-note/${a}`)},D=a=>{var s,t;const i=Ee(),h=L({queryKey:["delivery-notes",a],queryFn:()=>Ue(a)}),u=B({mutationFn:c=>Qe(c),onSuccess:c=>{console.log("Add delivery note success:",c),i.invalidateQueries({queryKey:["delivery-notes"]}),w.success("Delivery note added successfully")},onError:c=>{var d;const r=c instanceof T?(d=c.response)==null?void 0:d.data.message:`Gagal Menambah Surat Jalan: ${c.message}`;Array.isArray(r)?r.forEach(o=>w.error(o)):w.error(r)}}),l=B({mutationFn:c=>Te(c),onSuccess:c=>{console.log("Update delivery note success:",c),i.invalidateQueries({queryKey:["delivery-notes",c.id]}),w.success("Delivery note updated successfully"),setTimeout(()=>{window.location.reload()},1500)},onError:c=>{var d;const r=c instanceof T?(d=c.response)==null?void 0:d.data.message:`Gagal Mengubah Surat Jalan: ${c.message}`;Array.isArray(r)?r.forEach(o=>w.error(o)):w.error(r)}}),n=B({mutationFn:c=>Be(c),onSuccess:()=>{console.log("Approve delivery note success"),i.invalidateQueries({queryKey:["delivery-notes"]}),w.success("Delivery note approved successfully")},onError:c=>{var d;const r=c instanceof T?(d=c.response)==null?void 0:d.data.message:`Gagal Approve: ${c.message}`;Array.isArray(r)?r.forEach(o=>w.error(o)):w.error(r)}}),m=B({mutationFn:c=>Je(c),onSuccess:()=>{console.log("Delete delivery note success"),i.invalidateQueries({queryKey:["delivery-notes"]}),w.success("Delivery note deleted successfully")},onError:c=>{var d;const r=c instanceof T?(d=c.response)==null?void 0:d.data.message:`Gagal Menghapus Surat Jalan: ${c.message}`;Array.isArray(r)?r.forEach(o=>w.error(o)):w.error(r)}});return{deliveryNotes:((s=h.data)==null?void 0:s.data)||[],meta:(t=h.data)==null?void 0:t.meta,isLoading:h.isLoading,error:h.error,addDeliveryNote:u.mutate,updateDeliveryNote:l.mutate,approveDeliveryNote:n.mutate,isAdding:u.isPending,isUpdating:l.isPending,isApproving:n.isPending,isDeleting:m.isPending,deleteDeliveryNote:m.mutate}},X=a=>{const i=L({queryKey:["delivery-note",a],queryFn:()=>Ge(a),enabled:!!a});return{deliveryNote:a?i.data:null,isLoading:i.isLoading,error:i.error}},ve=()=>{const a=L({queryKey:["delivery-note-types"],queryFn:ze});return{types:a.data||[],isLoading:a.isLoading,error:a.error}},fe=a=>{const i=L({queryKey:["generate-delivery-note-no",a],queryFn:()=>Oe(a),enabled:!!a});return{deliveryNoteNo:i.data,isLoading:i.isLoading,error:i.error,refetch:i.refetch}},Le=({deliveryNote:a,spk:i,spkDetails:h})=>{const u=(n,m)=>{const s=n.product_variants;switch(m){case"PERMINTAAN_KAIN":return{product:s.product_name,variant:`${s.color} - ${s.size}`,qtySpk:n.qty_order,namaMaterial:n.material.material_name,jumlahMaterial:n.qty_order,kurangMaterial:n.material_shortage};case"PENGIRIMAN_BARANG":return{product:s.product_name,variant:`${s.color} - ${s.size}`,qtySpk:n.qty_order,qtyDone:n.qty_done,qtyOut:n.qty_order,hpp:n.cost_price};case"BUANG_BENANG_KELUAR":return{product:s.product_name,variant:`${s.color} - ${s.size}`,qtyOrder:n.qty_order,qtyOut:n.qty_out};case"BUANG_BENANG_MASUK":return{product:s.product_name,variant:`${s.color} - ${s.size}`,qtySpk:n.qty_order,qtyOut:n.qty_out,qtyIn:n.qty_in,selisih:Number(n.qty_out)-Number(n.qty_in)};case"JAHIT_KELUAR":return{product:s.product_name,variant:`${s.color} - ${s.size}`,qtyOrder:n.qty_order,qtyOut:n.qty_out};case"JAHIT_MASUK":return{product:s.product_name,variant:`${s.color} - ${s.size}`,qtySpk:n.qty_order,qtyOut:n.qty_out,qtyIn:n.qty_out,selisih:Number(n.qty_out)-Number(n.qty_in)};default:return{product:s.product_name,variant:`${s.color} - ${s.size}`,qtyOrder:n.qty_order,qtyDone:n.qty_done,qtyReject:n.qty_reject}}},l=()=>{if(!h||h.length===0)return null;switch(a.delivery_note_type){case"PERMINTAAN_KAIN":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty SPK"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Nama Material"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Jumlah Material"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Kurang Material"})]})}),e.jsx("tbody",{children:h.map((n,m)=>{const s=u(n,"PERMINTAAN_KAIN");return e.jsxs("tr",{style:{backgroundColor:m%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtySpk}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.namaMaterial}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.jumlahMaterial}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.kurangMaterial})]},n.id??m)})})]});case"PENGIRIMAN_BARANG":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty SPK"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Done"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Out"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"HPP"})]})}),e.jsx("tbody",{children:h.map((n,m)=>{const s=u(n,"PENGIRIMAN_BARANG");return e.jsxs("tr",{style:{backgroundColor:m%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtySpk}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtyDone}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtyOut}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.hpp})]},n.id??m)})})]});case"BUANG_BENANG_KELUAR":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Order"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Out"})]})}),e.jsx("tbody",{children:h.map((n,m)=>{const s=u(n,"BUANG_BENANG_KELUAR");return e.jsxs("tr",{style:{backgroundColor:m%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtyOrder}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtyOut})]},n.id??m)})})]});case"BUANG_BENANG_MASUK":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty SPK"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Out"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty In"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Selisih"})]})}),e.jsx("tbody",{children:h.map((n,m)=>{const s=u(n,"BUANG_BENANG_MASUK");return e.jsxs("tr",{style:{backgroundColor:m%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtySpk}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtyOut}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtyIn}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.selisih})]},n.id??m)})})]});case"JAHIT_KELUAR":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Order"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Out"})]})}),e.jsx("tbody",{children:h.map((n,m)=>{const s=u(n,"JAHIT_KELUAR");return e.jsxs("tr",{style:{backgroundColor:m%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtyOrder}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtyOut})]},n.id??m)})})]});case"JAHIT_MASUK":return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Color"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Size"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty SPK"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Out"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty In"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Selisih"})]})}),e.jsx("tbody",{children:h.map((n,m)=>{const s=u(n,"JAHIT_MASUK");return e.jsxs("tr",{style:{backgroundColor:m%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:s.product}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.color}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.size}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtySpk}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtyOut}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.qtyIn}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:s.selisih})]},n.id??m)})})]});default:return e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Product"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Variant"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Order"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Done"}),e.jsx("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:"Qty Reject"})]})}),e.jsx("tbody",{children:h.map((n,m)=>e.jsxs("tr",{style:{backgroundColor:m%2===0?"#fff":"#f9f9f9"},children:[e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px"},children:n.product_variants.product_name}),e.jsxs("td",{style:{border:"1px solid #ccc",padding:"8px"},children:[n.product_variants.color," - ",n.product_variants.size]}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:n.qty_order}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:n.qty_done}),e.jsx("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"center"},children:n.qty_reject})]},n.id??m))})]})}};return e.jsxs("div",{style:{fontFamily:"Arial, sans-serif",maxWidth:"210mm",margin:"0 auto",padding:"16mm",backgroundColor:"#fff",color:"#000",lineHeight:"1.4",fontSize:"12px"},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:"20px"},children:"Surat Jalan"}),e.jsx("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"24px",fontSize:"12px"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold",width:"160px"},children:"Delivery Note No"}),e.jsx("td",{style:{padding:"6px 8px"},children:a.delivery_note_no})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"Delivery Date"}),e.jsx("td",{style:{padding:"6px 8px"},children:a.delivery_note_date?ke(a.delivery_note_date):"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"Type"}),e.jsx("td",{style:{padding:"6px 8px"},children:a.delivery_note_type||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"Vendor"}),e.jsx("td",{style:{padding:"6px 8px"},children:a.vendor.name})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"Destination"}),e.jsx("td",{style:{padding:"6px 8px"},children:a.destination})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"No SPK"}),e.jsx("td",{style:{padding:"6px 8px"},children:(i==null?void 0:i.map(n=>n.spk_no).join(", "))||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold"},children:"Notes"}),e.jsx("td",{style:{padding:"6px 8px"},children:a.notes||"-"})]})]})}),h&&h.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{style:{marginBottom:"10px"},children:"Product Variants"}),l()]})]})},De=()=>{const a=Y(),[i,h]=b.useState(!1),[u,l]=b.useState(!1),[n,m]=b.useState(null),[s,t]=b.useState(null),c=b.useRef(null),[r,d]=b.useState(""),{deliveryNotes:o,addDeliveryNote:x,deleteDeliveryNote:N}=D(),{deliveryNote:y,isLoading:f}=X(s),{types:q}=ve(),{vendors:I}=be(),{deliveryNoteNo:p,refetch:v}=fe(r),M=[{key:"noSJ",label:"No. SJ",className:"min-w-120px"},{key:"tanggal",label:"Tanggal",className:"min-w-100px"},{key:"jenis",label:"Jenis",className:"min-w-100px"},{key:"vendor",label:"Vendor",className:"min-w-125px"},{key:"tujuan",label:"Tujuan",className:"min-w-125px"},{key:"status",label:"Status",className:"min-w-100px"},{key:"createdBy",label:"Created By",className:"min-w-125px"}],$=o.map(g=>({id:g.id,noSJ:g.delivery_note_no,tanggal:g.delivery_note_date,jenis:g.delivery_note_type,vendor:g.vendor.name,tujuan:g.destination,status:e.jsx(Q,{status:g.status.toLowerCase()}),createdBy:"System"})),P=g=>{m(g),h(!0)},A=()=>{N(n==null?void 0:n.id),h(!1)},k=g=>{a(`/production/edit-surat-jalan/${g.id}`)},H=g=>{const E=g.id;t(E)},z=ge.useReactToPrint({contentRef:c,documentTitle:y?`SuratJalan-${y.delivery_note_no}`:"SuratJalan-Detail",pageStyle:`
      @page {
        size: A4;
        margin: 20mm;
      }
      body {
        -webkit-print-color-adjust: exact !important;
        color-adjust: exact !important;
      }
    `});b.useEffect(()=>{y&&!f&&s&&(z(),t(null))},[y,f,z,s]);const _=()=>{a("/production/add-surat-jalan")},j=g=>{d(g),v()},C=g=>{const E={delivery_note_no:p||g.noSJ,delivery_note_date:g.tanggal,delivery_note_type:g.jenis,vendor_id:g.vendor,destination:g.tujuan,status:g.status,notes:g.notes||"",user_id:"system",details:[]};x(E),l(!1),d("")};return e.jsxs("div",{children:[y&&e.jsx("div",{ref:c,className:"spk-print-content",style:{position:"absolute",left:"-9999px",top:"-9999px"},children:e.jsx(Le,{deliveryNote:y,spk:y.spk||[],spkDetails:y.spk_details||[]})}),e.jsx(Ke,{className:"card-xl-stretch",rows:$,columns:M,labelAdd:"Add Surat Jalan",filters:[{key:"jenis",label:"Filter by Jenis"},{key:"vendor",label:"Filter by Vendor"},{key:"status",label:"Filter by Status"}],onDelete:P,onEdit:k,onAdd:_,onPrint:H,onRowClick:g=>a(`/production/delivery-note-detail/detail/${g.id}`),roleAccess:{add:["ADMIN","OWNER","ADMIN PRODUKSI"],edit:["ADMIN","OWNER","ADMIN PRODUKSI"],print:["ADMIN","OWNER","ADMIN PRODUKSI","WAREHOUSE"]}}),i&&n&&e.jsx(Me,{show:i,title:"Delete Surat Jalan",itemName:n.noSJ,onConfirm:A,onClose:()=>{h(!1),m(null)}}),u&&e.jsx(Ne,{show:u,title:"Add Surat Jalan",fields:[{name:"jenis",label:"Jenis",type:"select",required:!0,options:q.map(g=>({value:g.id,label:g.name})),icon:"cog",onChange:j},{name:"noSJ",label:"No. SJ",type:"text",required:!0,icon:"document"},{name:"tanggal",label:"Tanggal",type:"date",required:!0,icon:"calendar"},{name:"vendor",label:"Vendor",type:"select",required:!0,options:I.map(g=>({value:g.id,label:g.name})),icon:"user"},{name:"tujuan",label:"Tujuan",type:"text",required:!0,icon:"map"},{name:"status",label:"Status",type:"select",required:!0,options:[{value:"PENDING",label:"Pending"},{value:"DONE",label:"Done"}],icon:"check-circle"},{name:"notes",label:"Notes",type:"textarea",required:!1,icon:"comment"}],onSubmit:C,onClose:()=>l(!1)})]})},$e={delivery_note_no:"",delivery_note_date:"",delivery_note_type:"PERMINTAAN_KAIN",vendor_id:"",destination:"",status:"PENDING",notes:"",user_id:"system"},Ae=(a,i)=>{const h=(i==null?void 0:i.autoGenerateNo)??!0,u=(i==null?void 0:i.autoSetDate)??!0,l=b.useMemo(()=>({...$e,...a}),[a]),[n,m]=b.useState(l);b.useEffect(()=>{m(r=>({...r,...l}))},[l]);const{deliveryNoteNo:s,refetch:t}=fe(h?n.delivery_note_type:void 0);return b.useEffect(()=>{h&&n.delivery_note_type&&t()},[h,n.delivery_note_type,t]),b.useEffect(()=>{h&&s&&m(r=>({...r,delivery_note_no:s}))},[h,s]),b.useEffect(()=>{if(!u||a!=null&&a.delivery_note_date)return;const r=new Date().toISOString().split("T")[0];m(d=>({...d,delivery_note_date:r}))},[u,a==null?void 0:a.delivery_note_date]),{formData:n,updateFormData:r=>{m(d=>({...d,...r}))}}},qe=()=>{const{data:a}=Re(),[i,h]=b.useState([]),[u,l]=b.useState({});b.useEffect(()=>{i.forEach(s=>{u[s]||(async()=>{try{const c=await K.get(`/spk/${s}`);c.data.success&&l(r=>({...r,[s]:c.data.data.details}))}catch(c){console.error("Error fetching SPK detail:",c)}})()})},[i,u]);const n=s=>{h(t=>t.includes(s)?t.filter(c=>c!==s):[...t,s])},m=b.useCallback(s=>{h(t=>t.length===s.length&&t.every(r=>s.includes(r))?t:s)},[]);return{spkList:a,selectedSpks:i,spkDetails:u,toggleSpkSelection:n,setSelectedSpks:m}},S={PERMINTAAN_KAIN:"PERMINTAAN_KAIN",BUANG_BENANG_KELUAR:"BUANG_BENANG_KELUAR",JAHIT_KELUAR:"JAHIT_KELUAR",BUANG_BENANG_MASUK:"BUANG_BENANG_MASUK",JAHIT_MASUK:"JAHIT_MASUK",PENGIRIMAN_BARANG:"PENGIRIMAN_BARANG"},pe=(a,i,h)=>{const u=Array.isArray(a)?a:[];if(h===S.PERMINTAAN_KAIN){const l=Array.isArray(i.req_material)?i.req_material:[],n=l.find(s=>/kain/i.test(s.material_name))||l[0];if(n)return{material_id:n.material_id,material_name:n.material_name,material_qty:n.qty_required};const m=u.find(s=>/kain/i.test(s.material_name));if(m)return{material_id:m.material_id,material_name:m.material_name,material_qty:m.qty_per_unit*i.qty_order}}return{material_id:"",material_name:"",material_qty:0}},Se=a=>{const[i,h]=b.useState([]),u=(s,t,c)=>{if(c){const{material_id:r,material_name:d,material_qty:o}=pe(s.bom,s,a),x={spk_detail_id:s.id,item_type:"PRODUCT",product_variant_id:(s==null?void 0:s.id)??"",material_id:r||null,qty_out:s.qty_order,qty_in:0,labor_cost:0,spk_no:t.noSpk,product_name:s.product_name,color:s.color,size:s.size,qty_order:s.qty_order,material_name:d,material_qty:o,short_material:0,qty_done:0,hpp:0,selisih:0,req_material:s.req_material};h(N=>[...N,x])}else h(r=>r.filter(d=>d.spk_detail_id!==s.id))},l=(s,t,c,r)=>{if(t){const d=r.map(o=>{const{material_id:x,material_name:N,material_qty:y}=pe(o.bom,o,a);return{spk_detail_id:o.id,item_type:"PRODUCT",product_variant_id:(o==null?void 0:o.id)??"",material_id:x||null,qty_out:o.qty_order,qty_in:0,labor_cost:0,spk_no:c.noSpk,product_name:o.product_name,color:o.color,size:o.size,qty_order:o.qty_order,material_name:N,material_qty:y,short_material:0,qty_done:0,hpp:0,selisih:0,req_material:o.req_material}});h(o=>[...o.filter(x=>!r.some(N=>N.id===x.spk_detail_id)),...d])}else h(d=>d.filter(o=>!r.some(x=>x.id===o.spk_detail_id)))},n=(s,t,c)=>{h(r=>r.map(d=>d.spk_detail_id===s?{...d,[t]:c}:d))},m=b.useCallback(s=>{h(s)},[]);return{selectedDetails:i,handleDetailSelect:u,handleSelectAllDetails:l,updateDetail:n,setSelectedDetails:m}},we=({formData:a,updateFormData:i})=>{const{types:h}=ve(),{vendors:u}=be();return e.jsxs("div",{children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Delivery Note No *"}),e.jsx("input",{type:"text",className:"form-control",value:a.delivery_note_no,onChange:l=>i({delivery_note_no:l.target.value}),disabled:!0})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Delivery Date *"}),e.jsx("input",{type:"date",className:"form-control",value:a.delivery_note_date,onChange:l=>i({delivery_note_date:l.target.value})})]})})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Type *"}),e.jsx("select",{className:"form-select",value:a.delivery_note_type,onChange:l=>i({delivery_note_type:l.target.value}),children:h.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Vendor *"}),e.jsxs("select",{className:"form-select",value:a.vendor_id,onChange:l=>i({vendor_id:l.target.value}),children:[e.jsx("option",{value:"",children:"Select Vendor"}),u.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]})})]}),e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Destination *"}),e.jsx("input",{type:"text",className:"form-control",value:a.destination,onChange:l=>i({destination:l.target.value})})]})})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{className:"form-control",rows:3,value:a.notes,onChange:l=>i({notes:l.target.value})})]})]})},Pe=({spkList:a,selectedSpks:i,toggleSpkSelection:h})=>{const[u,l]=b.useState(""),[n,m]=b.useState(1),s=3,t=(a==null?void 0:a.filter(d=>d.status==="approved"&&(u===""||d.noSpk.toLowerCase().includes(u.toLowerCase())||d.buyer.toLowerCase().includes(u.toLowerCase()))))||[],c=t.slice((n-1)*s,n*s),r=Math.ceil(t.length/s);return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label",children:"Select SPKs *"}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-md-6",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search SPK by number or buyer...",value:u,onChange:d=>l(d.target.value),onKeyDown:d=>{d.key==="Enter"&&m(1)}})})}),e.jsx("div",{className:"row",children:c.map(d=>e.jsx("div",{className:"col-md-6 col-lg-4 mb-3",children:e.jsx("div",{className:`card h-100 ${i.includes(d.id)?"border-primary":"border-light"}`,children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:`spk-${d.id}`,checked:i.includes(d.id),disabled:d.status!=="approved",onChange:()=>h(d.id)}),e.jsx("label",{className:"form-check-label w-100",htmlFor:`spk-${d.id}`,children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("strong",{className:"text-primary",children:d.noSpk}),e.jsx("small",{className:"text-muted",children:d.buyer}),e.jsx("span",{className:`badge ${d.status==="approved"?"bg-success":d.status==="in_progress"?"bg-warning":"bg-secondary"} mt-1 align-self-start`,children:d.status.replace("_"," ").toUpperCase()})]})})]})})})},d.id))}),r>1&&e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("nav",{children:e.jsxs("ul",{className:"pagination",children:[e.jsx("li",{className:`page-item ${n===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>m(d=>Math.max(1,d-1)),disabled:n===1,children:"Previous"})}),Array.from({length:r},(d,o)=>o+1).map(d=>e.jsx("li",{className:`page-item ${n===d?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>m(d),children:d})},d)),e.jsx("li",{className:`page-item ${n===r?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>m(d=>Math.min(r,d+1)),disabled:n===r,children:"Next"})})]})})}),i.length>0&&e.jsx("div",{className:"mt-3",children:e.jsxs("small",{className:"text-muted",children:["Selected ",i.length," SPK",i.length>1?"s":""]})})]})},Ce=({selectedSpks:a,spkList:i,spkDetails:h,selectedDetails:u,deliveryNoteType:l,handleDetailSelect:n,handleSelectAllDetails:m,updateDetail:s})=>{if(a.length===0)return null;const t=()=>{const r=[e.jsx("th",{},"checkbox"),e.jsx("th",{children:"Product"},"product"),e.jsx("th",{children:"Color"},"color"),e.jsx("th",{children:"Size"},"size")];return l===S.PERMINTAAN_KAIN?r.push(e.jsx("th",{children:"Qty SPK"},"qty_spk"),e.jsx("th",{children:"Nama Material"},"material_name"),e.jsx("th",{children:"Jumlah Material"},"material_qty"),e.jsx("th",{children:"Kurang Material"},"short_material")):l===S.BUANG_BENANG_KELUAR||l===S.JAHIT_KELUAR?r.push(e.jsx("th",{children:"Qty Order"},"qty_order"),e.jsx("th",{children:"Qty Out"},"qty_out")):l===S.BUANG_BENANG_MASUK||l===S.JAHIT_MASUK?r.push(e.jsx("th",{children:"Qty SPK"},"qty_spk"),e.jsx("th",{children:"Qty Out"},"qty_out"),e.jsx("th",{children:"Qty In"},"qty_in"),e.jsx("th",{children:"Selisih"},"selisih")):l===S.PENGIRIMAN_BARANG?r.push(e.jsx("th",{children:"Qty SPK"},"qty_spk"),e.jsx("th",{children:"Qty Done"},"qty_done"),e.jsx("th",{children:"Qty Out"},"qty_out"),e.jsx("th",{children:"HPP"},"hpp")):r.push(e.jsx("th",{children:"Qty Order"},"qty_order"),e.jsx("th",{children:"Qty"},"qty_out")),r},c=(r,d)=>{var y,f,q,I;const o=u.some(p=>p.spk_detail_id===r.id),x=u.find(p=>p.spk_detail_id===r.id),N=[e.jsx("td",{onClick:p=>p.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:o,onClick:p=>p.stopPropagation(),onChange:p=>n(r,d,p.target.checked)})},"checkbox"),e.jsx("td",{children:r.product_name},"product"),e.jsx("td",{children:r.color},"color"),e.jsx("td",{children:r.size},"size")];return l===S.PERMINTAAN_KAIN?N.push(e.jsx("td",{children:r.qty_order},"qty_spk"),e.jsx("td",{onClick:p=>p.stopPropagation(),children:o&&e.jsx("input",{type:"text",className:"form-control",value:((f=(y=x==null?void 0:x.req_material)==null?void 0:y[0])==null?void 0:f.material_name)??(x==null?void 0:x.material_name)??"",readOnly:!0})},"material_name"),e.jsx("td",{onClick:p=>p.stopPropagation(),children:o&&e.jsx("input",{type:"number",className:"form-control",value:((I=(q=x==null?void 0:x.req_material)==null?void 0:q[0])==null?void 0:I.qty_required)??(x==null?void 0:x.material_qty)??"",readOnly:!0})},"material_qty"),e.jsx("td",{onClick:p=>p.stopPropagation(),children:o&&e.jsx("input",{type:"number",className:"form-control",value:(x==null?void 0:x.short_material)||"",onChange:p=>s(r.id,"short_material",p.target.value===""?0:parseInt(p.target.value)||0),min:0})},"short_material")):l===S.BUANG_BENANG_KELUAR||l===S.JAHIT_KELUAR?N.push(e.jsx("td",{children:r.qty_order},"qty_order"),e.jsx("td",{onClick:p=>p.stopPropagation(),children:o&&e.jsx("input",{type:"number",className:"form-control",value:(x==null?void 0:x.qty_out)||"",onChange:p=>s(r.id,"qty_out",p.target.value===""?0:parseInt(p.target.value)||0),max:r.qty_order,min:0})},"qty_out")):l===S.BUANG_BENANG_MASUK||l===S.JAHIT_MASUK?N.push(e.jsx("td",{children:r.qty_order},"qty_spk"),e.jsx("td",{onClick:p=>p.stopPropagation(),children:o&&e.jsx("input",{type:"number",className:"form-control",value:(x==null?void 0:x.qty_out)||"",onChange:p=>s(r.id,"qty_out",p.target.value===""?0:parseInt(p.target.value)||0),min:0})},"qty_out"),e.jsx("td",{onClick:p=>p.stopPropagation(),children:o&&e.jsx("input",{type:"number",className:"form-control",value:(x==null?void 0:x.qty_in)||"",onChange:p=>s(r.id,"qty_in",p.target.value===""?0:parseInt(p.target.value)||0),min:0})},"qty_in"),e.jsx("td",{onClick:p=>p.stopPropagation(),children:o&&e.jsx("input",{type:"number",className:"form-control",value:(x==null?void 0:x.selisih)||"",onChange:p=>s(r.id,"selisih",p.target.value===""?0:parseInt(p.target.value)||0),min:0})},"selisih")):l===S.PENGIRIMAN_BARANG?N.push(e.jsx("td",{children:r.qty_order},"qty_spk"),e.jsx("td",{onClick:p=>p.stopPropagation(),children:o&&e.jsx("input",{type:"number",className:"form-control",value:(x==null?void 0:x.qty_done)||"",onChange:p=>s(r.id,"qty_done",p.target.value===""?0:parseInt(p.target.value)||0),min:0})},"qty_done"),e.jsx("td",{onClick:p=>p.stopPropagation(),children:o&&e.jsx("input",{type:"number",className:"form-control",value:(x==null?void 0:x.qty_out)||"",onChange:p=>s(r.id,"qty_out",p.target.value===""?0:parseInt(p.target.value)||0),min:0})},"qty_out"),e.jsx("td",{onClick:p=>p.stopPropagation(),children:o&&e.jsx("input",{type:"number",className:"form-control",value:(x==null?void 0:x.hpp)||"",onChange:p=>s(r.id,"hpp",p.target.value===""?0:parseFloat(p.target.value)||0),min:0,step:"0.01"})},"hpp")):N.push(e.jsx("td",{children:r.qty_order},"qty_order"),e.jsx("td",{onClick:p=>p.stopPropagation(),children:o&&e.jsx("input",{type:"number",className:"form-control",value:(x==null?void 0:x.qty_out)||"",onChange:p=>s(r.id,"qty_out",p.target.value===""?0:parseInt(p.target.value)||0),max:r.qty_order,min:0})},"qty_out")),N};return e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{children:"Select SPK Details"}),a.map(r=>{const d=i==null?void 0:i.find(y=>y.id===r),o=h[r]||[],x=o.length>0&&o.every(y=>u.some(f=>f.spk_detail_id===y.id)),N=o.some(y=>u.some(f=>f.spk_detail_id===y.id));return e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{children:[d==null?void 0:d.noSpk," - ",d==null?void 0:d.buyer]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:x,ref:y=>{y&&(y.indeterminate=N&&!x)},onChange:y=>m(r,y.target.checked,d,o)})}),t().slice(1)]})}),e.jsx("tbody",{children:o.map(y=>{const f=u.some(q=>q.spk_detail_id===y.id);return e.jsx("tr",{className:`cursor-pointer ${f?"table-active":""}`,onClick:()=>n(y,d,!f),children:c(y,d)},y.id)})})]})})]},r)})]})},He=()=>{const a=Y(),{addDeliveryNote:i}=D(),{currentUser:h}=Z(),{formData:u,updateFormData:l}=Ae(),{spkList:n,selectedSpks:m,spkDetails:s,toggleSpkSelection:t}=qe(),{selectedDetails:c,handleDetailSelect:r,handleSelectAllDetails:d,updateDetail:o}=Se(u.delivery_note_type),x=()=>{if(!u.delivery_note_no||!u.delivery_note_date||!u.vendor_id||!u.destination){alert("Please fill all required fields");return}if(c.length===0){alert("Please select at least one SPK detail");return}if(h){const N={...u,user_id:h==null?void 0:h.full_name,details:c.map(y=>({spk_detail_id:y.spk_detail_id,item_type:y.item_type,product_variant_id:y.product_variant_id,material_id:y.material_id,qty_out:y.qty_out,qty_in:y.qty_in,labor_cost:y.labor_cost,material_name:y.material_name,material_qty:y.material_qty,short_material:y.short_material,qty_done:y.qty_done,hpp:y.hpp,selisih:y.selisih}))};console.log(N),i(N),a("/production/surat-jalan")}};return e.jsx("div",{className:"container-fluid",children:e.jsxs(me,{children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Add Surat Jalan"})}),e.jsxs("div",{className:"card-body",children:[e.jsx(we,{formData:u,updateFormData:l}),e.jsx(Pe,{spkList:n,selectedSpks:m,toggleSpkSelection:t}),e.jsx(Ce,{selectedSpks:m,spkList:n,spkDetails:s,selectedDetails:c,deliveryNoteType:u.delivery_note_type,handleDetailSelect:r,handleSelectAllDetails:d,updateDetail:o}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-primary",onClick:x,children:"Save Surat Jalan"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>a("/production/surat-jalan"),children:"Cancel"})]})]})]})})},Fe=()=>{const a=Y(),{id:i}=ue(),{currentUser:h}=Z(),{updateDeliveryNote:u}=D(),{deliveryNote:l,isLoading:n,error:m}=X(i||""),s=b.useRef(!1),t=b.useRef(!1),c=b.useMemo(()=>{var P;if(l)return{delivery_note_no:l.delivery_note_no,delivery_note_date:l.delivery_note_date,delivery_note_type:l.delivery_note_type,vendor_id:l.vendor_id||((P=l.vendor)==null?void 0:P.id)||"",destination:l.destination,status:l.status,notes:l.notes||"",user_id:(h==null?void 0:h.full_name)||"system"}},[l,h==null?void 0:h.full_name]),{formData:r,updateFormData:d}=Ae(c,{autoGenerateNo:!1,autoSetDate:!1}),{spkList:o,selectedSpks:x,spkDetails:N,toggleSpkSelection:y,setSelectedSpks:f}=qe(),{selectedDetails:q,handleDetailSelect:I,handleSelectAllDetails:p,updateDetail:v,setSelectedDetails:M}=Se(r.delivery_note_type);b.useEffect(()=>{if(!(l!=null&&l.spk)||l.spk.length===0||s.current)return;const P=l.spk.map(A=>A.id).filter(Boolean);P.length>0&&(s.current=!0,f(P))},[l,f]),b.useEffect(()=>{var z;if(!((z=l==null?void 0:l.details)!=null&&z.length)||!x.length)return;const P=x.every(_=>N[_]);if(t.current&&!P)return;const k=new Map;if(l.spk_details&&l.spk_details.forEach(_=>{var C,g,E;const j={id:_.id,product_variants:_.product_variants,product_name:((C=_.product_variants)==null?void 0:C.product_name)||"",size:((g=_.product_variants)==null?void 0:g.size)||"",color:((E=_.product_variants)==null?void 0:E.color)||"",qty_order:_.qty_order,qty_done:_.qty_done,qty_reject:_.qty_reject,qty_shipped:0,progress:_.progress||"",status:_.status||"",cost_price:_.cost_price,bom:[],stages:[],req_material:[]};k.set(_.id,j)}),x.forEach(_=>{N[_]&&N[_].forEach(j=>{k.set(j.id,j)})}),k.size===0)return;const H=l.details.map(_=>{var g,E,ee,te,se,re,ne,ae,de,le,ie;const j=k.get(_.spk_detail_id);let C=(g=l.spk)==null?void 0:g.find(ce=>{var oe;return N[ce.id]&&N[ce.id].map(Ie=>Ie.id).includes(_.spk_detail_id)?!0:((oe=l.spk_details)==null?void 0:oe.some(xe=>xe.id===_.spk_detail_id))||!1});return!C&&l.spk&&l.spk.length>0&&(C=l.spk[0]),{spk_detail_id:_.spk_detail_id,item_type:_.item_type,product_variant_id:_.product_variant_id||((E=j==null?void 0:j.product_variants)==null?void 0:E.id)||"",material_id:_.material_id,qty_out:_.qty_out,qty_in:_.qty_in,labor_cost:_.labor_cost,spk_no:(C==null?void 0:C.spk_no)||((te=(ee=l.spk)==null?void 0:ee[0])==null?void 0:te.spk_no)||"",product_name:(j==null?void 0:j.product_name)||((se=j==null?void 0:j.product_variants)==null?void 0:se.product_name)||"",color:(j==null?void 0:j.color)||((re=j==null?void 0:j.product_variants)==null?void 0:re.color)||"",size:(j==null?void 0:j.size)||((ne=j==null?void 0:j.product_variants)==null?void 0:ne.size)||"",qty_order:(j==null?void 0:j.qty_order)||0,material_name:_.material_name||((de=(ae=j==null?void 0:j.req_material)==null?void 0:ae[0])==null?void 0:de.material_name)||"",material_qty:_.material_qty||((ie=(le=j==null?void 0:j.req_material)==null?void 0:le[0])==null?void 0:ie.qty_required)||0,short_material:_.short_material||0,qty_done:_.qty_done||(j==null?void 0:j.qty_done)||0,hpp:_.hpp||0,selisih:_.selisih||0,req_material:(j==null?void 0:j.req_material)||[]}});M(H),Object.keys(N).length>0&&x.every(_=>N[_])&&(t.current=!0)},[l,x,N,M]);const $=()=>{if(!i){alert("Delivery note ID tidak ditemukan");return}if(!r.delivery_note_no||!r.delivery_note_date||!r.vendor_id||!r.destination){alert("Please fill all required fields");return}if(q.length===0){alert("Please select at least one SPK detail");return}const P={...r,id:i,user_id:(h==null?void 0:h.full_name)||r.user_id,details:q.map(A=>({spk_detail_id:A.spk_detail_id,item_type:A.item_type,product_variant_id:A.product_variant_id,material_id:A.material_id,qty_out:A.qty_out,qty_in:A.qty_in,labor_cost:A.labor_cost,material_name:A.material_name,material_qty:A.material_qty,short_material:A.short_material,qty_done:A.qty_done,hpp:A.hpp,selisih:A.selisih}))};u(P),a("/production/surat-jalan")};return n?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):m||!l?e.jsx("div",{className:"alert alert-danger",children:m?m.message:"Delivery note tidak ditemukan"}):e.jsx("div",{className:"container-fluid",children:e.jsx(me,{children:e.jsxs("div",{className:"card-body",children:[e.jsx(we,{formData:r,updateFormData:d}),e.jsx(Pe,{spkList:o,selectedSpks:x,toggleSpkSelection:y}),e.jsx(Ce,{selectedSpks:x,spkList:o,spkDetails:N,selectedDetails:q,deliveryNoteType:r.delivery_note_type,handleDetailSelect:I,handleSelectAllDetails:p,updateDetail:v}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-primary",onClick:$,children:"Update Surat Jalan"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>a("/production/surat-jalan"),children:"Cancel"})]})]})})})},Ve=({detail:a})=>e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#fff",padding:"20px"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h2",{style:{fontSize:"24px",fontWeight:"bold"},children:"No SPK : ...."}),e.jsx(he,{value:a.barcode,size:150}),e.jsx("h2",{style:{marginTop:"20px",fontSize:"24px",fontWeight:"bold"},children:a.product_variants.sku}),e.jsx(he,{value:a.product_variants.barcode,size:150})]})}),W=a=>a==null?"-":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),We=({type:a,spkDetails:i})=>{const[h,u]=b.useState(null),l=b.useRef(null),n=ge.useReactToPrint({contentRef:l,documentTitle:"Barcode",pageStyle:`
        @page {
          size: A4;
          margin: 20mm;
        }
        body {
          -webkit-print-color-adjust: exact !important;
          color-adjust: exact !important;
        }
      `}),m=t=>{u(t),setTimeout(()=>{n()},100)};let s;switch(a){case"PERMINTAAN_KAIN":s=e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-100px",children:"Material Name"}),e.jsx("th",{className:"min-w-100px",children:"Material Qty"}),e.jsx("th",{className:"min-w-80px",children:"SPK Qty"}),e.jsx("th",{className:"min-w-80px",children:"Kurang Material"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:i.map(t=>{var c,r,d,o,x;return e.jsxs("tr",{children:[e.jsx("td",{children:((c=t.product_variants)==null?void 0:c.product_name)||"-"}),e.jsx("td",{children:((r=t.product_variants)==null?void 0:r.sku)||"-"}),e.jsx("td",{children:((d=t.product_variants)==null?void 0:d.size)||"-"}),e.jsx("td",{children:((o=t.product_variants)==null?void 0:o.color)||"-"}),e.jsx("td",{children:((x=t.material)==null?void 0:x.material_name)??"-"}),e.jsx("td",{children:t.material_qty}),e.jsx("td",{children:t.qty_order??"-"}),e.jsx("td",{children:t.material_shortage})]},t.id)})})]});break;case"PENGIRIMAN_BARANG":s=e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"SPK Qty"}),e.jsx("th",{className:"min-w-80px",children:"Qty Done"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"}),e.jsx("th",{className:"min-w-100px",children:"HPP"}),e.jsx("th",{className:"min-w-120px",children:"Reject"}),e.jsx("th",{className:"min-w-120px",children:"Aksi"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:i.map(t=>{var c,r,d,o,x;return e.jsxs("tr",{children:[e.jsx("td",{children:((c=t.product_variants)==null?void 0:c.product_name)||"-"}),e.jsx("td",{children:((r=t.product_variants)==null?void 0:r.sku)||"-"}),e.jsx("td",{children:((d=t.product_variants)==null?void 0:d.size)||"-"}),e.jsx("td",{children:((o=t.product_variants)==null?void 0:o.color)||"-"}),e.jsx("td",{children:t.qty_order??"-"}),e.jsx("td",{children:t.qty_done??"-"}),e.jsx("td",{children:t.qty_out??"-"}),e.jsx("td",{children:((x=t.product_variants)==null?void 0:x.cost_price)!=null?W(t.cost_price):"-"}),e.jsx("td",{children:t.qty_reject}),e.jsx("td",{children:e.jsx("a",{href:"#",className:"btn btn-icon btn-bg-light btn-active-color-primary btn-sm me-1",onClick:N=>{N.stopPropagation(),m(t)},children:e.jsx(O,{iconName:"printer",className:"fs-3"})})})]},t.id)})})]});break;case"BUANG_BENANG_KELUAR":s=e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"Qty Order"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:i.map(t=>{var c,r,d,o;return e.jsxs("tr",{children:[e.jsx("td",{children:((c=t.product_variants)==null?void 0:c.product_name)||"-"}),e.jsx("td",{children:((r=t.product_variants)==null?void 0:r.sku)||"-"}),e.jsx("td",{children:((d=t.product_variants)==null?void 0:d.size)||"-"}),e.jsx("td",{children:((o=t.product_variants)==null?void 0:o.color)||"-"}),e.jsx("td",{children:t.qty_order??"-"}),e.jsx("td",{children:t.qty_out??"-"})]},t.id)})})]});break;case"BUANG_BENANG_MASUK":s=e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"SPK Qty"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"}),e.jsx("th",{className:"min-w-80px",children:"Qty In"}),e.jsx("th",{className:"min-w-80px",children:"Difference"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:i.map(t=>{var c,r,d,o;return e.jsxs("tr",{children:[e.jsx("td",{children:((c=t.product_variants)==null?void 0:c.product_name)||"-"}),e.jsx("td",{children:((r=t.product_variants)==null?void 0:r.sku)||"-"}),e.jsx("td",{children:((d=t.product_variants)==null?void 0:d.size)||"-"}),e.jsx("td",{children:((o=t.product_variants)==null?void 0:o.color)||"-"}),e.jsx("td",{children:"-"}),e.jsx("td",{children:t.qty_out??"-"}),e.jsx("td",{children:t.qty_in??"-"}),e.jsx("td",{children:Number(t.qty_out)-Number(t.qty_in)})]},t.id)})})]});break;case"JAHIT_KELUAR":s=e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"Qty Order"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:i.map(t=>{var c,r,d,o;return e.jsxs("tr",{children:[e.jsx("td",{children:((c=t.product_variants)==null?void 0:c.product_name)||"-"}),e.jsx("td",{children:((r=t.product_variants)==null?void 0:r.sku)||"-"}),e.jsx("td",{children:((d=t.product_variants)==null?void 0:d.size)||"-"}),e.jsx("td",{children:((o=t.product_variants)==null?void 0:o.color)||"-"}),e.jsx("td",{children:t.qty_order??"-"}),e.jsx("td",{children:t.qty_out??"-"})]},t.id)})})]});break;case"JAHIT_MASUK":s=e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"SPK Qty"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"}),e.jsx("th",{className:"min-w-80px",children:"Qty In"}),e.jsx("th",{className:"min-w-80px",children:"Difference"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:i.map(t=>{var c,r,d,o;return e.jsxs("tr",{children:[e.jsx("td",{children:((c=t.product_variants)==null?void 0:c.product_name)||"-"}),e.jsx("td",{children:((r=t.product_variants)==null?void 0:r.sku)||"-"}),e.jsx("td",{children:((d=t.product_variants)==null?void 0:d.size)||"-"}),e.jsx("td",{children:((o=t.product_variants)==null?void 0:o.color)||"-"}),e.jsx("td",{children:t.qty_order??"-"}),e.jsx("td",{children:t.qty_out??"-"}),e.jsx("td",{children:t.qty_in??"-"}),e.jsx("td",{children:Number(t.qty_out)-Number(t.qty_in)})]},t.id)})})]});break;default:s=e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-200px",children:"Product"}),e.jsx("th",{className:"min-w-100px",children:"SKU"}),e.jsx("th",{className:"min-w-80px",children:"Size"}),e.jsx("th",{className:"min-w-80px",children:"Color"}),e.jsx("th",{className:"min-w-80px",children:"Qty Order"}),e.jsx("th",{className:"min-w-80px",children:"Qty Done"}),e.jsx("th",{className:"min-w-80px",children:"Qty Reject"}),e.jsx("th",{className:"min-w-80px",children:"Progress"}),e.jsx("th",{className:"min-w-100px",children:"Status"}),e.jsx("th",{className:"min-w-120px",children:"Cost Price"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:i.map(t=>{var c,r,d,o;return e.jsxs("tr",{children:[e.jsx("td",{children:((c=t.product_variants)==null?void 0:c.product_name)||"-"}),e.jsx("td",{children:((r=t.product_variants)==null?void 0:r.sku)||"-"}),e.jsx("td",{children:((d=t.product_variants)==null?void 0:d.size)||"-"}),e.jsx("td",{children:((o=t.product_variants)==null?void 0:o.color)||"-"}),e.jsx("td",{children:t.qty_order??"-"}),e.jsx("td",{children:t.qty_done??"-"}),e.jsx("td",{children:t.qty_reject??"-"}),e.jsx("td",{children:t.progress??"-"}),e.jsx("td",{children:t.status?e.jsx(Q,{status:t.status.toLowerCase()}):"-"}),e.jsx("td",{children:t.cost_price!=null?W(t.cost_price):"-"})]},t.id)})})]});break}return e.jsxs(e.Fragment,{children:[s,h&&e.jsx("div",{style:{display:"none"},children:e.jsx("div",{ref:l,children:e.jsx(Ve,{detail:h})})})]})},F=a=>{if(!a)return"-";const i=new Date(a);return Number.isNaN(i.getTime())?a:i.toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})},Ye=({deliveryNoteId:a})=>{var o,x,N,y,f,q,I,p;const{deliveryNote:i,isLoading:h,error:u}=X(a||""),{updateDeliveryNote:l}=D(),[n,m]=b.useState(!1),{currentUser:s}=Z(),t=i||null,c=()=>{l({id:a,status:"APPROVED"})},r=()=>{l({id:a,status:"REJECTED"})},d=v=>{l({id:a,status:"APPROVED",user_id:s==null?void 0:s.full_name,...v}),m(!1)};return a?h?e.jsx(U,{children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"200px"},children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):u?e.jsx(U,{children:e.jsxs("div",{className:"alert alert-danger",children:["Error loading delivery note: ",u.message]})}):t?e.jsxs(U,{children:[e.jsxs("div",{className:"card mb-5",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:e.jsxs("h3",{className:"card-label",children:["Delivery Note #",t.delivery_note_no]})}),t.status==="PENDING"&&e.jsx(G,{allowedRoles:["ADMIN","WAREHOUSE","ADMIN PRODUKSI"],children:e.jsxs("div",{className:"card-toolbar",children:[(t==null?void 0:t.delivery_note_type)==="PENGIRIMAN_BARANG"?e.jsx(G,{allowedRoles:["ADMIN","WAREHOUSE"],children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-success me-2",onClick:()=>m(!0),children:[e.jsx(O,{iconName:"check",className:"fs-2"}),"Approve"]})}):e.jsx(G,{allowedRoles:["ADMIN","ADMIN PRODUKSI"],children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-success me-2",onClick:c,children:[e.jsx(O,{iconName:"check",className:"fs-2"}),"Approve"]})}),(t==null?void 0:t.delivery_note_type)==="PENGIRIMAN_BARANG"?e.jsx(G,{allowedRoles:["ADMIN","WAREHOUSE"],children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-danger",onClick:r,children:[e.jsx(O,{iconName:"cross",className:"fs-2"}),"Reject"]})}):e.jsx(G,{allowedRoles:["ADMIN","ADMIN PRODUKSI"],children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-danger",onClick:r,children:[e.jsx(O,{iconName:"cross",className:"fs-2"}),"Reject"]})})]})})]}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-6 col-md-12 mb-4 mb-lg-0",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Delivery Note No:"})," ",t.delivery_note_no]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Delivery Date:"})," ",F(t.delivery_note_date)]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Type:"})," ",t.delivery_note_type.split("_").join(" ")]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Vendor:"})," ",((o=t.vendor)==null?void 0:o.name)||"-"]})]}),e.jsxs("div",{className:"col-lg-6 col-md-12",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Destination:"})," ",t.destination]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Status:"})," ",t.status?e.jsx(Q,{status:t.status.toLowerCase()}):"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Notes:"})," ",t.notes||"-"]})]})]})})]}),e.jsxs("div",{className:"card mb-5",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Vendor Information"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-6 col-md-12 mb-4 mb-lg-0",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Name:"})," ",((x=t.vendor)==null?void 0:x.name)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Contact Person:"})," ",((N=t.vendor)==null?void 0:N.contact_person)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Phone:"})," ",((y=t.vendor)==null?void 0:y.phone)||"-"]})]}),e.jsxs("div",{className:"col-lg-6 col-md-12",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Email:"})," ",((f=t.vendor)==null?void 0:f.email)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Address:"})," ",((q=t.vendor)==null?void 0:q.address)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"City:"})," ",t.vendor?`${t.vendor.city}, ${t.vendor.province}, ${t.vendor.country}`:"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Zip Code:"})," ",((I=t.vendor)==null?void 0:I.zip_code)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Tax Number:"})," ",((p=t.vendor)==null?void 0:p.tax_number)||"-"]})]})]})})]}),t.details&&t.details.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Delivery Details"})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"d-block",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-125px",children:"SPK Detail ID"}),e.jsx("th",{className:"min-w-100px",children:"Item Type"}),e.jsx("th",{className:"min-w-100px",children:"Product Variant ID"}),e.jsx("th",{className:"min-w-100px",children:"Material ID"}),e.jsx("th",{className:"min-w-80px",children:"Qty Out"}),e.jsx("th",{className:"min-w-80px",children:"Qty In"}),e.jsx("th",{className:"min-w-100px",children:"Labor Cost"}),e.jsx("th",{className:"min-w-100px",children:"Status"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:t.details.map((v,M)=>e.jsxs("tr",{children:[e.jsx("td",{children:v.spk_detail_id}),e.jsx("td",{children:v.item_type}),e.jsx("td",{children:v.product_variant_id||"-"}),e.jsx("td",{children:v.material_id||"-"}),e.jsx("td",{children:v.qty_out}),e.jsx("td",{children:v.qty_in}),e.jsx("td",{children:W(v.labor_cost)}),e.jsx("td",{children:v.status?e.jsx(Q,{status:v.status.toLowerCase()}):"-"})]},v.id||M))})]})})})})]}),t.spk&&t.spk.length>0&&e.jsxs("div",{className:"card mt-5",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Related SPK Information"})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"d-block",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table align-middle table-row-dashed fs-6 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-start text-muted fw-bold fs-7 text-uppercase gs-0",children:[e.jsx("th",{className:"min-w-175px",children:"SPK No"}),e.jsx("th",{className:"min-w-150px",children:"Buyer"}),e.jsx("th",{className:"min-w-125px",children:"SPK Date"}),e.jsx("th",{className:"min-w-125px",children:"Deadline"}),e.jsx("th",{className:"min-w-125px",children:"Status"}),e.jsx("th",{className:"min-w-200px",children:"Notes"})]})}),e.jsx("tbody",{className:"text-gray-600 fw-semibold",children:t.spk.map(v=>e.jsxs("tr",{children:[e.jsx("td",{children:v.spk_no}),e.jsx("td",{children:v.buyer}),e.jsx("td",{children:F(v.spk_date)}),e.jsx("td",{children:F(v.deadline)}),e.jsx("td",{children:v.status?e.jsx(Q,{status:v.status.toLowerCase()}):"-"}),e.jsx("td",{children:v.notes||"-"})]},v.id))})]})})})})]}),t.spk_details&&t.spk_details.length>0&&e.jsxs("div",{className:"card mt-5",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"card-title",children:["SPK Details - ",t.delivery_note_type.replace(/_/g," ")]})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"d-block",children:e.jsx("div",{className:"table-responsive",children:e.jsx(We,{type:t.delivery_note_type,spkDetails:t.spk_details})})})})]}),n&&e.jsx(Ne,{show:n,title:"Enter HPP Value",fields:[{name:"hpp",label:"HPP",type:"number",required:!0,placeholder:"Enter HPP value"}],onSubmit:d,onClose:()=>m(!1)})]}):e.jsx(U,{children:e.jsx("div",{className:"alert alert-warning",children:"Delivery note not found."})}):e.jsx(U,{children:e.jsx("div",{className:"alert alert-warning",children:"Delivery note ID is required."})})},Ze=[{title:"Surat Jalan",path:"/production/surat-jalan",isSeparator:!1,isActive:!1}],Xe=()=>{const{id:a}=ue();return e.jsxs(e.Fragment,{children:[e.jsx(J,{breadcrumbs:Ze,children:"Delivery Note Detail"}),e.jsx(Ye,{deliveryNoteId:a})]})},et=()=>e.jsx(ye,{children:e.jsxs(R,{element:e.jsx(e.Fragment,{children:e.jsx(_e,{})}),children:[e.jsx(R,{path:"detail/:id",element:e.jsx(Xe,{})}),e.jsx(R,{index:!0,element:e.jsx(je,{to:"/production/surat-jalan"})})]})}),V=[{title:"Produksi > ",path:"/production/",isSeparator:!1,isActive:!1}],jt=()=>e.jsx(ye,{children:e.jsxs(R,{element:e.jsx(_e,{}),children:[e.jsx(R,{path:"surat-jalan",element:e.jsxs(e.Fragment,{children:[e.jsx(J,{breadcrumbs:V,children:"Surat Jalan"}),e.jsx(De,{})]})}),e.jsx(R,{path:"add-surat-jalan",element:e.jsxs(e.Fragment,{children:[e.jsx(J,{breadcrumbs:V,children:"Add Surat Jalan"}),e.jsx(He,{})]})}),e.jsx(R,{path:"edit-surat-jalan/:id",element:e.jsxs(e.Fragment,{children:[e.jsx(J,{breadcrumbs:V,children:"Update Surat Jalan"}),e.jsx(Fe,{})]})}),e.jsx(R,{path:"delivery-note-detail/*",element:e.jsx(et,{})}),e.jsx(R,{index:!0,element:e.jsx(je,{to:"/production/dashboard"})})]})});export{jt as default};
