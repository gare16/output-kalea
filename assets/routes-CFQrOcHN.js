import{$ as p,Y as P,Z as o,a1 as B,r as g,a2 as T,j as e,k as C,J as S,a3 as I,K as c,w as V,a6 as le,a7 as ce,x as ne,y as de,a8 as oe,F as L,v as Q,g as me,i as q}from"./index-C8bs7RZm.js";import{T as R}from"./TablesWidget13-CxemlcYz.js";import{D as O,a as ue}from"./DynamicDeleteModal-CQyqsHoG.js";import{D as xe}from"./DynamicEditModal-Bez90ZYm.js";import{u as k,a as y}from"./useMutation-DVRIQfZo.js";import{f as M,B as A,F as w}from"./dateFormatter-BAS1RcD3.js";import{B as he}from"./react-barcode-DYSHMG7p.js";import{u as be}from"./useMaterials-Cm7vjQIK.js";import"./ThemeProvider-BoXIQX2b.js";import"./Modal-BZ9Bjo3z.js";import"./hasClass-D44ucA8r.js";import"./warning-ClC9Fe-s.js";const pe=async()=>(await p.get("/articles?start=0&length=100")).data.data||[],Ne=async r=>{const n=(await p.get(`/articles/${r}`)).data.data;if(console.log(n),!n||!n.product_variants)throw new Error("Article not found");return n},je=async r=>(console.log("=== article service ==="),(await p.post("/articles",r)).data.data),fe=async(r,t)=>(await p.put(`/articles/${r}`,t)).data.data,ge=async r=>{await p.delete(`/articles/${r}`)},G=()=>{const r=P(),t=k({queryKey:["articles"],queryFn:pe}),n=s=>k({queryKey:["articles",s],queryFn:()=>Ne(s),enabled:!!s}),i=y({mutationFn:je,onSuccess:s=>{console.log("Add article success:",s),r.invalidateQueries({queryKey:["articles"]}),o.success("Article added successfully")},onError:s=>{console.error("Add article error:",s),o.error(s instanceof Error?s.message:"Failed to add article")}}),d=y({mutationFn:({id:s,article:N})=>fe(s,N),onSuccess:s=>{console.log("Update article success:",s),r.invalidateQueries({queryKey:["articles"]}),o.success("Article updated successfully")},onError:s=>{console.error("Update article error:",s),o.error(s instanceof Error?s.message:"Failed to update article")}}),x=y({mutationFn:ge,onSuccess:()=>{console.log("Delete article success"),r.invalidateQueries({queryKey:["articles"]}),o.success("Article deleted successfully")},onError:s=>{console.error("Delete article error:",s),o.error(s instanceof Error?s.message:"Failed to delete article")}});return{articles:t.data||[],isLoading:t.isLoading,error:t.error,useArticleById:n,addArticle:i.mutate,updateArticle:d.mutate,deleteArticle:x.mutate,isAdding:i.isPending,isUpdating:d.isPending,isDeleting:x.isPending}},ye=async()=>(await p.get("/product-variants?start=0&length=5000")).data.data||[],ve=async r=>(await p.get(`/product-variants/${r}`)).data.data,_e=async r=>(await p.post("/product-variants",r)).data.data,we=async(r,t)=>(await p.put(`/product-variants/${r}`,t)).data.data,Ae=async r=>{await p.delete(`/product-variants/${r}`)},E=()=>{const r=P(),t=k({queryKey:["product-variants"],queryFn:ye}),n=s=>k({queryKey:["product-variants",s],queryFn:()=>ve(s),enabled:!!s}),i=y({mutationFn:s=>_e(s),onSuccess:s=>{console.log("Add product variant success:",s),r.invalidateQueries({queryKey:["product-variants"]}),o.success("Product variant added successfully")},onError:s=>{console.error("Add product variant error:",s),o.error(s instanceof Error?s.message:"Failed to add product variant")}}),d=y({mutationFn:({id:s,productVariant:N})=>we(s,N),onSuccess:s=>{console.log("Update product variant success:",s),r.invalidateQueries({queryKey:["product-variants"]}),o.success("Product variant updated successfully")},onError:s=>{console.error("Update product variant error:",s),o.error(s instanceof Error?s.message:"Failed to update product variant")}}),x=y({mutationFn:Ae,onSuccess:()=>{console.log("Delete product variant success"),r.invalidateQueries({queryKey:["product-variants"]}),o.success("Product variant deleted successfully")},onError:s=>{console.error("Delete product variant error:",s),o.error(s instanceof Error?s.message:"Failed to delete product variant")}});return{productVariants:t.data||[],isLoading:t.isLoading,error:t.error,useProductVariantById:n,addProductVariant:i.mutate,updateProductVariant:d.mutate,deleteProductVariant:x.mutate,isAdding:i.isPending,isUpdating:d.isPending,isDeleting:x.isPending}},ke=[{key:"title",label:"Nama",className:"min-w-140px"},{key:"content",label:"Deskripsi",className:"min-w-200px"},{key:"status",label:"Status",className:"min-w-100px"},{key:"createdBy",label:"Dibuat Oleh",className:"min-w-120px"},{key:"createdDate",label:"Dibuat Tanggal",className:"min-w-120px"},{key:"updatedBy",label:"Diubah Oleh",className:"min-w-120px"},{key:"updatedDate",label:"Diubah Tanggal",className:"min-w-120px"}],De=[{key:"sku",label:"SKU",className:"min-w-120px"},{key:"product_name",label:"Product Name",className:"min-w-140px"},{key:"size",label:"Size",className:"min-w-100px"},{key:"color",label:"Color",className:"min-w-100px"},{key:"cost_price",label:"Cost Price",className:"min-w-120px"},{key:"price",label:"Price",className:"min-w-120px"},{key:"status",label:"Status",className:"min-w-100px"},{key:"created_by",label:"Created By",className:"min-w-120px"},{key:"created_dt",label:"Created Date",className:"min-w-120px"}],Se=[{title:"Dashboard",path:"/dashboard",isSeparator:!1,isActive:!1},{title:"Master Role",path:"/master-role",isSeparator:!0,isActive:!0}],qe=()=>{const r=B(),[t,n]=g.useState("artikel"),[i,d]=g.useState(!1),[x,s]=g.useState(!1),[N,v]=g.useState(!1),[u,l]=g.useState(null),{currentUser:h}=T(),{articles:j,addArticle:D,updateArticle:m,deleteArticle:b}=G(),{productVariants:f,addProductVariant:W,updateProductVariant:Y,deleteProductVariant:Z}=E(),H=j.map(a=>({id:a.id,title:a.article_name,content:a.description||"",status:e.jsx("span",{className:`badge ${a.is_active?"badge-light-success":"badge-light-danger"}`,children:a.is_active?"Active":"Inactive"}),createdBy:a.created_by,createdDate:M(a.created_dt),updatedBy:a.changed_by||"",updatedDate:M(a.changed_dt)})),X=f.map(a=>({id:a.id,sku:a.sku,product_name:a.product_name,size:a.size,color:a.color,price:`Rp ${Number(a.price).toLocaleString("id-ID")}`,cost_price:`Rp ${Number(a.cost_price).toLocaleString("id-ID")}`,barcode:a.barcode,status:e.jsx("span",{className:`badge ${a.is_active?"badge-light-success":"badge-light-danger"}`,children:a.is_active?"Active":"Inactive"}),created_by:a.created_by,created_dt:M(a.created_dt)})),F=a=>{l(a),d(!0)},ee=()=>{u&&(t==="artikel"?b(u.id):Z(u.id)),d(!1)},$=a=>{l(a),s(!0)},se=()=>{if(!u)return{};if(t==="artikel"){const a=j.find(_=>_.id===u.id);return{title:(a==null?void 0:a.article_name)||"",content:(a==null?void 0:a.description)||"",is_active:(a==null?void 0:a.is_active)||!1}}else{const a=f.find(_=>_.id===u.id);return{article:(a==null?void 0:a.article.id)||"",productName:(a==null?void 0:a.product_name)||"",size:(a==null?void 0:a.size)||"",color:(a==null?void 0:a.color)||"",price:(a==null?void 0:a.price)||"",cost_price:(a==null?void 0:a.cost_price)||"",sku:(a==null?void 0:a.sku)||"",is_active:(a==null?void 0:a.is_active)??!0}}},ae=()=>t==="artikel"?[{name:"title",label:"Title",type:"text",required:!0,icon:"document"},{name:"content",label:"Content",type:"textarea",required:!0,icon:"message-text"},{name:"is_active",label:"Status Aktif",type:"checkbox",required:!1,icon:"check-circle"}]:[{name:"article",label:"Article",type:"select",required:!1,icon:"document",options:j.map(a=>({value:a.id,label:a.article_name}))},{name:"productName",label:"Product Name",type:"text",required:!0,icon:"document"},{name:"size",label:"Size",type:"text",required:!0,icon:"resize"},{name:"color",label:"Color",type:"text",required:!0,icon:"palette"},{name:"sku",label:"SKU",type:"text",required:!0,icon:"code"},{name:"cost_price",label:"Cost Price",type:"number",required:!0,icon:"dollar"},{name:"price",label:"Price",type:"number",required:!0,icon:"dollar"},{name:"is_active",label:"Status Aktif",type:"checkbox",required:!1,icon:"check-circle"}],te=a=>{u&&(t==="artikel"?m({id:u.id,article:{article_name:a.title,description:a.content,is_active:a.is_active}}):Y({id:u.id,productVariant:{product_name:a.productName,size:a.size,color:a.color,sku:a.sku,cost_price:a.cost_price,price:a.price,is_active:a.is_active}})),s(!1),l(null)},z=()=>{v(!0)},re=a=>{if(t==="artikel")D({article_name:a.title,description:a.content,is_active:a.is_active});else{const _=j.find(ie=>ie.id===a.article);W({article_id:_==null?void 0:_.id,product_name:a.productName,size:a.size,color:a.color,sku:a.sku,cost_price:a.cost_price,price:a.price,is_active:a.is_active,user_id:h==null?void 0:h.id})}v(!1)},K=a=>{r(t==="artikel"?`/master-product/article/${a.id}`:`/master-product/product/${a.id}`)};return e.jsxs("div",{children:[e.jsx(C,{breadcrumbs:Se,children:"Master Article & Products"}),e.jsx("div",{className:"card card-xl-stretch mb-5 mb-xl-8",children:e.jsxs("div",{className:"card-body py-3",children:[e.jsxs("ul",{className:"nav nav-stretch nav-line-tabs nav-line-tabs-2x border-transparent fs-5 fw-bold",children:[e.jsx("li",{className:"nav-item mt-2",children:e.jsx("a",{className:S("nav-link cursor-pointer",{active:t==="artikel"}),onClick:()=>n("artikel"),children:"Articles"})}),e.jsx("li",{className:"nav-item mt-2",children:e.jsx("a",{className:S("nav-link cursor-pointer",{active:t==="product"}),onClick:()=>n("product"),children:"Products"})})]}),e.jsxs("div",{className:"tab-content mt-5",children:[e.jsx("div",{className:S("tab-pane",{active:t==="artikel"}),children:e.jsx(R,{className:"card-xl-stretch",rows:H,columns:ke,labelAdd:"Article",filters:[{key:"title",label:"Filter by Title"}],onDelete:F,onEdit:$,onAddClick:z,onRowClick:a=>K(a)})}),e.jsx("div",{className:S("tab-pane",{active:t==="product"}),children:e.jsx(R,{className:"card-xl-stretch",rows:X,columns:De,labelAdd:"Product",filters:[{key:"product_name",label:"Filter by Product Name"}],onDelete:F,onEdit:$,onAddClick:z,onRowClick:K})})]})]})}),i&&u&&e.jsx(O,{show:i,title:`Delete ${t==="artikel"?"Article":"Product"}`,itemName:t==="artikel"?u.title:u.product_name,onConfirm:ee,onClose:()=>{d(!1),l(null)}}),x&&u&&e.jsx(xe,{show:x,title:`Edit ${t==="artikel"?"Article":"Product"}`,fields:ae(),initialData:se(),onSave:te,onClose:()=>{s(!1),l(null)}}),N&&e.jsx(ue,{show:N,title:`Add ${t==="artikel"?"Article":"Product"}`,fields:t==="artikel"?[{name:"title",label:"Article Name",type:"text",required:!0,icon:"document"},{name:"content",label:"Description",type:"textarea",required:!1,icon:"message-text"},{name:"is_active",label:"Status Aktif",type:"checkbox",required:!1,icon:"check-circle"}]:[{name:"article",label:"Article",type:"select",required:!0,icon:"document",options:j.map(a=>({value:a.id,label:a.article_name}))},{name:"sku",label:"SKU",type:"text",required:!0,icon:"code"},{name:"productName",label:"Product Name",type:"text",required:!0,icon:"document"},{name:"size",label:"Size",type:"text",required:!0,icon:"resize"},{name:"color",label:"Color",type:"text",required:!0,icon:"palette"},{name:"cost_price",label:"Cost Price",type:"number",required:!1,icon:"dollar"},{name:"price",label:"Price",type:"number",required:!1,icon:"dollar"},{name:"is_active",label:"Status Aktif",type:"checkbox",required:!1,icon:"check-circle"}],onSubmit:re,onClose:()=>v(!1)})]})},Ce=()=>{const{id:r}=I(),t=B(),{useArticleById:n}=G(),{data:i,isLoading:d,error:x}=n(r);return g.useEffect(()=>{!d&&!i&&t("/error/404")},[i,d,t]),d?e.jsx("div",{children:"Loading..."}):x||!i?e.jsx("div",{children:"Error loading article"}):e.jsxs("div",{className:"card shadow-sm",children:[e.jsx("div",{className:"card-header border-0 bg-light",children:e.jsxs("div",{className:"w-100 d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center",children:[e.jsxs("div",{className:"mb-3 mb-md-0",children:[e.jsx("h3",{className:"card-title mb-1",children:i.article_name}),e.jsxs("span",{className:"text-muted fs-7",children:["ID: ",i.id]})]}),e.jsx("div",{className:"d-flex gap-2",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>t(-1),children:[e.jsx(c,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Articles"]})})]})}),e.jsx("div",{className:"card-body p-3 p-lg-5",children:e.jsxs("div",{className:"row g-3 g-lg-5",children:[e.jsx("div",{className:"col-lg-8",children:e.jsxs("div",{className:"row g-3 g-md-4",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"tag",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Article Name"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:i.article_name})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"check-circle",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Status"})]}),e.jsx("span",{className:`badge ${i.is_active?"badge-light-success":"badge-light-danger"} fs-6`,children:i.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"user",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Created By"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:i.created_by})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"calendar",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Created Date"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:new Date(i.created_dt).toLocaleString()})]}),i.changed_by&&e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"user-edit",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Changed By"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:i.changed_by})]}),i.changed_dt&&e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"calendar-edit",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Changed Date"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:new Date(i.changed_dt).toLocaleString()})]}),e.jsxs("div",{className:"col-12",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"information",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Description"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:i.description||"No description"})]})]})}),e.jsx("div",{className:"col-lg-4",children:e.jsxs("div",{className:"card border",children:[e.jsx("div",{className:"card-header bg-light",children:e.jsx("h6",{className:"card-title mb-0",children:"Product Variants"})}),e.jsx("div",{className:"card-body",children:i.product_variants&&i.product_variants.length>0?e.jsx("div",{className:"list-group gap-2",children:i.product_variants.map(s=>e.jsx("button",{className:"list-group-item p-3",onClick:()=>t(`/master-product/product/${s.id}`),children:e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsxs("div",{children:[e.jsx("strong",{children:s.product_name}),e.jsx("br",{}),e.jsxs("small",{className:"text-muted",children:["Size: ",s.size,", Color: ",s.color]})]})})},s.id))}):e.jsx("p",{className:"text-muted",children:"No product variants"})})]})})]})})]})},Pe=async()=>(await p.get("/bom-items?start=0&length=100")).data.data||[],Be=async r=>(await p.post("/bom-items/bulk",r)).data.data,Me=async(r,t)=>{const n=t.material?{...t,materials:[{material_id:t.material.id,qty_per_unit:t.qty_per_unit}]}:t;return(await p.put(`/bom-items/bulk/${r}`,n)).data.data},Ie=async r=>{await p.delete(`/bom-items/${r}`)},Ee=async r=>(await p.get(`/bom-items/${r}`)).data.data,J=()=>{const r=P(),t=k({queryKey:["bomItems"],queryFn:Pe}),n=y({mutationFn:s=>Be(s),onSuccess:s=>{console.log("Add bom item success:",s),r.invalidateQueries({queryKey:["bomItems"]}),o.success("BOM Item added successfully")},onError:s=>{console.error("Add bom item error:",s),o.error(s instanceof Error?s.message:"Failed to add BOM Item")}}),i=y({mutationFn:({id:s,bomItem:N})=>Me(s,N),onSuccess:s=>{console.log("Update bom item success:",s),r.invalidateQueries({queryKey:["bomItems"]}),o.success("BOM Item updated successfully")},onError:s=>{console.error("Update bom item error:",s),o.error(s instanceof Error?s.message:"Failed to update BOM Item")}}),d=y({mutationFn:Ie,onSuccess:()=>{console.log("Delete bom item success"),r.invalidateQueries({queryKey:["bomItems"]}),o.success("BOM Item deleted successfully")},onError:s=>{console.error("Delete bom item error:",s),o.error(s instanceof Error?s.message:"Failed to delete BOM Item")}}),x=y({mutationFn:Ee,onSuccess:s=>{console.log("Fetch bom item by id success:",s)},onError:s=>{console.error("Fetch bom item by id error:",s),o.error(s instanceof Error?s.message:"Failed to fetch BOM Item")}});return{bomItems:t.data||[],isLoading:t.isLoading,error:t.error,addBomItem:n.mutate,updateBomItem:i.mutate,deleteBomItem:d.mutate,fetchBomItemById:x.mutate,isAdding:n.isPending,isUpdating:i.isPending,isDeleting:d.isPending}},Fe=()=>{const{id:r}=I(),t=B(),{useProductVariantById:n}=E(),{deleteBomItem:i,isDeleting:d}=J(),x=P(),{data:s,isLoading:N,error:v}=n(r),[u,l]=g.useState(!1),[h,j]=g.useState(null),D=(b,f)=>{j({bom_id:b,material_name:f}),l(!0)},m=()=>{h&&i(h.bom_id,{onSuccess:()=>{x.invalidateQueries({queryKey:["product-variants",r]}),l(!1),j(null)}})};return g.useEffect(()=>{!N&&!s&&t("/error/404")},[s,N,t]),N?e.jsx("div",{className:"d-flex justify-content-center align-items-center h-lg-400px",children:"Loading..."}):v||!s?e.jsx("div",{children:"Error loading product variant"}):e.jsxs("div",{className:"card shadow-sm",children:[e.jsx("div",{className:"card-header border-0 bg-light",children:e.jsxs("div",{className:"w-100 d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center",children:[e.jsxs("div",{className:"mb-3 mb-md-0",children:[e.jsx("h3",{className:"card-title mb-1",children:s.product_name}),e.jsxs("span",{className:"text-muted fs-7",children:["SKU: ",s.sku]})]}),e.jsx("div",{className:"d-flex gap-2",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>t(-1),children:[e.jsx(c,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Products"]})})]})}),e.jsxs("div",{className:"card-body p-3 p-lg-5",children:[e.jsxs("div",{className:"card border mb-5",children:[e.jsxs("div",{className:"card-header bg-light",children:[e.jsx("h6",{className:"card-title mb-0",children:"Barcode"}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsx("span",{className:`badge fs-7 ${s.is_active?"badge-light-success":"badge-light-warning"}`,children:s.is_active?"Active":"Inactive"})})]}),e.jsxs("div",{className:"card-body text-center",children:[e.jsx(he,{value:s.barcode,width:1.5,height:60}),e.jsx("p",{className:"text-muted fs-7 mt-2",children:s.barcode})]}),e.jsx("div",{className:"col-lg-4 p-4",children:s.article&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h6",{className:"fw-bold mb-3",children:"Article Information"}),e.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Article Name:"}),e.jsx("span",{className:"fw-semibold",children:s.article.article_name})]}),e.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Description:"}),e.jsx("span",{className:"fw-semibold",children:s.article.description||"N/A"})]})]})})]}),e.jsx("div",{className:"row g-3 g-lg-5",children:e.jsx("div",{className:"col-lg-8",children:e.jsxs("div",{className:"row g-3 g-md-4",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"tag",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Article Name"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:s.article.article_name})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"size",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Size"})]}),e.jsx("span",{className:"badge badge-light-primary fs-6",children:s.size})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"color-swatch",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Color"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:s.color})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"dollar",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Price"})]}),e.jsxs("p",{className:"text-gray-800 fs-6",children:["Rp ",Number(s.price).toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"dollar",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Cost Price"})]}),e.jsxs("p",{className:"text-gray-800 fs-6",children:["Rp ",Number(s.cost_price).toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"check-circle",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Status"})]}),e.jsx("span",{className:`badge ${s.is_active?"badge-light-success":"badge-light-danger"} fs-6`,children:s.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"user",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Created By"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:s.created_by})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"calendar",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Created Date"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:new Date(s.created_dt).toLocaleString()})]}),s.changed_by&&e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"user-edit",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Changed By"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:s.changed_by})]}),s.changed_dt&&e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(c,{iconName:"calendar-edit",className:"fs-4 text-primary me-2"}),e.jsx("label",{className:"form-label fw-bold mb-0",children:"Changed Date"})]}),e.jsx("p",{className:"text-gray-800 fs-6",children:new Date(s.changed_dt).toLocaleString()})]})]})})}),s.materials&&e.jsxs("div",{className:"card border mt-5",children:[e.jsxs("div",{className:"card-header bg-light",children:[e.jsx("h6",{className:"card-title mb-0",children:"Materials"}),e.jsx("div",{className:"align-content-center",children:e.jsxs(A,{variant:"dark",className:"btn btn-sm",onClick:()=>t(`/master-product/product/${r}/add-materials`),children:[e.jsx(c,{iconName:"plus",className:"fs-3 me-1"}),"Tambah Material"]})})]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"row g-3",children:s.materials.map((b,f)=>e.jsx("div",{className:"col-12 col-md-6 col-lg-4",children:e.jsxs("div",{className:"border rounded p-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[e.jsx("h6",{className:"fw-bold mb-0",children:b.material_name}),e.jsx("button",{type:"button",className:"btn btn-sm btn-icon btn-text-secondary rounded-pill",onClick:()=>D(b.bom_id,b.material_name),disabled:d,children:e.jsx(c,{iconName:"trash",className:"fs-4 text-danger"})})]}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Category:"}),e.jsx("span",{className:"fw-semibold",children:b.material_category})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",children:"Qty per Unit:"}),e.jsxs("span",{className:"fw-semibold",children:[b.qty_per_unit," ",b.unit_of_measure]})]})]})]})},b.bom_id||f))})})]})]}),e.jsx(O,{show:u,title:"Delete Material",itemName:(h==null?void 0:h.material_name)||"",onConfirm:m,onClose:()=>l(!1)})]})},$e=[{title:"Master Data",path:"/master-product",isSeparator:!1,isActive:!1}],ze=()=>{const{id:r}=I(),t=B(),{useProductVariantById:n}=E(),{data:i,isLoading:d,error:x}=n(r),{addBomItem:s}=J(),{materials:N}=be(),{currentUser:v}=T();if(g.useEffect(()=>{!d&&!i&&t("/error/404")},[i,d,t]),d)return e.jsx("div",{className:"d-flex justify-content-center align-items-center h-lg-400px",children:"Loading..."});if(x||!i)return e.jsx("div",{children:"Error loading product variant"});const u=V().shape({materials:le().of(V().shape({material_id:ne().required("Material is required"),qty_per_unit:ce().required("Qty per unit is required").min(.01,"Must be greater than 0")})).min(1,"At least one material is required")});return e.jsxs("div",{className:"container-fluid",children:[e.jsx(C,{breadcrumbs:$e,children:"Add Materials"}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card shadow-sm",children:[e.jsx("div",{className:"card-header border-0 bg-light",children:e.jsx("div",{className:"w-100 d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center",children:e.jsxs("div",{className:"mb-3 mb-md-0",children:[e.jsx("h3",{className:"card-title mb-1",children:i.product_name}),e.jsxs("span",{className:"text-muted fs-7",children:["SKU: ",i.sku]})]})})}),e.jsx("div",{className:"card-body p-5",children:e.jsx(de,{initialValues:{materials:[{material_id:"",qty_per_unit:0}]},validationSchema:u,onSubmit:l=>{s({product_variant_id:r,materials:l.materials,user_id:v==null?void 0:v.full_name}),t(`/master-product/product/${r}`)},enableReinitialize:!0,children:l=>e.jsxs(w,{onSubmit:l.handleSubmit,id:"add-materials-form",onKeyDown:h=>{h.key==="Enter"&&!h.shiftKey&&(h.preventDefault(),l.handleSubmit())},children:[e.jsx(oe,{name:"materials",children:({push:h,remove:j})=>e.jsxs(e.Fragment,{children:[l.values.materials.map((D,m)=>e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"col-12 d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h6",{className:"mb-0"}),l.values.materials.length>1&&e.jsxs(A,{variant:"outline-danger",size:"sm",onClick:()=>j(m),children:[e.jsx(c,{iconName:"trash",className:"fs-4"}),"Remove"]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs(w.Group,{className:"mb-3",children:[e.jsxs(w.Label,{className:"fw-bold",children:["Material ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(L,{name:`materials.${m}.material_id`,children:({field:b})=>e.jsxs(w.Select,{...b,className:"form-control-solid",isInvalid:!!(l.errors.materials&&Array.isArray(l.errors.materials)&&l.errors.materials[m]&&l.errors.materials[m].material_id&&l.touched.materials&&Array.isArray(l.touched.materials)&&l.touched.materials[m]&&l.touched.materials[m].material_id),children:[e.jsx("option",{value:"",children:"Select Material"}),N.map(f=>e.jsx("option",{value:f.id,children:f.material_name},f.id))]})}),e.jsx(Q,{name:`materials.${m}.material_id`,component:"div",className:"invalid-feedback d-block"})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs(w.Group,{className:"mb-3",children:[e.jsxs(w.Label,{className:"fw-bold",children:["Qty per Unit ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(L,{name:`materials.${m}.qty_per_unit`,children:({field:b})=>e.jsx(w.Control,{...b,type:"number",step:"0.01",placeholder:"Enter quantity per unit",className:"form-control-solid",isInvalid:!!(l.errors.materials&&Array.isArray(l.errors.materials)&&l.errors.materials[m]&&l.errors.materials[m].qty_per_unit&&l.touched.materials&&Array.isArray(l.touched.materials)&&l.touched.materials[m]&&l.touched.materials[m].qty_per_unit)})}),e.jsx(Q,{name:`materials.${m}.qty_per_unit`,component:"div",className:"invalid-feedback d-block"})]})})]})]},m)),e.jsxs(A,{type:"button",variant:"outline-primary",onClick:()=>h({material_id:"",qty_per_unit:0}),className:"w-100 mb-4",children:[e.jsx(c,{iconName:"plus",className:"fs-3 me-2"}),"Add Another Material"]})]})}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsxs(A,{variant:"light",className:"btn-active-light-danger",onClick:()=>t(-1),children:[e.jsx(c,{iconName:"cross",className:"fs-2 me-2"}),"Cancel"]}),e.jsxs(A,{variant:"primary",type:"submit",children:[e.jsx(c,{iconName:"check",className:"fs-2 me-2"}),"Save Materials"]})]})]})})})]})})})]})},U=[{title:"Master Data",path:"/master-product",isSeparator:!1,isActive:!1}],Ze=()=>e.jsxs(me,{children:[e.jsx(q,{path:"/",element:e.jsx(qe,{})}),e.jsx(q,{path:"product/:id",element:e.jsxs(e.Fragment,{children:[e.jsx(C,{breadcrumbs:U,children:"Product Detail"}),e.jsx(Fe,{})]})}),e.jsx(q,{path:"product/:id/add-materials",element:e.jsx(e.Fragment,{children:e.jsx(ze,{})})}),e.jsx(q,{path:"article/:id",element:e.jsxs(e.Fragment,{children:[e.jsx(C,{breadcrumbs:U,children:"Article Detail"}),e.jsx(Ce,{})]})})]});export{Ze as default};
