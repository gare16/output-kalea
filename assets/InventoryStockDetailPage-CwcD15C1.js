import{a3 as K,a1 as P,r as i,j as e,K as o,k as M,C as T}from"./index-B54S5Xdh.js";import{u as C,g as _}from"./index-BbjMbdRb.js";const q=[{id:"1",nama_produk:"VIONA ATASAN BROKEN WHITE M",sku:"KT-001",artikel:"KT-001-PREMIUM",satuan:"Meter",gudang:"Gudang A",nomor_rak:"A01-05",total_stok:150,history:[{id:"h1",action:"Masuk",quantity:200,date:"2024-11-01",description:"Pembelian awal",source:"PO-2024-001"},{id:"h2",action:"Keluar",quantity:50,date:"2024-11-10",description:"Produksi SPK-2024-001",source:"SPK-2024-001"}]},{id:"2",nama_produk:"VIONA ATASAN BLUE M",sku:"ST-002",artikel:"ST-002-ASLI",satuan:"Meter",gudang:"Gudang B",nomor_rak:"B02-03",total_stok:75,history:[{id:"h3",action:"Masuk",quantity:100,date:"2024-10-15",description:"Pembelian bulan lalu",source:"PO-2024-002"},{id:"h4",action:"Keluar",quantity:25,date:"2024-11-20",description:"Produksi SPK-2024-003",source:"SPK-2024-003"}]},{id:"3",nama_produk:"VIONA ATASAN BLUE L",sku:"BR-003",artikel:"BR-003-HALUS",satuan:"Gulung",gudang:"Gudang C",nomor_rak:"C03-07",total_stok:300,history:[{id:"h5",action:"Masuk",quantity:500,date:"2024-11-05",description:"Pembelian",source:"PO-2024-003"},{id:"h6",action:"Keluar",quantity:200,date:"2024-11-22",description:"Produksi SPK-2024-005",source:"SPK-2024-005"}]},{id:"4",nama_produk:"VIONA ATASAN BLACK M",sku:"KK-004",artikel:"KK-004-KERAMIK",satuan:"Buah",gudang:"Gudang A",nomor_rak:"A04-12",total_stok:1e3,history:[{id:"h7",action:"Masuk",quantity:1200,date:"2024-11-10",description:"Pembelian",source:"PO-2024-004"},{id:"h8",action:"Keluar",quantity:200,date:"2024-11-28",description:"Produksi SPK-2024-007",source:"SPK-2024-007"}]},{id:"5",nama_produk:"VIONA ATASAN BEIGE M",sku:"RA-005",artikel:"RA-005-ANTIAIR",satuan:"Pcs",gudang:"Gudang B",nomor_rak:"B01-09",total_stok:500,history:[{id:"h9",action:"Masuk",quantity:600,date:"2024-11-02",description:"Pembelian",source:"PO-2024-005"},{id:"h10",action:"Keluar",quantity:100,date:"2024-11-30",description:"Produksi SPK-2024-009",source:"SPK-2024-009"}]},{id:"6",nama_produk:"VANESSA BROKEN WHITE M",sku:"FP-006",artikel:"FP-006-POLY",satuan:"Meter",gudang:"Gudang C",nomor_rak:"C02-04",total_stok:200,history:[{id:"h11",action:"Masuk",quantity:300,date:"2024-11-08",description:"Pembelian",source:"PO-2024-006"},{id:"h12",action:"Keluar",quantity:100,date:"2024-11-25",description:"Produksi SPK-2024-011",source:"SPK-2024-011"}]},{id:"7",nama_produk:"VANESSA BROKEN WHITE L",sku:"KMB-007",artikel:"KMB-007-BUNGA",satuan:"Meter",gudang:"Gudang A",nomor_rak:"A03-11",total_stok:80,history:[{id:"h13",action:"Masuk",quantity:100,date:"2024-11-12",description:"Pembelian",source:"PO-2024-007"},{id:"h14",action:"Keluar",quantity:20,date:"2024-12-01",description:"Produksi SPK-2024-013",source:"SPK-2024-013"}]}],B=[{title:"Inventory >",path:"/inventory",isSeparator:!1,isActive:!1},{title:"Stock >",path:"/inventory/stock-material",isSeparator:!1,isActive:!1}],I=()=>{const{id:y}=K(),m=P(),[t,p]=i.useState(null),[k,v]=i.useState(!0),[N,g]=i.useState([]),[u,j]=i.useState(""),[x,w]=i.useState(""),[d,S]=i.useState(""),[l,h]=i.useState("history"),b=i.useMemo(()=>[{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Tanggal"}),accessorKey:"date",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Nama Produk"}),accessorKey:"productName",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Deskripsi"}),accessorKey:"description",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Sumber"}),accessorKey:"source",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Stok Tersedia"}),accessorFn:a=>a.runningStock,id:"runningStock",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Jumlah"}),accessorFn:a=>`${a.action==="Masuk"?"+":"-"}${a.quantity}`,id:"quantityChange",cell:a=>{const s=a.getValue(),r=s.startsWith("+");return e.jsx("span",{className:`fw-bold text-hover-primary d-block mb-1 fs-6 ${r?"text-success":"text-danger"}`,children:s})}},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Total Akhir"}),accessorFn:a=>a.stockAfter,id:"stockAfter",cell:a=>e.jsx("span",{className:"text-gray-800 fw-bold text-hover-primary d-block mb-1 fs-6",children:a.getValue()})},{header:()=>e.jsx("div",{className:"text-gray-800 fw-bold text-hover-primary mb-1 fs-6",children:"Aksi"}),accessorKey:"action",cell:a=>{const s=a.getValue(),r=s==="Masuk"?"badge-light-success":"badge-light-danger",n=s==="Masuk"?"Masuk":"Keluar";return e.jsx("span",{className:`badge ${r} fw-semibold fs-7`,children:n})}}],[]),f=C({data:N,columns:b,getCoreRowModel:_()});return i.useEffect(()=>{const a=Math.floor(Math.random()*7)+1,s=q.find(r=>r.id===a.toString());s?p(s):m("/inventory/stock-product"),v(!1)},[y,m]),i.useEffect(()=>{if(t){let a=0;const s=[...t.history].sort((r,n)=>new Date(r.date).getTime()-new Date(n.date).getTime()).map(r=>{const n=a;r.action==="Masuk"?a+=r.quantity:r.action==="Keluar"&&(a-=r.quantity);const c=a;return{...r,productName:t.nama_produk,runningStock:n,stockAfter:c}});g(s)}},[t]),i.useEffect(()=>{if(!t)return;let a=[...t.history].sort((s,r)=>new Date(s.date).getTime()-new Date(r.date).getTime()).map(s=>{const r=t.history.slice().sort((c,A)=>new Date(c.date).getTime()-new Date(A.date).getTime()).slice(0,t.history.findIndex(c=>c.id===s.id)+1);let n=0;for(const c of r)c.action==="Masuk"?n+=c.quantity:c.action==="Keluar"&&(n-=c.quantity);return{...s,productName:t.nama_produk,runningStock:n-(s.action==="Masuk"?s.quantity:s.action==="Keluar"?-s.quantity:0),stockAfter:n}});u&&(a=a.filter(s=>new Date(s.date)>=new Date(u))),x&&(a=a.filter(s=>new Date(s.date)<=new Date(x))),d&&(a=a.filter(s=>s.productName.toLowerCase().includes(d.toLowerCase())||s.description.toLowerCase().includes(d.toLowerCase())||s.source.toLowerCase().includes(d.toLowerCase()))),l==="stockIn"?a=a.filter(s=>s.action==="Masuk"):l==="stockOut"&&(a=a.filter(s=>s.action==="Keluar")),g(a)},[u,x,d,t,l]),k?e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("div",{className:"mt-3",children:"Memuat detail Stock Inventory..."})]})}):t?k?e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("div",{className:"mt-3",children:"Memuat detail Stock Inventory..."})]})}):t?e.jsxs(e.Fragment,{children:[e.jsx(M,{breadcrumbs:B,children:t.nama_produk}),e.jsxs(T,{children:[e.jsx("div",{className:"row g-5 g-xl-8",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body py-5",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Nama Produk"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.nama_produk})]})}),e.jsx("div",{className:"col-md-1",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"SKU"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.sku})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Artikel"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.artikel})]})}),e.jsx("div",{className:"col-md-1",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Satuan"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.satuan})]})}),e.jsx("div",{className:"col-md-1",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Total Stok"}),e.jsx("div",{className:"fw-bold fs-3 text-gray-800",children:t.total_stok})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsx("div",{className:"text-gray-400 fw-semibold fs-6 mb-1",children:"Lokasi"}),e.jsxs("div",{className:"fw-bold fs-3 text-gray-800",children:[t.gudang," - ",t.nomor_rak]})]})}),e.jsx("div",{className:"col-md-3",children:e.jsx("div",{className:"d-flex flex-row h-100 justify-content-end",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>m(-1),children:[e.jsx(o,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Articles"]})})})]})})})})}),e.jsx("div",{className:"row g-5 g-xl-8 mt-5",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header border-0 pt-6",children:[e.jsxs("div",{className:"d-flex flex-wrap gap-5",children:[e.jsxs("div",{className:"card-title",children:[e.jsx(o,{iconName:"history",className:"fs-2 text-primary me-2"}),e.jsx("h3",{className:"mb-0",children:l==="stockIn"?"Riwayat Stok Masuk":l==="stockOut"?"Riwayat Stok Keluar":"Riwayat Transaksi"})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[e.jsx("button",{className:`btn ${l==="history"?"btn-primary active":"btn-outline-primary"}`,onClick:()=>h("history"),children:"Semua"}),e.jsx("button",{className:`btn ${l==="stockIn"?"btn-success active":"btn-outline-success"}`,onClick:()=>h("stockIn"),children:"Stok Masuk"}),e.jsx("button",{className:`btn ${l==="stockOut"?"btn-danger active":"btn-outline-danger"}`,onClick:()=>h("stockOut"),children:"Stok Keluar"})]})]}),e.jsxs("div",{className:"card-toolbar",children:[e.jsxs("div",{className:"d-flex align-items-center position-relative me-4",children:[e.jsx("input",{type:"date",className:"form-control form-control-sm me-2",placeholder:"Start Date",value:u,onChange:a=>j(a.target.value)}),e.jsx("span",{className:"mx-1",children:"to"}),e.jsx("input",{type:"date",className:"form-control form-control-sm ms-2",placeholder:"End Date",value:x,onChange:a=>w(a.target.value)})]}),e.jsxs("div",{className:"d-flex align-items-center position-relative",children:[e.jsx(o,{iconName:"magnifier",className:"fs-3 position-absolute ms-3 text-gray-400"}),e.jsx("input",{type:"text",className:"form-control form-control-solid w-250px ps-10",placeholder:"Cari produk, deskripsi, atau sumber...",value:d,onChange:a=>S(a.target.value)})]})]})]}),e.jsx("div",{className:"card-body py-5",children:N.length===0?e.jsxs("div",{className:"text-center py-10",children:[e.jsx(o,{iconName:"information",className:"fs-1 text-muted mb-3"}),e.jsx("p",{className:"text-muted",children:l==="stockIn"?"Tidak ada riwayat stok masuk":l==="stockOut"?"Tidak ada riwayat stok keluar":"Tidak ada riwayat transaksi yang cocok"})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-7",children:[e.jsx("thead",{children:f.getHeaderGroups().map(a=>e.jsx("tr",{className:"fw-bold text-muted",children:a.headers.map(s=>e.jsx("th",{className:"min-w-150px",children:s.isPlaceholder?null:s.column.columnDef.header({})},s.id))},a.id))}),e.jsx("tbody",{className:"text-gray-600 fw-bold",children:f.getRowModel().rows.length>0?f.getRowModel().rows.map(a=>e.jsx("tr",{children:a.getVisibleCells().map(s=>e.jsx("td",{children:s.renderValue()},s.id))},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:b.length,children:e.jsx("div",{className:"d-flex text-center w-100 align-content-center justify-content-center",children:"No matching records found"})})})})]})})})]})})})]})]}):e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"alert alert-danger",role:"alert",children:"Item tidak ditemukan"}),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>m(-1),children:[e.jsx(o,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Articles"]})]})}):e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"alert alert-danger",role:"alert",children:"Item tidak ditemukan"}),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-dark w-100 w-md-auto",onClick:()=>m(-1),children:[e.jsx(o,{iconName:"arrow-left",className:"fs-3 me-1"}),"Back to Articles"]})]})})};export{I as default};
