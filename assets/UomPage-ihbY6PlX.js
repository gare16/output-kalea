import{I as m,B as F,G as i,S as k,r as f,j as t,H as b,P as C}from"./index-ByLk8s-j.js";import{T as q}from"./TablesWidget13-CYdTlftt.js";import{D as T}from"./DynamicEditModal-Bhzcpj13.js";import{D as I}from"./DynamicDeleteModal-C1L8R17p.js";import{D as P}from"./DynamicFormModal-BoHJvk0i.js";import{u as Q,a as h}from"./useMutation-D8PU-YPJ.js";import{f as x}from"./dateFormatter-Bb4_azhc.js";import"./ThemeProvider-DRjQDZAD.js";import"./FormCheckInput-DWF_ryow.js";import"./Modal-DB3yoVLU.js";import"./hasClass-BOwTM1yB.js";import"./DataKey-jIVlRIQi.js";import"./Button-BI5PMaMy.js";import"./Form-BFxoF8LL.js";import"./warning-C3dqfjue.js";const B=async()=>(await m.get("/unit-of-measure?start=0&length=100")).data.data||[],K=async a=>(console.log("=== uom service ==="),(await m.post("/unit-of-measure",a)).data.data),L=async(a,o)=>(await m.put(`/unit-of-measure/${a}`,o)).data.data,$=async a=>{await m.delete(`/unit-of-measure/${a}`)},H=async a=>(await m.get(`/unit-of-measure/${a}`)).data.data,z=()=>{const a=F(),o=Q({queryKey:["uoms"],queryFn:B}),l=h({mutationFn:K,onSuccess:e=>{console.log("Add uom success:",e),a.invalidateQueries({queryKey:["uoms"]}),i.success("UOM added successfully")},onError:e=>{console.error("Add uom error:",e),i.error(e instanceof Error?e.message:"Failed to add UOM")}}),u=h({mutationFn:({id:e,uom:c})=>L(e,c),onSuccess:e=>{console.log("Update uom success:",e),a.invalidateQueries({queryKey:["uoms"]}),i.success("UOM updated successfully")},onError:e=>{console.error("Update uom error:",e),i.error(e instanceof Error?e.message:"Failed to update UOM")}}),p=h({mutationFn:$,onSuccess:()=>{console.log("Delete uom success"),a.invalidateQueries({queryKey:["uoms"]}),i.success("UOM deleted successfully")},onError:e=>{console.error("Delete uom error:",e),i.error(e instanceof Error?e.message:"Failed to delete UOM")}}),y=h({mutationFn:H,onSuccess:e=>{console.log("Fetch uom by id success:",e)},onError:e=>{console.error("Fetch uom by id error:",e),i.error(e instanceof Error?e.message:"Failed to fetch UOM")}});return{uoms:o.data||[],isLoading:o.isLoading,error:o.error,addUom:l.mutate,updateUom:u.mutate,deleteUom:p.mutate,fetchUomById:y.mutate,isAdding:l.isPending,isUpdating:u.isPending,isDeleting:p.isPending}},G=[{title:"Dashboard",path:"/dashboard",isSeparator:!1,isActive:!1},{title:"Master UOM",path:"/master-uom",isSeparator:!0,isActive:!0}],re=()=>{const{currentUser:a}=k(),{uoms:o,isLoading:l,addUom:u,updateUom:p,deleteUom:y}=z(),[e,c]=f.useState(!1),[D,g]=f.useState(!1),[w,M]=f.useState(!1),[d,r]=f.useState(null),O=[{key:"name",label:"Nama",className:"min-w-150px"},{key:"created_by",label:"Dibuat Oleh",className:"min-w-120px"},{key:"created_dt",label:"Dibuat Tanggal",className:"min-w-140px"},{key:"changed_by",label:"Diubah Oleh",className:"min-w-120px"},{key:"changed_dt",label:"Diubah Tanggal",className:"min-w-140px"}],S=o.map(s=>({id:s.id,name:s.name,created_by:s.created_by,created_dt:x(s.created_dt),changed_by:s.changed_by||"-",changed_dt:s.changed_dt?x(s.changed_dt):"-"})),E=()=>{c(!0)},_=s=>{const n=(a==null?void 0:a.full_name)||"";u({name:s.name,user_id:n}),c(!1)},N=s=>{const n=o.find(U=>U.id===s.id);n&&(r(n),g(!0))},j=s=>{const n=(a==null?void 0:a.full_name)||"";d&&(p({id:d.id,uom:{name:s.name,user_id:n}}),g(!1),r(null))},v=s=>{const n=o.find(U=>U.id===s.id);n&&(r(n),M(!0))},A=()=>{d&&(y(d.id),M(!1),r(null))};return l?t.jsx(b,{children:t.jsxs("div",{className:"card-body text-center py-10",children:[t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),t.jsx("div",{className:"mt-3",children:"Memuat data UOM..."})]})}):t.jsxs("div",{className:"container-fluid",children:[t.jsx(C,{breadcrumbs:G,children:"Master UOM"}),t.jsx(b,{children:t.jsx(q,{className:"card-xl-stretch",rows:S,columns:O,labelAdd:"Add UOM",filters:[{key:"name",label:"Filter by Name"}],onDelete:v,onEdit:N,onAdd:E})}),e&&t.jsx(P,{show:e,title:"Tambah UOM",fields:[{name:"name",label:"Nama UOM",type:"text",required:!0,icon:"tag",placeholder:"Masukkan nama UOM"}],onSubmit:_,onClose:()=>c(!1)}),d&&t.jsx(T,{show:D,title:"Edit UOM",fields:[{name:"name",label:"Nama UOM",type:"text",required:!0,icon:"tag",placeholder:"Masukkan nama UOM"}],initialData:{name:d.name},onSave:j,onClose:()=>{g(!1),r(null)}}),d&&t.jsx(I,{show:w,title:"Hapus UOM",itemName:d.name,onConfirm:A,onClose:()=>{M(!1),r(null)}})]})};export{re as default};
